

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>natlink.messagefunctions &mdash; natlink 1.1.0 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> natlink
          

          
          </a>

          
            
            
              <div class="version">
                1.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../project.html">Project</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">natlink</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>natlink.messagefunctions</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for natlink.messagefunctions</h1><div class="highlight"><pre>
<span></span><span class="c1"># Module     : winGuiAuto.py</span>
<span class="c1"># Synopsis   : Windows GUI automation utilities</span>
<span class="c1"># Programmer : Simon Brunning - simon@brunningonline.net</span>
<span class="c1"># Date       : 25 June 2003</span>
<span class="c1"># Version    : 1.0 </span>
<span class="c1"># Copyright  : Released to the public domain. Provided as-is, with no warranty.</span>
<span class="c1"># Notes      : Requires Python 2.3, win32all and ctypes </span>



<span class="c1"># Modifications by Tim Couper - tim@tizmoi.net</span>
<span class="c1"># 22 Jul 2004</span>
<span class="c1"># findControls: deduplicates the list to be returned </span>
<span class="c1"># findControl: handles win32gui.error from initial call to findControls</span>
<span class="c1"># getMenuInfo: improved algorithm for calculating no. of items in a menu</span>
<span class="c1"># activateMenuItem: improved algorithm for calculating no. of items in a menu</span>
<span class="c1">#           </span>
<span class="c1"># GLOBALLY corrected spelling: seperator -&gt; separator</span>
<span class="c1">#                            : descendent -&gt; descendant</span>
<span class="c1"># added findMenuItem</span>
<span class="c1"># adapted for NatSpeak/NatLink interaction, Quintijn Hoogenboomhallo</span>
<span class="c1"># october 2009. (starting with watsup utilities)</span>
<span class="c1"># pylint: disable=C0302, C0115</span>
<span class="sd">&#39;&#39;&#39;&quot;Windows GUI automation utilities&quot;</span>

<span class="sd">The standard pattern of usage of winGuiAuto, originally written by TimCouper,</span>
<span class="sd">is in three stages; identify a</span>
<span class="sd">window, identify a control in the window, trigger an action on the control.</span>

<span class="sd">The end result is always that you wish to have an effect upon some Windows GUI</span>
<span class="sd">control.</span>

<span class="sd">The first stage is to identify the window within which the control can be</span>
<span class="sd">found. To do this, you can use either :code:`findTopWindow` or :code:`findTopWindows`. </span>

<span class="sd">Usually, specifying caption text, the window&#39;s class, or both, will be</span>
<span class="sd">sufficient to identify the required window. (Note that the window&#39;s class is a</span>
<span class="sd">Windows API concept)</span>

<span class="sd">Testing can be done interactively at the bottom of the file. You need the hndle of the application in order to</span>
<span class="sd">run most of the test functions</span>

<span class="sd">Helper class and functions</span>
<span class="sd">==========================</span>

<span class="sd">&#39;&#39;&#39;</span>

<span class="kn">import</span> <span class="nn">array</span>
<span class="kn">import</span> <span class="nn">ctypes</span>
<span class="kn">import</span> <span class="nn">types</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">struct</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">pprint</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="c1">## python 3 only:</span>
<span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">unquote</span>

<span class="kn">import</span> <span class="nn">pywintypes</span>
<span class="kn">import</span> <span class="nn">win32api</span>
<span class="kn">import</span> <span class="nn">win32con</span>
<span class="kn">import</span> <span class="nn">winxpgui</span> <span class="k">as</span> <span class="nn">win32gui</span>

<span class="n">GetWindowText</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">windll</span><span class="o">.</span><span class="n">user32</span><span class="o">.</span><span class="n">GetWindowTextW</span>
<span class="n">GetWindowTextLength</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">windll</span><span class="o">.</span><span class="n">user32</span><span class="o">.</span><span class="n">GetWindowTextLengthW</span>

<span class="c1"># for SendKeys:</span>
<span class="n">braceExact</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span> <span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[{][^}]+[}]$&#39;</span><span class="p">)</span>
<span class="n">hasBraces</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span> <span class="p">(</span><span class="sa">r</span><span class="s1">&#39;([{].+?[}])&#39;</span><span class="p">)</span>
<span class="n">BracesExtractKey</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span> <span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^[{]((alt|ctrl|shift)[+])*(?P&lt;k&gt;[^ ]+?)( [0-9]+)?[}]$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span>

<span class="c1">## Scintilla constants:</span>
<span class="c1"># from dragonfly.actions import scintillacon</span>

<div class="viewcode-block" id="findTopWindow"><a class="viewcode-back" href="../../messagefunctions.html#natlink.messagefunctions.findTopWindow">[docs]</a><span class="k">def</span> <span class="nf">findTopWindow</span><span class="p">(</span><span class="n">wantedText</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">wantedClass</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Find the hwnd of a top level window.</span>
<span class="sd">    </span>
<span class="sd">    You can identify windows using caption (part of) or class,</span>

<span class="sd">    Arguments:</span>
<span class="sd">      wantedText     Text which the required window&#39;s caption must</span>
<span class="sd">                     *contain*. (Case insensitive match.)</span>
<span class="sd">      wantedClass    Class to which the required window must belong.</span>
<span class="sd">    Returns:</span>
<span class="sd">      handle if found (the first match)</span>
<span class="sd">      None if not found</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">wantedText</span> <span class="ow">or</span> <span class="n">wantedClass</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;findTopWindow, wantedText and/or wantedClass must be passed, not: </span><span class="si">%s</span><span class="s2"> and </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span>
                         <span class="p">(</span><span class="n">wantedText</span><span class="p">,</span> <span class="n">wantedClass</span><span class="p">))</span>
    <span class="n">topWindow</span> <span class="o">=</span> <span class="n">findTopWindows</span><span class="p">(</span><span class="n">wantedText</span><span class="p">,</span> <span class="n">wantedClass</span><span class="p">,</span> <span class="n">checkImmediate</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">topWindow</span> <span class="c1"># checking already done!</span></div>

<span class="c1"># for checking on the fly:</span>
<span class="n">wText</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">wClass</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">checkI</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">selFunc</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="findTopWindows"><a class="viewcode-back" href="../../messagefunctions.html#natlink.messagefunctions.findTopWindows">[docs]</a><span class="k">def</span> <span class="nf">findTopWindows</span><span class="p">(</span><span class="n">wantedText</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">wantedClass</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">selectionFunction</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">checkImmediate</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Find the hwnd of top level windows.</span>
<span class="sd">    </span>
<span class="sd">    You can identify windows using captions, classes, a custom selection</span>
<span class="sd">    function, or any combination of these. (Multiple selection criteria are</span>
<span class="sd">    ANDed. If this isn&#39;t what&#39;s wanted, use a selection function.)</span>

<span class="sd">    Arguments:</span>
<span class="sd">    wantedText          Text which required windows&#39; captions must contain.</span>
<span class="sd">    wantedClass         Class to which required windows must belong.</span>
<span class="sd">    selectionFunction   Window selection function. Reference to a function</span>
<span class="sd">                        should be passed here. The function should take hwnd as</span>
<span class="sd">                        an argument, and should return True when passed the</span>
<span class="sd">                        hwnd of a desired window.</span>

<span class="sd">    Returns:            A list containing the window handles of all top level</span>
<span class="sd">                        windows matching the supplied selection criteria.</span>

<span class="sd">    Usage example:      optDialogs = findTopWindows(wantedText=&quot;Options&quot;)</span>
<span class="sd">    </span>
<span class="sd">    checkImmediate: if true, check the options inside the _windowEnumerationHandler, and</span>
<span class="sd">                    quit if criterium has been met (only for wantedText and wantedClass)</span>
<span class="sd">    </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># pylint: disable=W0603, R0912</span>
    <span class="k">global</span> <span class="n">wText</span><span class="p">,</span> <span class="n">wClass</span><span class="p">,</span> <span class="n">checkI</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">topWindows</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">checkImmediate</span><span class="p">:</span>
        <span class="n">checkI</span><span class="p">,</span> <span class="n">wText</span><span class="p">,</span> <span class="n">wClass</span><span class="p">,</span> <span class="n">_selFunc</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">_normaliseText</span><span class="p">(</span><span class="n">wantedText</span><span class="p">),</span> <span class="n">wantedClass</span><span class="p">,</span> <span class="n">selectionFunction</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">checkI</span><span class="p">,</span> <span class="n">wText</span><span class="p">,</span> <span class="n">wClass</span><span class="p">,</span> <span class="n">_selFunc</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
        
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">win32gui</span><span class="o">.</span><span class="n">EnumWindows</span><span class="p">(</span><span class="n">_windowEnumerationHandler</span><span class="p">,</span> <span class="n">topWindows</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">error</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;got error in EnumWindows, try again: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span> <span class="n">i</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="k">if</span> <span class="n">checkI</span><span class="p">:</span>
        <span class="n">checkI</span> <span class="o">=</span> <span class="n">wText</span> <span class="o">=</span> <span class="n">wClass</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">topWindows</span><span class="p">:</span>
            <span class="c1"># return 1 window handle:</span>
            <span class="k">return</span> <span class="n">topWindows</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="mi">0</span>
        
    <span class="c1"># checking the results:</span>
    <span class="k">if</span> <span class="n">wantedText</span><span class="p">:</span>
        <span class="n">wantedText</span> <span class="o">=</span> <span class="n">_normaliseText</span><span class="p">(</span><span class="n">wantedText</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">topWindows</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">hwnd</span><span class="p">,</span> <span class="n">windowText</span><span class="p">,</span> <span class="n">windowClass</span> <span class="o">=</span> <span class="n">result</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;invalid entry&#39;</span><span class="p">)</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">wantedText</span> <span class="ow">and</span> \
           <span class="n">_normaliseText</span><span class="p">(</span><span class="n">windowText</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">wantedText</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">wantedClass</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">windowClass</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">wantedClass</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">selectionFunction</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">selectionFunction</span><span class="p">(</span><span class="n">hwnd</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hwnd</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">results</span></div>
    
<div class="viewcode-block" id="getForegroundWindow"><a class="viewcode-back" href="../../messagefunctions.html#natlink.messagefunctions.getForegroundWindow">[docs]</a><span class="k">def</span> <span class="nf">getForegroundWindow</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;get hndle of the current foreground window</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">hndle</span> <span class="o">=</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">GetForegroundWindow</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">hndle</span></div>
    
<div class="viewcode-block" id="dumpTopWindows"><a class="viewcode-back" href="../../messagefunctions.html#natlink.messagefunctions.dumpTopWindows">[docs]</a><span class="k">def</span> <span class="nf">dumpTopWindows</span><span class="p">(</span><span class="n">doAll</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;TODO&#39;&#39;&#39;</span>
    <span class="n">defaultTitles</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;Default IME&#39;</span><span class="p">,</span> <span class="s1">&#39;Engine Window&#39;</span><span class="p">]</span>
    <span class="n">defaultClasses</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;MSCTFIME UI&#39;</span><span class="p">]</span>
    <span class="n">topWindows</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">win32gui</span><span class="o">.</span><span class="n">EnumWindows</span><span class="p">(</span><span class="n">_windowEnumerationHandler</span><span class="p">,</span> <span class="n">topWindows</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">error</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;got error enumerating windows&#39;</span><span class="p">)</span>
        
    <span class="k">if</span> <span class="n">doAll</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">topWindows</span>
    <span class="n">selectedWindows</span> <span class="o">=</span> <span class="p">[(</span><span class="n">hndle</span><span class="p">,</span><span class="n">title</span><span class="p">,</span><span class="n">clname</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">hndle</span><span class="p">,</span><span class="n">title</span><span class="p">,</span><span class="n">clname</span><span class="p">)</span> <span class="ow">in</span> <span class="n">topWindows</span>
        <span class="k">if</span> <span class="n">title</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">defaultTitles</span> <span class="ow">and</span> <span class="n">clname</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">defaultClasses</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">selectedWindows</span></div>
    
<div class="viewcode-block" id="dumpWindow"><a class="viewcode-back" href="../../messagefunctions.html#natlink.messagefunctions.dumpWindow">[docs]</a><span class="k">def</span> <span class="nf">dumpWindow</span><span class="p">(</span><span class="n">hwnd</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Dump all controls from a window into a nested list</span>
<span class="sd">    </span>
<span class="sd">    Useful during development, allowing to you discover the structure of the</span>
<span class="sd">    contents of a window, showing the text and class of all contained controls.</span>
<span class="sd">    </span>
<span class="sd">    Think of it as a poor man&#39;s Spy++. ;-)</span>

<span class="sd">    Arguments:      The window handle of the top level window to dump.</span>

<span class="sd">    Returns         A nested list of controls. Each entry consists of the</span>
<span class="sd">                    control&#39;s hwnd, its text, its class, and its sub-controls,</span>
<span class="sd">                    if any.</span>

<span class="sd">    Usage example:  replaceDialog = findTopWindow(wantedText=&#39;Replace&#39;)</span>
<span class="sd">                    pprint.pprint(dumpWindow(replaceDialog))</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">windows</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">win32gui</span><span class="o">.</span><span class="n">EnumChildWindows</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span> <span class="n">_windowEnumerationHandler</span><span class="p">,</span> <span class="n">windows</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">error</span><span class="p">:</span>
        <span class="c1"># No child windows</span>
        <span class="k">return</span> <span class="n">windows</span> <span class="c1"># empty here</span>
    <span class="k">for</span> <span class="n">window</span> <span class="ow">in</span> <span class="n">windows</span><span class="p">:</span>
        <span class="n">childHwnd</span><span class="p">,</span> <span class="n">_windowText</span><span class="p">,</span> <span class="n">_windowClass</span> <span class="o">=</span> <span class="n">window</span>
        <span class="n">window_content</span> <span class="o">=</span> <span class="n">dumpWindow</span><span class="p">(</span><span class="n">childHwnd</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">window_content</span><span class="p">:</span>
            <span class="n">windows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">window_content</span><span class="p">)</span>
       
    <span class="k">def</span> <span class="nf">dedup</span><span class="p">(</span><span class="n">thelist</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;De-duplicate deeply nested windows list.&#39;&#39;&#39;</span>
        <span class="k">def</span> <span class="nf">listContainsSublists</span><span class="p">(</span><span class="n">thelist</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">bool</span><span class="p">([</span><span class="n">sublist</span>
                         <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">thelist</span>
                         <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sublist</span><span class="p">,</span> <span class="nb">list</span><span class="p">)])</span>
        <span class="n">found</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">def</span> <span class="nf">dodedup</span><span class="p">(</span><span class="n">thelist</span><span class="p">):</span>
            <span class="n">todel</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">thing</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">thelist</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">thing</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="n">listContainsSublists</span><span class="p">(</span><span class="n">thing</span><span class="p">):</span>
                    <span class="n">dodedup</span><span class="p">(</span><span class="n">thing</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">thing</span> <span class="ow">in</span> <span class="n">found</span><span class="p">:</span>
                        <span class="n">todel</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">found</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thing</span><span class="p">)</span>
            <span class="n">todel</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">todel</span> <span class="ow">in</span> <span class="n">todel</span><span class="p">:</span>
                <span class="k">del</span> <span class="n">thelist</span><span class="p">[</span><span class="n">todel</span><span class="p">]</span>
        <span class="n">dodedup</span><span class="p">(</span><span class="n">thelist</span><span class="p">)</span>
    <span class="n">dedup</span><span class="p">(</span><span class="n">windows</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">windows</span></div>

<div class="viewcode-block" id="findControl"><a class="viewcode-back" href="../../messagefunctions.html#natlink.messagefunctions.findControl">[docs]</a><span class="k">def</span> <span class="nf">findControl</span><span class="p">(</span><span class="n">topHwnd</span><span class="p">,</span>
                <span class="n">wantedText</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">wantedClass</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">selectionFunction</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">maxWait</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">retryInterval</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>   <span class="c1">###, checkImmediate=None):</span>
    <span class="sd">&#39;&#39;&#39;Find a control.</span>
<span class="sd">    </span>
<span class="sd">    You can identify a control within a top level window, using caption, class,</span>
<span class="sd">    a custom selection function, or any combination of these. (Multiple</span>
<span class="sd">    selection criteria are ANDed. If this isn&#39;t what&#39;s wanted, use a selection</span>
<span class="sd">    function.)</span>
<span class="sd">    </span>
<span class="sd">    If no control matching the specified selection criteria is found</span>
<span class="sd">    immediately, further attempts will be made. The retry interval and maximum</span>
<span class="sd">    time to wait for a matching control can be specified.</span>

<span class="sd">    Arguments:</span>
<span class="sd">    topHwnd             The window handle of the top level window in which the</span>
<span class="sd">                        required controls reside.</span>
<span class="sd">    wantedText          Text which the required control&#39;s captions must contain.</span>
<span class="sd">    wantedClass         Class to which the required control must belong.</span>
<span class="sd">    selectionFunction   Control selection function. Reference to a function</span>
<span class="sd">                        should be passed here. The function should take</span>
<span class="sd">                        hwnd, controlText, controlClass as its arguments</span>
<span class="sd">                        and should return True when passed the</span>
<span class="sd">                        hwnd of the desired control.</span>
<span class="sd">    maxWait             The maximum time to wait for a matching control, in</span>
<span class="sd">                        seconds.</span>
<span class="sd">    retryInterval       How frequently to look for a matching control, in</span>
<span class="sd">                        seconds</span>

<span class="sd">    Returns:            The window handle of the first control matching the</span>
<span class="sd">                        supplied selection criteria.</span>
<span class="sd">                    </span>
<span class="sd">    Raises:</span>
<span class="sd">    WinGuiAutoError     When no control or multiple controls found.</span>

<span class="sd">    Usage example:      optDialog = findTopWindow(wantedText=&quot;Options&quot;)</span>
<span class="sd">                        okButton = findControl(optDialog,</span>
<span class="sd">                                               wantedClass=&quot;Button&quot;,</span>
<span class="sd">                                               wantedText=&quot;OK&quot;)</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># pylint: disable=R0913</span>
    <span class="n">controls</span> <span class="o">=</span> <span class="n">findControls</span><span class="p">(</span><span class="n">topHwnd</span><span class="p">,</span>
                            <span class="n">wantedText</span><span class="o">=</span><span class="n">wantedText</span><span class="p">,</span>
                            <span class="n">wantedClass</span><span class="o">=</span><span class="n">wantedClass</span><span class="p">,</span>
                            <span class="n">selectionFunction</span><span class="o">=</span><span class="n">selectionFunction</span><span class="p">)</span>
    <span class="c1"># check for None returned:  Tim 6 Jul 2004</span>
    <span class="k">if</span> <span class="n">controls</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">WinGuiAutoError</span><span class="p">(</span><span class="s2">&quot;EnumChildWindows failed with win32gui.error &quot;</span>  <span class="o">+</span>
                              <span class="nb">repr</span><span class="p">(</span><span class="n">topHwnd</span><span class="p">)</span> <span class="o">+</span>
                              <span class="s2">&quot;, wantedText=&quot;</span> <span class="o">+</span>
                              <span class="nb">repr</span><span class="p">(</span><span class="n">wantedText</span><span class="p">)</span> <span class="o">+</span>
                              <span class="s2">&quot;, wantedClass=&quot;</span> <span class="o">+</span>
                              <span class="nb">repr</span><span class="p">(</span><span class="n">wantedClass</span><span class="p">)</span> <span class="o">+</span>
                              <span class="s2">&quot;, selectionFunction=&quot;</span> <span class="o">+</span>
                              <span class="nb">repr</span><span class="p">(</span><span class="n">selectionFunction</span><span class="p">)</span> <span class="o">+</span>
                              <span class="s2">&quot;, maxWait=&quot;</span> <span class="o">+</span>
                              <span class="nb">repr</span><span class="p">(</span><span class="n">maxWait</span><span class="p">)</span> <span class="o">+</span>
                              <span class="s2">&quot;, retryInterval=&quot;</span> <span class="o">+</span>
                              <span class="nb">str</span><span class="p">(</span><span class="n">retryInterval</span><span class="p">)</span> 
                              <span class="p">)</span>
    
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">controls</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">WinGuiAutoError</span><span class="p">(</span><span class="s2">&quot;Multiple controls found for topHwnd=&quot;</span> <span class="o">+</span>
                              <span class="nb">repr</span><span class="p">(</span><span class="n">topHwnd</span><span class="p">)</span> <span class="o">+</span>
                              <span class="s2">&quot;, wantedText=&quot;</span> <span class="o">+</span>
                              <span class="nb">repr</span><span class="p">(</span><span class="n">wantedText</span><span class="p">)</span> <span class="o">+</span>
                              <span class="s2">&quot;, wantedClass=&quot;</span> <span class="o">+</span>
                              <span class="nb">repr</span><span class="p">(</span><span class="n">wantedClass</span><span class="p">)</span> <span class="o">+</span>
                              <span class="s2">&quot;, selectionFunction=&quot;</span> <span class="o">+</span>
                              <span class="nb">repr</span><span class="p">(</span><span class="n">selectionFunction</span><span class="p">)</span> <span class="o">+</span>
                              <span class="s2">&quot;, maxWait=&quot;</span> <span class="o">+</span>
                              <span class="nb">repr</span><span class="p">(</span><span class="n">maxWait</span><span class="p">)</span> <span class="o">+</span>
                              <span class="s2">&quot;, retryInterval=&quot;</span> <span class="o">+</span>
                              <span class="nb">str</span><span class="p">(</span><span class="n">retryInterval</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">controls</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">controls</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">maxWait</span><span class="o">-</span><span class="n">retryInterval</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">retryInterval</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">findControl</span><span class="p">(</span><span class="n">topHwnd</span><span class="o">=</span><span class="n">topHwnd</span><span class="p">,</span>
                               <span class="n">wantedText</span><span class="o">=</span><span class="n">wantedText</span><span class="p">,</span>
                               <span class="n">wantedClass</span><span class="o">=</span><span class="n">wantedClass</span><span class="p">,</span>
                               <span class="n">selectionFunction</span><span class="o">=</span><span class="n">selectionFunction</span><span class="p">,</span>
                               <span class="n">maxWait</span><span class="o">=</span><span class="n">maxWait</span><span class="o">-</span><span class="n">retryInterval</span><span class="p">,</span>
                               <span class="n">retryInterval</span><span class="o">=</span><span class="n">retryInterval</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">WinGuiAutoError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">WinGuiAutoError</span><span class="p">(</span><span class="s2">&quot;No control found for topHwnd=&quot;</span> <span class="o">+</span>
                                  <span class="nb">repr</span><span class="p">(</span><span class="n">topHwnd</span><span class="p">)</span> <span class="o">+</span>
                                  <span class="s2">&quot;, wantedText=&quot;</span> <span class="o">+</span>
                                  <span class="nb">repr</span><span class="p">(</span><span class="n">wantedText</span><span class="p">)</span> <span class="o">+</span>
                                  <span class="s2">&quot;, wantedClass=&quot;</span> <span class="o">+</span>
                                  <span class="nb">repr</span><span class="p">(</span><span class="n">wantedClass</span><span class="p">)</span> <span class="o">+</span>
                                  <span class="s2">&quot;, selectionFunction=&quot;</span> <span class="o">+</span>
                                  <span class="nb">repr</span><span class="p">(</span><span class="n">selectionFunction</span><span class="p">)</span> <span class="o">+</span>
                                  <span class="s2">&quot;, maxWait=&quot;</span> <span class="o">+</span>
                                  <span class="nb">repr</span><span class="p">(</span><span class="n">maxWait</span><span class="p">)</span> <span class="o">+</span>
                                  <span class="s2">&quot;, retryInterval=&quot;</span> <span class="o">+</span>
                                  <span class="nb">str</span><span class="p">(</span><span class="n">retryInterval</span><span class="p">))</span>
        
    <span class="k">raise</span> <span class="n">WinGuiAutoError</span><span class="p">(</span><span class="s2">&quot;No control found for topHwnd=&quot;</span> <span class="o">+</span>
                              <span class="nb">repr</span><span class="p">(</span><span class="n">topHwnd</span><span class="p">)</span> <span class="o">+</span>
                              <span class="s2">&quot;, wantedText=&quot;</span> <span class="o">+</span>
                              <span class="nb">repr</span><span class="p">(</span><span class="n">wantedText</span><span class="p">)</span> <span class="o">+</span>
                              <span class="s2">&quot;, wantedClass=&quot;</span> <span class="o">+</span>
                              <span class="nb">repr</span><span class="p">(</span><span class="n">wantedClass</span><span class="p">)</span> <span class="o">+</span>
                              <span class="s2">&quot;, selectionFunction=&quot;</span> <span class="o">+</span>
                              <span class="nb">repr</span><span class="p">(</span><span class="n">selectionFunction</span><span class="p">)</span> <span class="o">+</span>
                              <span class="s2">&quot;, maxWait=&quot;</span> <span class="o">+</span>
                              <span class="nb">repr</span><span class="p">(</span><span class="n">maxWait</span><span class="p">)</span> <span class="o">+</span>
                              <span class="s2">&quot;, retryInterval=&quot;</span> <span class="o">+</span>
                              <span class="nb">str</span><span class="p">(</span><span class="n">retryInterval</span><span class="p">))</span></div>

<div class="viewcode-block" id="findControls"><a class="viewcode-back" href="../../messagefunctions.html#natlink.messagefunctions.findControls">[docs]</a><span class="k">def</span> <span class="nf">findControls</span><span class="p">(</span><span class="n">topHwnd</span><span class="p">,</span>
                 <span class="n">wantedText</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">wantedClass</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">selectionFunction</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Find controls.</span>
<span class="sd">    </span>
<span class="sd">    You can identify controls using captions, classes, a custom selection</span>
<span class="sd">    function, or any combination of these. (Multiple selection criteria are</span>
<span class="sd">    ANDed. If this isn&#39;t what&#39;s wanted, use a selection function.)</span>

<span class="sd">    Arguments:</span>
<span class="sd">    topHwnd             The window handle of the top level window in which the</span>
<span class="sd">                        required controls reside.</span>
<span class="sd">    wantedText          Text which the required controls&#39; captions must contain.</span>
<span class="sd">    wantedClass         Class to which the required controls must belong.</span>
<span class="sd">    selectionFunction   Control selection function. Reference to a function</span>
<span class="sd">                        should be passed here. The function should take hwnd as</span>
<span class="sd">                        an argument, and should return True when passed the</span>
<span class="sd">                        hwnd of a desired control.</span>

<span class="sd">    Returns:            The window handles of the controls matching the</span>
<span class="sd">                        supplied selection criteria.    </span>

<span class="sd">    Usage example:      optDialog = findTopWindow(wantedText=&quot;Options&quot;)</span>
<span class="sd">                        def findButtons(hwnd, windowText, windowClass):</span>
<span class="sd">                            return windowClass == &quot;Button&quot;</span>
<span class="sd">                        buttons = findControl(optDialog, wantedText=&quot;Button&quot;)</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">wantedText</span><span class="p">:</span>
        <span class="n">wantedText</span> <span class="o">=</span> <span class="n">_normaliseText</span><span class="p">(</span><span class="n">wantedText</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">searchChildWindows</span><span class="p">(</span><span class="n">currentHwnd</span><span class="p">):</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">childWindows</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">win32gui</span><span class="o">.</span><span class="n">EnumChildWindows</span><span class="p">(</span><span class="n">currentHwnd</span><span class="p">,</span>
                                      <span class="n">_windowEnumerationHandler</span><span class="p">,</span>
                                      <span class="n">childWindows</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">error</span><span class="p">:</span>
            <span class="c1"># This seems to mean that the control *cannot* have child windows,</span>
            <span class="c1"># i.e. is not a container.</span>
            <span class="k">return</span>
        <span class="k">for</span> <span class="n">childHwnd</span><span class="p">,</span> <span class="n">windowText</span><span class="p">,</span> <span class="n">windowClass</span> <span class="ow">in</span> <span class="n">childWindows</span><span class="p">:</span>
            <span class="n">descendantMatchingHwnds</span> <span class="o">=</span> <span class="n">searchChildWindows</span><span class="p">(</span><span class="n">childHwnd</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">descendantMatchingHwnds</span><span class="p">:</span>
                <span class="n">results</span> <span class="o">+=</span> <span class="n">descendantMatchingHwnds</span>

            <span class="k">if</span> <span class="n">wantedText</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">windowText</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="c1">#print(&#39;wanted: %s, window: %s&#39;% (wantedText, windowText)</span>
                <span class="k">if</span> <span class="n">_normaliseText</span><span class="p">(</span><span class="n">windowText</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">wantedText</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="k">continue</span>
            <span class="k">if</span> <span class="n">wantedClass</span> <span class="ow">and</span> \
               <span class="ow">not</span> <span class="n">windowClass</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">wantedClass</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="n">selectionFunction</span> <span class="ow">and</span> \
               <span class="ow">not</span> <span class="n">selectionFunction</span><span class="p">(</span><span class="n">childHwnd</span><span class="p">,</span> <span class="n">windowText</span><span class="p">,</span> <span class="n">windowClass</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">childHwnd</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">results</span>

    <span class="c1"># deduplicate the returned windows:  Tim 6 Jul 2004</span>
    <span class="c1">#return searchChildWindows(topHwnd)</span>
    
    <span class="n">hlist</span><span class="o">=</span><span class="n">searchChildWindows</span><span class="p">(</span><span class="n">topHwnd</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">hlist</span><span class="p">:</span>
        <span class="c1">## remove duplicates</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">hlist</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">hlist</span></div>
    
<div class="viewcode-block" id="findAdditionalControls"><a class="viewcode-back" href="../../messagefunctions.html#natlink.messagefunctions.findAdditionalControls">[docs]</a><span class="k">def</span> <span class="nf">findAdditionalControls</span><span class="p">(</span><span class="n">controls</span><span class="p">,</span>
                 <span class="n">wantedText</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">wantedClass</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">selectionFunction</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Find controls, from a list of already found controls</span>
<span class="sd">    </span>
<span class="sd">    You can identify controls using captions, classes, a custom selection</span>
<span class="sd">    function, or any combination of these. (Multiple selection criteria are</span>
<span class="sd">    ANDed. If this isn&#39;t what&#39;s wanted, use a selection function.)</span>

<span class="sd">    Arguments:</span>
<span class="sd">    topHwnd             The window handle of the top level window in which the</span>
<span class="sd">                        required controls reside.</span>
<span class="sd">    wantedText          Text which the required controls&#39; captions must contain.</span>
<span class="sd">    wantedClass         Class to which the required controls must belong.</span>
<span class="sd">    selectionFunction   Control selection function. Reference to a function</span>
<span class="sd">                        should be passed here. The function should take hwnd as</span>
<span class="sd">                        an argument, and should return True when passed the</span>
<span class="sd">                        hwnd of a desired control.</span>

<span class="sd">    Returns:            The window handles of the controls matching the</span>
<span class="sd">                        supplied selection criteria.    </span>

<span class="sd">    Usage example:      optDialog = findTopWindow(wantedText=&quot;Options&quot;)</span>
<span class="sd">                        def findButtons(hwnd, windowText, windowClass):</span>
<span class="sd">                            return windowClass == &quot;Button&quot;</span>
<span class="sd">                        buttons = findControl(optDialog, wantedText=&quot;Button&quot;)</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">wantedText</span><span class="p">:</span>
        <span class="n">wantedText</span> <span class="o">=</span> <span class="n">_normaliseText</span><span class="p">(</span><span class="n">wantedText</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">searchChildWindows</span><span class="p">(</span><span class="n">currentHwnd</span><span class="p">):</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">childWindows</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">win32gui</span><span class="o">.</span><span class="n">EnumChildWindows</span><span class="p">(</span><span class="n">currentHwnd</span><span class="p">,</span>
                                      <span class="n">_windowEnumerationHandler</span><span class="p">,</span>
                                      <span class="n">childWindows</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">error</span><span class="p">:</span>
            <span class="c1"># This seems to mean that the control *cannot* have child windows,</span>
            <span class="c1"># i.e. is not a container.</span>
            <span class="k">return</span>
        <span class="k">for</span> <span class="n">childHwnd</span><span class="p">,</span> <span class="n">windowText</span><span class="p">,</span> <span class="n">windowClass</span> <span class="ow">in</span> <span class="n">childWindows</span><span class="p">:</span>
            <span class="n">descendantMatchingHwnds</span> <span class="o">=</span> <span class="n">searchChildWindows</span><span class="p">(</span><span class="n">childHwnd</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">descendantMatchingHwnds</span><span class="p">:</span>
                <span class="n">results</span> <span class="o">+=</span> <span class="n">descendantMatchingHwnds</span>

            <span class="k">if</span> <span class="n">wantedText</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">windowText</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="c1">#print(&#39;wanted: %s, window: %s&#39;% (wantedText, windowText)</span>
                <span class="k">if</span> <span class="n">_normaliseText</span><span class="p">(</span><span class="n">windowText</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">wantedText</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="k">continue</span>
            <span class="k">if</span> <span class="n">wantedClass</span> <span class="ow">and</span> \
               <span class="ow">not</span> <span class="n">windowClass</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">wantedClass</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="n">selectionFunction</span> <span class="ow">and</span> \
               <span class="ow">not</span> <span class="n">selectionFunction</span><span class="p">(</span><span class="n">childHwnd</span><span class="p">,</span> <span class="n">windowText</span><span class="p">,</span> <span class="n">windowClass</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">childHwnd</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">results</span>
    

    <span class="c1"># deduplicate the returned windows:  Tim 6 Jul 2004</span>
    <span class="c1">#return searchChildWindows(topHwnd)</span>
    <span class="n">resultsList</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">control</span> <span class="ow">in</span> <span class="n">controls</span><span class="p">:</span>
        <span class="n">hlist</span><span class="o">=</span><span class="n">searchChildWindows</span><span class="p">(</span><span class="n">control</span><span class="p">)</span>
    
        <span class="k">if</span> <span class="n">hlist</span><span class="p">:</span>
            <span class="c1"># deduplicate the list:</span>
            <span class="n">hdict</span><span class="o">=</span><span class="p">{}</span>
            <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">hlist</span><span class="p">:</span>
                <span class="n">hdict</span><span class="p">[</span><span class="n">h</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
            <span class="n">resultsList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hdict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span></div>

            
<div class="viewcode-block" id="selFuncExplorerAddress"><a class="viewcode-back" href="../../messagefunctions.html#natlink.messagefunctions.selFuncExplorerAddress">[docs]</a><span class="k">def</span> <span class="nf">selFuncExplorerAddress</span><span class="p">(</span><span class="n">_hndle</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">Class</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;needed for quick access to explorer CabinetWClass controls</span>
<span class="sd">    </span>
<span class="sd">    Adres (Dutch) or Address (English) and other languages ???</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">Class</span> <span class="o">==</span> <span class="s1">&#39;ToolbarWindow32&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">text</span> <span class="ow">and</span> <span class="n">text</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;Adres: &#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">text</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;Address: &#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">None</span></div>

<span class="c1">## zie ook _folders:</span>

<div class="viewcode-block" id="getwindowtext"><a class="viewcode-back" href="../../messagefunctions.html#natlink.messagefunctions.getwindowtext">[docs]</a><span class="k">def</span> <span class="nf">getwindowtext</span><span class="p">(</span><span class="n">hwnd</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;unicode version of getwindowstext,</span>
<span class="sd">    need ctypes, see top of file</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">length</span> <span class="o">=</span> <span class="n">GetWindowTextLength</span><span class="p">(</span><span class="n">hwnd</span><span class="p">)</span>
    <span class="n">buff</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">create_unicode_buffer</span><span class="p">(</span><span class="n">length</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">GetWindowText</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span> <span class="n">buff</span><span class="p">,</span> <span class="n">length</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">buff</span><span class="o">.</span><span class="n">value</span></div>
  
<div class="viewcode-block" id="getFolderFromCabinetWClass"><a class="viewcode-back" href="../../messagefunctions.html#natlink.messagefunctions.getFolderFromCabinetWClass">[docs]</a><span class="k">def</span> <span class="nf">getFolderFromCabinetWClass</span><span class="p">(</span><span class="n">hndle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;extract folder from a CabinetWClass window</span>
<span class="sd">    </span>
<span class="sd">    (Unimacro grammar _folders)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">controls</span> <span class="o">=</span> <span class="n">findControls</span><span class="p">(</span><span class="n">hndle</span><span class="p">,</span> <span class="n">selectionFunction</span><span class="o">=</span><span class="n">selFuncExplorerAddress</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">controls</span><span class="p">:</span>
        <span class="n">hndle</span> <span class="o">=</span> <span class="n">controls</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">getwindowtext</span><span class="p">(</span><span class="n">hndle</span><span class="p">)</span>
        <span class="c1">## result is probably u&quot;Address: C:\Documents&quot; or so</span>
        <span class="n">folder</span> <span class="o">=</span> <span class="n">extractFolderFromWindowText</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">folder</span>
    <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="getFolderFromDialog"><a class="viewcode-back" href="../../messagefunctions.html#natlink.messagefunctions.getFolderFromDialog">[docs]</a><span class="k">def</span> <span class="nf">getFolderFromDialog</span><span class="p">(</span><span class="n">hndle</span><span class="p">,</span> <span class="n">className</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;dialog for open etc from office etc</span>
<span class="sd">    if #32770, but can be other dialogs, like the messages window itself!</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">className</span> <span class="o">==</span> <span class="s1">&#39;#32770&#39;</span><span class="p">:</span>
        <span class="n">controls</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">findControls</span><span class="p">(</span><span class="n">hndle</span><span class="p">,</span> <span class="n">selectionFunction</span><span class="o">=</span><span class="n">selFuncExplorerAddress</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">controls</span><span class="p">:</span>
            <span class="n">hndle</span> <span class="o">=</span> <span class="n">controls</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">getwindowtext</span><span class="p">(</span><span class="n">hndle</span><span class="p">)</span>
            <span class="n">folder</span> <span class="o">=</span> <span class="n">extractFolderFromWindowText</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">folder</span>
    <span class="k">return</span> <span class="kc">None</span></div>
        
<div class="viewcode-block" id="extractFolderFromWindowText"><a class="viewcode-back" href="../../messagefunctions.html#natlink.messagefunctions.extractFolderFromWindowText">[docs]</a><span class="k">def</span> <span class="nf">extractFolderFromWindowText</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;get folder info from CabinetWClass or #32770 window:</span>
<span class="sd">    </span>
<span class="sd">    if &quot;location:&quot; is found, get that info, urlparse unquote(d)</span>
<span class="sd">    if otherwise : is found (Adress: or Adres: (enx or nld)) return the info after that :</span>
<span class="sd">    </span>
<span class="sd">    no check of valid directory is done</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">text</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;location:&quot;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># ms-search:</span>
        <span class="n">folder</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;location:&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">folder</span> <span class="o">=</span> <span class="n">unquote</span><span class="p">(</span><span class="n">folder</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">text</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># Adress: or Adres:</span>
        <span class="n">folder</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;: &quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># no activefolder info:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="n">folder</span></div>
    
<div class="viewcode-block" id="getTopMenu"><a class="viewcode-back" href="../../messagefunctions.html#natlink.messagefunctions.getTopMenu">[docs]</a><span class="k">def</span> <span class="nf">getTopMenu</span><span class="p">(</span><span class="n">hWnd</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Get a window&#39;s main, top level menu.</span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">    hWnd            The window handle of the top level window for which the top</span>
<span class="sd">                    level menu is required.</span>

<span class="sd">    Returns:        The menu handle of the window&#39;s main, top level menu.</span>

<span class="sd">    Usage example:  hMenu = getTopMenu(hWnd)</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">windll</span><span class="o">.</span><span class="n">user32</span><span class="o">.</span><span class="n">GetMenu</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_long</span><span class="p">(</span><span class="n">hWnd</span><span class="p">))</span></div>

<div class="viewcode-block" id="activateMenuItem"><a class="viewcode-back" href="../../messagefunctions.html#natlink.messagefunctions.activateMenuItem">[docs]</a><span class="k">def</span> <span class="nf">activateMenuItem</span><span class="p">(</span><span class="n">hWnd</span><span class="p">,</span> <span class="n">menuItemPath</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Activate a menu item</span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">    hWnd                The window handle of the top level window whose menu you </span>
<span class="sd">                        wish to activate.</span>
<span class="sd">    menuItemPath        The path to the required menu item. This should be a</span>
<span class="sd">                        sequence specifying the path through the menu to the</span>
<span class="sd">                        required item. Each item in this path can be specified</span>
<span class="sd">                        either as an index, or as a menu name.</span>
<span class="sd">                    </span>
<span class="sd">    Raises:</span>
<span class="sd">    WinGuiAutoError     When the requested menu option isn&#39;t found.</span>

<span class="sd">    Usage example:      activateMenuItem(notepadWindow, (&#39;file&#39;, &#39;open&#39;))</span>
<span class="sd">    </span>
<span class="sd">                        Which is exactly equivalent to...</span>
<span class="sd">                    </span>
<span class="sd">                        activateMenuItem(notepadWindow, (0, 1))</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># pylint: disable=W0104</span>
    <span class="c1"># By Axel Kowald (kowald@molgen.mpg.de)</span>
    <span class="c1"># Modified by S Brunning to accept strings in addition to indicies.</span>

    <span class="c1"># Top level menu    </span>
    <span class="n">hMenu</span> <span class="o">=</span> <span class="n">getTopMenu</span><span class="p">(</span><span class="n">hWnd</span><span class="p">)</span>
    
    <span class="c1"># Get top level menu&#39;s item count. Is there a better way to do this?</span>
    <span class="c1"># Yes .. Tim Couper 22 Jul 2004</span>
    
    <span class="n">hMenuItemCount</span><span class="o">=</span><span class="n">win32gui</span><span class="o">.</span><span class="n">GetMenuItemCount</span><span class="p">(</span><span class="n">hMenu</span><span class="p">)</span>
    
<span class="c1">##    for hMenuItemCount in xrange(256):</span>
<span class="c1">##        try:</span>
<span class="c1">##            _getMenuInfo(hMenu, hMenuItemCount)</span>
<span class="c1">##        except WinGuiAutoError:</span>
<span class="c1">##            break</span>
<span class="c1">##    hMenuItemCount -= 1</span>
    
    <span class="c1"># Walk down submenus</span>
    <span class="k">for</span> <span class="n">submenu</span> <span class="ow">in</span> <span class="n">menuItemPath</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
        <span class="k">try</span><span class="p">:</span> <span class="c1"># submenu is an index</span>
            <span class="mi">0</span> <span class="o">+</span> <span class="n">submenu</span>
            <span class="n">submenuInfo</span> <span class="o">=</span> <span class="n">_getMenuInfo</span><span class="p">(</span><span class="n">hMenu</span><span class="p">,</span> <span class="n">submenu</span><span class="p">)</span>
            <span class="n">hMenu</span><span class="p">,</span> <span class="n">hMenuItemCount</span> <span class="o">=</span> <span class="n">submenuInfo</span><span class="o">.</span><span class="n">submenu</span><span class="p">,</span> <span class="n">submenuInfo</span><span class="o">.</span><span class="n">itemCount</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span> <span class="c1"># Hopefully, submenu is a menu name</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">_dump</span><span class="p">,</span> <span class="n">hMenu</span><span class="p">,</span> <span class="n">hMenuItemCount</span> <span class="o">=</span> <span class="n">_findNamedSubmenu</span><span class="p">(</span><span class="n">hMenu</span><span class="p">,</span>
                                                                <span class="n">hMenuItemCount</span><span class="p">,</span>
                                                                <span class="n">submenu</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">WinGuiAutoError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">WinGuiAutoError</span><span class="p">(</span><span class="s2">&quot;Menu path &quot;</span> <span class="o">+</span>
                                      <span class="nb">repr</span><span class="p">(</span><span class="n">menuItemPath</span><span class="p">)</span> <span class="o">+</span>
                                      <span class="s2">&quot; cannot be found.&quot;</span><span class="p">)</span>
           
    <span class="c1"># Get required menu item&#39;s ID. (the one at the end).</span>
    <span class="n">menuItem</span> <span class="o">=</span> <span class="n">menuItemPath</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">try</span><span class="p">:</span> <span class="c1"># menuItem is an index</span>
        <span class="mi">0</span> <span class="o">+</span> <span class="n">menuItem</span>
        <span class="n">menuItemID</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">windll</span><span class="o">.</span><span class="n">user32</span><span class="o">.</span><span class="n">GetMenuItemID</span><span class="p">(</span><span class="n">hMenu</span><span class="p">,</span>
                                                        <span class="n">menuItem</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span> <span class="c1"># Hopefully, menuItem is a menu name</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">subMenuIndex</span><span class="p">,</span> <span class="n">_dump1</span><span class="p">,</span> <span class="n">_dump2</span> <span class="o">=</span> <span class="n">_findNamedSubmenu</span><span class="p">(</span><span class="n">hMenu</span><span class="p">,</span>
                                        <span class="n">hMenuItemCount</span><span class="p">,</span>
                                        <span class="n">menuItem</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">WinGuiAutoError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">WinGuiAutoError</span><span class="p">(</span><span class="s2">&quot;Menu path &quot;</span> <span class="o">+</span>
                                  <span class="nb">repr</span><span class="p">(</span><span class="n">menuItemPath</span><span class="p">)</span> <span class="o">+</span>
                                  <span class="s2">&quot; cannot be found.&quot;</span><span class="p">)</span>
        <span class="n">menuItemID</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">windll</span><span class="o">.</span><span class="n">user32</span><span class="o">.</span><span class="n">GetMenuItemID</span><span class="p">(</span><span class="n">hMenu</span><span class="p">,</span> <span class="n">subMenuIndex</span><span class="p">)</span>

    <span class="c1"># Activate    </span>
    <span class="n">win32gui</span><span class="o">.</span><span class="n">PostMessage</span><span class="p">(</span><span class="n">hWnd</span><span class="p">,</span> <span class="n">win32con</span><span class="o">.</span><span class="n">WM_COMMAND</span><span class="p">,</span> <span class="n">menuItemID</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.05</span><span class="p">)</span></div>
<span class="c1">##def findMenuItems(hWnd,wantedText):</span>
<span class="c1">##    &quot;&quot;&quot;Finds menu items whose captions contain the text&quot;&quot;&quot;</span>
<span class="c1">##    hMenu = getTopMenu(hWnd)</span>
<span class="c1">##    hMenuItemCount=win32gui.GetMenuItemCount(hMenu)</span>
<span class="c1">##    </span>
<span class="c1">##    for topItem in xrange(hMenuItemCount):</span>
<span class="c1">##            </span>
    
<div class="viewcode-block" id="getMenuInfo"><a class="viewcode-back" href="../../messagefunctions.html#natlink.messagefunctions.getMenuInfo">[docs]</a><span class="k">def</span> <span class="nf">getMenuInfo</span><span class="p">(</span><span class="n">hWnd</span><span class="p">,</span> <span class="n">menuItemPath</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;TODO&#39;&#39;&#39;</span>
    <span class="c1"># pylint: disable=W0104</span>
    <span class="c1"># Top level menu    </span>
    <span class="n">hMenu</span> <span class="o">=</span> <span class="n">getTopMenu</span><span class="p">(</span><span class="n">hWnd</span><span class="p">)</span>
        
    <span class="c1"># Get top level menu&#39;s item count. Is there a better way to do this?</span>
    <span class="c1"># Yes .. Tim Couper 22 Jul 2004</span>
    <span class="n">hMenuItemCount</span><span class="o">=</span><span class="n">win32gui</span><span class="o">.</span><span class="n">GetMenuItemCount</span><span class="p">(</span><span class="n">hMenu</span><span class="p">)</span>
    
<span class="c1">##    for hMenuItemCount in xrange(256):</span>
<span class="c1">##        try:</span>
<span class="c1">##            _getMenuInfo(hMenu, hMenuItemCount)</span>
<span class="c1">##        except WinGuiAutoError:</span>
<span class="c1">##            break</span>
<span class="c1">##    hMenuItemCount -= 1</span>
    <span class="n">submenuInfo</span><span class="o">=</span><span class="kc">None</span> 
    
    <span class="c1"># Walk down submenus</span>
    <span class="k">for</span> <span class="n">submenu</span> <span class="ow">in</span> <span class="n">menuItemPath</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span> <span class="c1"># submenu is an index</span>
            <span class="mi">0</span> <span class="o">+</span> <span class="n">submenu</span>
            <span class="n">submenuInfo</span> <span class="o">=</span> <span class="n">_getMenuInfo</span><span class="p">(</span><span class="n">hMenu</span><span class="p">,</span> <span class="n">submenu</span><span class="p">)</span>
            <span class="n">hMenu</span><span class="p">,</span> <span class="n">hMenuItemCount</span> <span class="o">=</span> <span class="n">submenuInfo</span><span class="o">.</span><span class="n">submenu</span><span class="p">,</span> <span class="n">submenuInfo</span><span class="o">.</span><span class="n">itemCount</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span> <span class="c1"># Hopefully, submenu is a menu name</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">submenuIndex</span><span class="p">,</span> <span class="n">new_hMenu</span><span class="p">,</span> <span class="n">hMenuItemCount</span> <span class="o">=</span> <span class="n">_findNamedSubmenu</span><span class="p">(</span><span class="n">hMenu</span><span class="p">,</span>
                                                                <span class="n">hMenuItemCount</span><span class="p">,</span>
                                                                <span class="n">submenu</span><span class="p">)</span>
                <span class="n">submenuInfo</span> <span class="o">=</span> <span class="n">_getMenuInfo</span><span class="p">(</span><span class="n">hMenu</span><span class="p">,</span> <span class="n">submenuIndex</span><span class="p">)</span>
                <span class="n">hMenu</span> <span class="o">=</span> <span class="n">new_hMenu</span>
            <span class="k">except</span> <span class="n">WinGuiAutoError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">WinGuiAutoError</span><span class="p">(</span><span class="s2">&quot;Menu path &quot;</span> <span class="o">+</span>
                                      <span class="nb">repr</span><span class="p">(</span><span class="n">menuItemPath</span><span class="p">)</span> <span class="o">+</span>
                                      <span class="s2">&quot; cannot be found.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">submenuInfo</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">WinGuiAutoError</span><span class="p">(</span><span class="s2">&quot;Menu path &quot;</span> <span class="o">+</span>
                              <span class="nb">repr</span><span class="p">(</span><span class="n">menuItemPath</span><span class="p">)</span> <span class="o">+</span>
                              <span class="s2">&quot; cannot be found. (Null menu path?)&quot;</span><span class="p">)</span>
        
    
    <span class="k">return</span> <span class="n">submenuInfo</span></div>
    
<span class="k">def</span> <span class="nf">_getMenuInfo</span><span class="p">(</span><span class="n">hMenu</span><span class="p">,</span> <span class="n">uIDItem</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Get various info about a menu item.</span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">    hMenu               The menu in which the item is to be found.</span>
<span class="sd">    uIDItem             The item&#39;s index</span>

<span class="sd">    Returns:            Menu item information object. This object is basically</span>
<span class="sd">                        a &#39;bunch&#39;</span>
<span class="sd">                        (see http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/52308).</span>
<span class="sd">                        It will have useful attributes: name, itemCount,</span>
<span class="sd">                        submenu, isChecked, isDisabled, isGreyed, and</span>
<span class="sd">                        isSeparator</span>
<span class="sd">                    </span>
<span class="sd">    Raises:</span>
<span class="sd">    WinGuiAutoError     When the requested menu option isn&#39;t found.       </span>

<span class="sd">    Usage example:      submenuInfo = _getMenuInfo(hMenu, submenu)</span>
<span class="sd">                        hMenu, hMenuItemCount = submenuInfo.submenu, submenuInfo.itemCount</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># An object to hold the menu info</span>
    <span class="k">class</span> <span class="nc">MenuInfo</span><span class="p">(</span><span class="n">Bunch</span><span class="p">):</span>
        <span class="k">pass</span>
    <span class="n">menuInfo</span> <span class="o">=</span> <span class="n">MenuInfo</span><span class="p">()</span>

    <span class="c1"># Menu state    </span>
    <span class="n">menuState</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">windll</span><span class="o">.</span><span class="n">user32</span><span class="o">.</span><span class="n">GetMenuState</span><span class="p">(</span><span class="n">hMenu</span><span class="p">,</span>
                                                  <span class="n">uIDItem</span><span class="p">,</span>
                                                  <span class="n">win32con</span><span class="o">.</span><span class="n">MF_BYPOSITION</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">menuState</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">WinGuiAutoError</span><span class="p">(</span><span class="s2">&quot;No such menu item, hMenu=&quot;</span> <span class="o">+</span>
                              <span class="nb">str</span><span class="p">(</span><span class="n">hMenu</span><span class="p">)</span> <span class="o">+</span>
                              <span class="s2">&quot; uIDItem=&quot;</span> <span class="o">+</span>
                              <span class="nb">str</span><span class="p">(</span><span class="n">uIDItem</span><span class="p">))</span>
    
    <span class="c1"># Menu name</span>
    <span class="n">menuName</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_buffer</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\000</span><span class="s2">&quot;</span> <span class="o">*</span> <span class="mi">32</span><span class="p">)</span>
    <span class="n">ctypes</span><span class="o">.</span><span class="n">windll</span><span class="o">.</span><span class="n">user32</span><span class="o">.</span><span class="n">GetMenuStringA</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">(</span><span class="n">hMenu</span><span class="p">),</span>
                                        <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">(</span><span class="n">uIDItem</span><span class="p">),</span>
                                        <span class="n">menuName</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">menuName</span><span class="p">)),</span>
                                        <span class="n">win32con</span><span class="o">.</span><span class="n">MF_BYPOSITION</span><span class="p">)</span>
    <span class="n">menuInfo</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">menuName</span><span class="o">.</span><span class="n">value</span>

    <span class="c1"># Sub menu info</span>
    <span class="n">menuInfo</span><span class="o">.</span><span class="n">itemCount</span> <span class="o">=</span> <span class="n">menuState</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span>
    <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">menuState</span> <span class="o">&amp;</span> <span class="n">win32con</span><span class="o">.</span><span class="n">MF_POPUP</span><span class="p">):</span>
        <span class="n">menuInfo</span><span class="o">.</span><span class="n">submenu</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">windll</span><span class="o">.</span><span class="n">user32</span><span class="o">.</span><span class="n">GetSubMenu</span><span class="p">(</span><span class="n">hMenu</span><span class="p">,</span> <span class="n">uIDItem</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">menuInfo</span><span class="o">.</span><span class="n">submenu</span> <span class="o">=</span> <span class="kc">None</span>
        
    <span class="n">menuInfo</span><span class="o">.</span><span class="n">isChecked</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">menuState</span> <span class="o">&amp;</span> <span class="n">win32con</span><span class="o">.</span><span class="n">MF_CHECKED</span><span class="p">)</span>
    <span class="n">menuInfo</span><span class="o">.</span><span class="n">isDisabled</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">menuState</span> <span class="o">&amp;</span> <span class="n">win32con</span><span class="o">.</span><span class="n">MF_DISABLED</span><span class="p">)</span>
    <span class="n">menuInfo</span><span class="o">.</span><span class="n">isGreyed</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">menuState</span> <span class="o">&amp;</span> <span class="n">win32con</span><span class="o">.</span><span class="n">MF_GRAYED</span><span class="p">)</span>
    <span class="n">menuInfo</span><span class="o">.</span><span class="n">isSeparator</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">menuState</span> <span class="o">&amp;</span> <span class="n">win32con</span><span class="o">.</span><span class="n">MF_SEPARATOR</span><span class="p">)</span>
    <span class="c1"># ... there are more, but these are the ones I&#39;m interested in thus far.</span>
    
    <span class="k">return</span> <span class="n">menuInfo</span>

<div class="viewcode-block" id="clickButton"><a class="viewcode-back" href="../../messagefunctions.html#natlink.messagefunctions.clickButton">[docs]</a><span class="k">def</span> <span class="nf">clickButton</span><span class="p">(</span><span class="n">hwnd</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Simulates a single mouse click on a button</span>

<span class="sd">    Arguments:</span>
<span class="sd">    hwnd    Window handle of the required button.</span>

<span class="sd">    Usage example:  okButton = findControl(fontDialog,</span>
<span class="sd">                                           wantedClass=&quot;Button&quot;,</span>
<span class="sd">                                           wantedText=&quot;OK&quot;)</span>
<span class="sd">                    clickButton(okButton)</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">_sendNotifyMessage</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span> <span class="n">win32con</span><span class="o">.</span><span class="n">BN_CLICKED</span><span class="p">)</span></div>

<div class="viewcode-block" id="clickStatic"><a class="viewcode-back" href="../../messagefunctions.html#natlink.messagefunctions.clickStatic">[docs]</a><span class="k">def</span> <span class="nf">clickStatic</span><span class="p">(</span><span class="n">hwnd</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Simulates a single mouse click on a static</span>

<span class="sd">    Arguments:</span>
<span class="sd">    hwnd    Window handle of the required static.</span>

<span class="sd">    Usage example:  TODO</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">_sendNotifyMessage</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span> <span class="n">win32con</span><span class="o">.</span><span class="n">STN_CLICKED</span><span class="p">)</span></div>

<div class="viewcode-block" id="doubleClickStatic"><a class="viewcode-back" href="../../messagefunctions.html#natlink.messagefunctions.doubleClickStatic">[docs]</a><span class="k">def</span> <span class="nf">doubleClickStatic</span><span class="p">(</span><span class="n">hwnd</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Simulates a double mouse click on a static</span>

<span class="sd">    Arguments:</span>
<span class="sd">    hwnd    Window handle of the required static.</span>

<span class="sd">    Usage example:  TODO</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">_sendNotifyMessage</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span> <span class="n">win32con</span><span class="o">.</span><span class="n">STN_DBLCLK</span><span class="p">)</span></div>

<div class="viewcode-block" id="getComboboxItems"><a class="viewcode-back" href="../../messagefunctions.html#natlink.messagefunctions.getComboboxItems">[docs]</a><span class="k">def</span> <span class="nf">getComboboxItems</span><span class="p">(</span><span class="n">hwnd</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Returns the items in a combo box control.</span>

<span class="sd">    Arguments:</span>
<span class="sd">    hwnd            Window handle for the combo box.</span>

<span class="sd">    Returns:        Combo box items.</span>

<span class="sd">    Usage example:  fontCombo = findControl(fontDialog, wantedClass=&quot;ComboBox&quot;)</span>
<span class="sd">                    fontComboItems = getComboboxItems(fontCombo)</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="k">return</span> <span class="n">_getMultipleWindowValues</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span>
                                    <span class="n">getCountMessage</span><span class="o">=</span><span class="n">win32con</span><span class="o">.</span><span class="n">CB_GETCOUNT</span><span class="p">,</span>
                                    <span class="n">getValueMessage</span><span class="o">=</span><span class="n">win32con</span><span class="o">.</span><span class="n">CB_GETLBTEXT</span><span class="p">)</span></div>

<div class="viewcode-block" id="selectComboboxItem"><a class="viewcode-back" href="../../messagefunctions.html#natlink.messagefunctions.selectComboboxItem">[docs]</a><span class="k">def</span> <span class="nf">selectComboboxItem</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Selects a specified item in a Combo box control.</span>

<span class="sd">    Arguments:</span>
<span class="sd">    hwnd            Window handle of the required combo box.</span>
<span class="sd">    item            The reqired item. Either an index, of the text of the</span>
<span class="sd">                    required item.</span>

<span class="sd">    Usage example:  fontComboItems = getComboboxItems(fontCombo)</span>
<span class="sd">                    selectComboboxItem(fontCombo,</span>
<span class="sd">                                       random.choice(fontComboItems))</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">try</span><span class="p">:</span> <span class="c1"># item is an index Use this to select</span>
        <span class="mi">0</span> <span class="o">+</span> <span class="n">item</span>
        <span class="n">win32gui</span><span class="o">.</span><span class="n">SendMessage</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span> <span class="n">win32con</span><span class="o">.</span><span class="n">CB_SETCURSEL</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">_sendNotifyMessage</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span> <span class="n">win32con</span><span class="o">.</span><span class="n">CBN_SELCHANGE</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span> <span class="c1"># Item is a string - find the index, and use that</span>
        <span class="n">items</span> <span class="o">=</span> <span class="n">getComboboxItems</span><span class="p">(</span><span class="n">hwnd</span><span class="p">)</span>
        <span class="n">itemIndex</span> <span class="o">=</span> <span class="n">items</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">selectComboboxItem</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span> <span class="n">itemIndex</span><span class="p">)</span></div>

<div class="viewcode-block" id="getListboxItems"><a class="viewcode-back" href="../../messagefunctions.html#natlink.messagefunctions.getListboxItems">[docs]</a><span class="k">def</span> <span class="nf">getListboxItems</span><span class="p">(</span><span class="n">hwnd</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Returns the items in a list box control.</span>

<span class="sd">    Arguments:</span>
<span class="sd">    hwnd            Window handle for the list box.</span>

<span class="sd">    Returns:        List box items.</span>

<span class="sd">    Usage example:  docType = findControl(newDialog, wantedClass=&quot;ListBox&quot;)</span>
<span class="sd">                    typeListBox = getListboxItems(docType)</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="k">return</span> <span class="n">_getMultipleWindowValues</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span>
                                    <span class="n">getCountMessage</span><span class="o">=</span><span class="n">win32con</span><span class="o">.</span><span class="n">LB_GETCOUNT</span><span class="p">,</span>
                                    <span class="n">getValueMessage</span><span class="o">=</span><span class="n">win32con</span><span class="o">.</span><span class="n">LB_GETTEXT</span><span class="p">)</span></div>

<div class="viewcode-block" id="selectListboxItem"><a class="viewcode-back" href="../../messagefunctions.html#natlink.messagefunctions.selectListboxItem">[docs]</a><span class="k">def</span> <span class="nf">selectListboxItem</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Selects a specified item in a list box control.</span>

<span class="sd">    Arguments:</span>
<span class="sd">    hwnd            Window handle of the required list box.</span>
<span class="sd">    item            The reqired item. Either an index, of the text of the</span>
<span class="sd">                    required item.</span>

<span class="sd">    Usage example:  docType = findControl(newDialog, wantedClass=&quot;ListBox&quot;)</span>
<span class="sd">                    typeListBox = getListboxItems(docType)</span>
<span class="sd">                    </span>
<span class="sd">                    # Select a type at random</span>
<span class="sd">                    selectListboxItem(docType,</span>
<span class="sd">                                      random.randint(0, len(typeListBox)-1))</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">try</span><span class="p">:</span> <span class="c1"># item is an index Use this to select</span>
        <span class="mi">0</span> <span class="o">+</span> <span class="n">item</span>
        <span class="n">win32gui</span><span class="o">.</span><span class="n">SendMessage</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span> <span class="n">win32con</span><span class="o">.</span><span class="n">LB_SETCURSEL</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">_sendNotifyMessage</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span> <span class="n">win32con</span><span class="o">.</span><span class="n">LBN_SELCHANGE</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span> <span class="c1"># Item is a string - find the index, and use that</span>
        <span class="n">items</span> <span class="o">=</span> <span class="n">getListboxItems</span><span class="p">(</span><span class="n">hwnd</span><span class="p">)</span>
        <span class="n">itemIndex</span> <span class="o">=</span> <span class="n">items</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">selectListboxItem</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span> <span class="n">itemIndex</span><span class="p">)</span></div>

<span class="c1">#EM_GETFIRSTVISIBLELINE</span>
<span class="k">def</span> <span class="nf">getFirstVisibleLine</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span> <span class="n">classname</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    
    <span class="k">if</span> <span class="n">classname</span> <span class="ow">and</span> <span class="n">classname</span> <span class="o">==</span> <span class="s1">&#39;Scintilla&#39;</span><span class="p">:</span>
        <span class="n">getfirstvisibleline</span> <span class="o">=</span> <span class="n">scintillacon</span><span class="o">.</span><span class="n">SCI_GETFIRSTVISIBLELINE</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">getfirstvisibleline</span> <span class="o">=</span> <span class="n">win32con</span><span class="o">.</span><span class="n">EM_GETFIRSTVISIBLELINE</span>
    
    <span class="k">return</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">SendMessage</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span> <span class="n">getfirstvisibleline</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                                    
<div class="viewcode-block" id="getEditText"><a class="viewcode-back" href="../../messagefunctions.html#natlink.messagefunctions.getEditText">[docs]</a><span class="k">def</span> <span class="nf">getEditText</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">classname</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Returns the text in an edit control.</span>

<span class="sd">    Arguments:</span>
<span class="sd">    hwnd            Window handle for the edit control.</span>

<span class="sd">    Returns         Edit control text lines. (as a list of lines!)</span>

<span class="sd">    Usage example:  pprint.pprint(getEditText(editArea))</span>
<span class="sd">    </span>
<span class="sd">    Note: this is the slow version, use getWindowTextAll for faster access, but</span>
<span class="sd">    the end of line characters must be corrected depending on the control.</span>
<span class="sd">    </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">classname</span> <span class="ow">and</span> <span class="n">classname</span> <span class="o">==</span> <span class="s1">&#39;Scintilla&#39;</span><span class="p">:</span>
        <span class="n">getline</span><span class="p">,</span> <span class="n">getlinecount</span> <span class="o">=</span> <span class="n">scintillacon</span><span class="o">.</span><span class="n">SCI_GETLINE</span><span class="p">,</span> <span class="n">scintillacon</span><span class="o">.</span><span class="n">SCI_GETLINECOUNT</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">getline</span><span class="p">,</span> <span class="n">getlinecount</span> <span class="o">=</span> <span class="n">win32con</span><span class="o">.</span><span class="n">EM_GETLINE</span><span class="p">,</span> <span class="n">win32con</span><span class="o">.</span><span class="n">EM_GETLINECOUNT</span>
        
    <span class="k">if</span> <span class="n">visible</span><span class="p">:</span>
        <span class="n">firstLine</span> <span class="o">=</span> <span class="n">getFirstVisibleLine</span><span class="p">(</span><span class="n">hwnd</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">firstLine</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">List</span> <span class="o">=</span>  <span class="n">_getMultipleWindowValues</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span>
                                    <span class="n">getCountMessage</span><span class="o">=</span><span class="n">win32con</span><span class="o">.</span><span class="n">EM_GETLINECOUNT</span><span class="p">,</span>
                                    <span class="n">getValueMessage</span><span class="o">=</span><span class="n">win32con</span><span class="o">.</span><span class="n">EM_GETLINE</span><span class="p">,</span>
                                    <span class="n">first</span><span class="o">=</span><span class="n">firstLine</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">List</span> <span class="c1"># [l.rstrip(&#39;\n\r&#39;) for l in List]</span></div>
    
<div class="viewcode-block" id="setEditText"><a class="viewcode-back" href="../../messagefunctions.html#natlink.messagefunctions.setEditText">[docs]</a><span class="k">def</span> <span class="nf">setEditText</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">append</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">classname</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Set an edit control&#39;s text.</span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">    hwnd            The edit control&#39;s hwnd.</span>
<span class="sd">    text            The text to send to the control. This can be a single</span>
<span class="sd">                    string, or a sequence of strings. If the latter, each will</span>
<span class="sd">                    be become a a separate line in the control.</span>
<span class="sd">    append          Should the new text be appended to the existing text?</span>
<span class="sd">                    Defaults to False, meaning that any existing text will be</span>
<span class="sd">                    replaced. If True, the new text will be appended to the end</span>
<span class="sd">                    of the existing text.</span>
<span class="sd">                    Note that the first line of the new text will be directly</span>
<span class="sd">                    appended to the end of the last line of the existing text.</span>
<span class="sd">                    If appending lines of text, you may wish to pass in an</span>
<span class="sd">                    empty string as the 1st element of the &#39;text&#39; argument.</span>

<span class="sd">    Usage example:  print(&quot;Enter various bits of text.&quot;</span>
<span class="sd">                    setEditText(editArea, &quot;Hello, again!&quot;)</span>
<span class="sd">                    setEditText(editArea, &quot;You still there?&quot;)</span>
<span class="sd">                    setEditText(editArea, [&quot;Here come&quot;, &quot;two lines!&quot;])</span>
<span class="sd">                    </span>
<span class="sd">                    print(&quot;Add some...&quot;</span>
<span class="sd">                    setEditText(editArea, [&quot;&quot;, &quot;And a 3rd one!&quot;], append=True)</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="ow">in</span> <span class="p">(</span><span class="n">types</span><span class="o">.</span><span class="n">StringType</span><span class="p">,):</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\r\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    <span class="c1">#</span>
    <span class="c1">## Ensure that text is a list        </span>
    <span class="c1">#</span>
    <span class="c1">#try:</span>
    <span class="c1">#    text + &#39;&#39;</span>
    <span class="c1">#    text = [text]</span>
    <span class="c1">#except TypeError:</span>
    <span class="c1">#    pass</span>

    <span class="c1"># Set the current selection range, depending on append flag</span>
    <span class="c1"># -1 (append) means clear selection and put at cursor position</span>
    <span class="k">if</span> <span class="n">classname</span> <span class="ow">and</span> <span class="n">classname</span> <span class="o">==</span> <span class="s2">&quot;Scintilla&quot;</span><span class="p">:</span>
        <span class="n">setsel</span><span class="p">,</span> <span class="n">replacesel</span> <span class="o">=</span> <span class="n">scintillacon</span><span class="o">.</span><span class="n">SCI_SETSEL</span><span class="p">,</span> <span class="n">scintillacon</span><span class="o">.</span><span class="n">SCI_REPLACESEL</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">setsel</span><span class="p">,</span> <span class="n">replacesel</span> <span class="o">=</span> <span class="n">win32con</span><span class="o">.</span><span class="n">EM_SETSEL</span><span class="p">,</span> <span class="n">win32con</span><span class="o">.</span><span class="n">EM_REPLACESEL</span>
    
    <span class="k">if</span> <span class="n">append</span><span class="p">:</span>
        <span class="n">win32gui</span><span class="o">.</span><span class="n">SendMessage</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span> <span class="n">setsel</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">win32gui</span><span class="o">.</span><span class="n">SendMessage</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span> <span class="n">setsel</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                             
    <span class="c1"># Send the text</span>
    <span class="n">win32gui</span><span class="o">.</span><span class="n">SendMessage</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span> <span class="n">replacesel</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span></div>



<div class="viewcode-block" id="replaceEditText"><a class="viewcode-back" href="../../messagefunctions.html#natlink.messagefunctions.replaceEditText">[docs]</a><span class="k">def</span> <span class="nf">replaceEditText</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">classname</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;replace selection of Edit text with text</span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">    hwnd            The edit control&#39;s hwnd.</span>
<span class="sd">    text            The text to send to the control. This can be a single</span>
<span class="sd">                    string, or a sequence of strings. If the latter, each will</span>
<span class="sd">                    be become a a separate line in the control.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">classname</span> <span class="ow">and</span> <span class="n">classname</span> <span class="o">==</span> <span class="s2">&quot;Scintilla&quot;</span><span class="p">:</span>
        <span class="n">setsel</span><span class="p">,</span> <span class="n">replacesel</span> <span class="o">=</span> <span class="n">scintillacon</span><span class="o">.</span><span class="n">SCI_SETSEL</span><span class="p">,</span> <span class="n">scintillacon</span><span class="o">.</span><span class="n">SCI_REPLACESEL</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">setsel</span><span class="p">,</span> <span class="n">replacesel</span> <span class="o">=</span> <span class="n">win32con</span><span class="o">.</span><span class="n">EM_SETSEL</span><span class="p">,</span> <span class="n">win32con</span><span class="o">.</span><span class="n">EM_REPLACESEL</span>
    
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="ow">in</span> <span class="p">(</span><span class="n">types</span><span class="o">.</span><span class="n">StringType</span><span class="p">,):</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    <span class="c1">## Ensure that text is a list        </span>
    <span class="c1">#try:</span>
    <span class="c1">#    text + &#39;&#39;</span>
    <span class="c1">#    text = [text]</span>
    <span class="c1">#except TypeError:</span>
    <span class="c1">#    pass</span>

    <span class="c1"># assume the selection is set (or just end of buffer)</span>
    <span class="c1"># Send the text</span>
    <span class="n">win32gui</span><span class="o">.</span><span class="n">SendMessage</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span> <span class="n">replacesel</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span></div>

<div class="viewcode-block" id="appendEditText"><a class="viewcode-back" href="../../messagefunctions.html#natlink.messagefunctions.appendEditText">[docs]</a><span class="k">def</span> <span class="nf">appendEditText</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">place</span><span class="o">=</span><span class="s2">&quot;end&quot;</span><span class="p">,</span> <span class="n">classname</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;replace selection of Edit text with text</span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">    hwnd            The edit control&#39;s hwnd.</span>
<span class="sd">    text            The text to send to the control. This can be a single</span>
<span class="sd">                    string, or a sequence of strings. If the latter, each will</span>
<span class="sd">                    be become a a separate line in the control.</span>
<span class="sd">    place:          &quot;end&quot; at end of buffer, can also be &quot;start&quot;</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">classname</span> <span class="ow">and</span> <span class="n">classname</span> <span class="o">==</span> <span class="s2">&quot;Scintilla&quot;</span><span class="p">:</span>
        <span class="n">replacesel</span> <span class="o">=</span> <span class="n">scintillacon</span><span class="o">.</span><span class="n">SCI_SETSEL</span><span class="p">,</span> <span class="n">scintillacon</span><span class="o">.</span><span class="n">SCI_REPLACESEL</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">replacesel</span> <span class="o">=</span> <span class="n">win32con</span><span class="o">.</span><span class="n">EM_REPLACESEL</span>
    
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="ow">in</span> <span class="p">(</span><span class="n">types</span><span class="o">.</span><span class="n">StringType</span><span class="p">,):</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">place</span> <span class="o">==</span> <span class="s2">&quot;end&quot;</span><span class="p">:</span>
        <span class="n">current</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">getEditText</span><span class="p">(</span><span class="n">hwnd</span><span class="p">))</span>
        <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">current</span><span class="p">)</span>
        <span class="n">setSelection</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">place</span> <span class="o">==</span> <span class="s2">&quot;start&quot;</span><span class="p">:</span>
        <span class="n">setSelection</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;appendEditText, invalid place parameter: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span> <span class="n">place</span><span class="p">)</span>
        
    <span class="c1"># Send the text</span>
    <span class="n">win32gui</span><span class="o">.</span><span class="n">SendMessage</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span> <span class="n">replacesel</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span></div>

<div class="viewcode-block" id="getSelection"><a class="viewcode-back" href="../../messagefunctions.html#natlink.messagefunctions.getSelection">[docs]</a><span class="k">def</span> <span class="nf">getSelection</span><span class="p">(</span><span class="n">hndle</span><span class="p">,</span> <span class="n">classname</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;returns the start and end position of the selection.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">classname</span> <span class="ow">and</span> <span class="n">classname</span> <span class="o">==</span> <span class="s2">&quot;Scintilla&quot;</span><span class="p">:</span>
        <span class="n">getsel</span><span class="o">=</span> <span class="n">scintillacon</span><span class="o">.</span><span class="n">SCI_GETSEL</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">getsel</span> <span class="o">=</span> <span class="n">win32con</span><span class="o">.</span><span class="n">EM_GETSEL</span>
    
    <span class="n">selInfo</span> <span class="o">=</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">SendMessage</span><span class="p">(</span><span class="n">hndle</span><span class="p">,</span> <span class="n">getsel</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">st</span> <span class="o">=</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">LOWORD</span><span class="p">(</span><span class="n">selInfo</span><span class="p">)</span>
    <span class="n">en</span> <span class="o">=</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">HIWORD</span><span class="p">(</span><span class="n">selInfo</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">st</span><span class="p">,</span> <span class="n">en</span></div>

<div class="viewcode-block" id="isVisible"><a class="viewcode-back" href="../../messagefunctions.html#natlink.messagefunctions.isVisible">[docs]</a><span class="k">def</span> <span class="nf">isVisible</span><span class="p">(</span><span class="n">hndle</span><span class="p">,</span> <span class="n">classname</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;check if window/control is visible</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">classname</span> <span class="o">==</span> <span class="s1">&#39;Scintilla&#39;</span><span class="p">:</span>
        <span class="n">testnum</span> <span class="o">=</span> <span class="n">scintillacon</span><span class="o">.</span><span class="n">SCI_GETFIRSTVISIBLELINE</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="c1"># not know how to do...</span>
        
    <span class="n">v</span> <span class="o">=</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">SendMessage</span><span class="p">(</span><span class="n">hndle</span><span class="p">,</span> <span class="n">testnum</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">v</span></div>


<span class="k">def</span> <span class="nf">setSelection</span><span class="p">(</span><span class="n">hndle</span><span class="p">,</span> <span class="n">lo</span><span class="p">,</span> <span class="n">hi</span><span class="p">,</span> <span class="n">classname</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

    <span class="k">if</span> <span class="n">classname</span> <span class="ow">and</span> <span class="n">classname</span> <span class="o">==</span> <span class="s2">&quot;Scintilla&quot;</span><span class="p">:</span>
        <span class="n">setsel</span> <span class="o">=</span> <span class="n">scintillacon</span><span class="o">.</span><span class="n">SCI_SETSEL</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">setsel</span> <span class="o">=</span> <span class="n">win32con</span><span class="o">.</span><span class="n">EM_SETSEL</span>

    <span class="n">win32gui</span><span class="o">.</span><span class="n">SendMessage</span><span class="p">(</span><span class="n">hndle</span><span class="p">,</span> <span class="n">setsel</span><span class="p">,</span> <span class="n">lo</span><span class="p">,</span> <span class="n">hi</span><span class="p">)</span>

<div class="viewcode-block" id="getLineNumber"><a class="viewcode-back" href="../../messagefunctions.html#natlink.messagefunctions.getLineNumber">[docs]</a><span class="k">def</span> <span class="nf">getLineNumber</span><span class="p">(</span><span class="n">hndle</span><span class="p">,</span> <span class="n">charPos</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">classname</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;get the number of the line containing char or the selection (1 based!)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">num</span> <span class="o">=</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">SendMessage</span><span class="p">(</span><span class="n">hndle</span><span class="p">,</span> <span class="n">win32con</span><span class="o">.</span><span class="n">EM_LINEFROMCHAR</span><span class="p">,</span> <span class="n">charPos</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">num</span> <span class="o">+</span> <span class="mi">1</span></div>

<div class="viewcode-block" id="getNumberOfLines"><a class="viewcode-back" href="../../messagefunctions.html#natlink.messagefunctions.getNumberOfLines">[docs]</a><span class="k">def</span> <span class="nf">getNumberOfLines</span><span class="p">(</span><span class="n">hndle</span><span class="p">,</span> <span class="n">classname</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;retrieves the number of lines in the buffer</span>
<span class="sd">    </span>
<span class="sd">    the total buflen fails, goes better with getRawTextLength (but is not accurate)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">classname</span> <span class="ow">and</span> <span class="n">classname</span> <span class="o">==</span> <span class="s2">&quot;Scintilla&quot;</span><span class="p">:</span>
        <span class="n">getlinecount</span> <span class="o">=</span> <span class="n">scintillacon</span><span class="o">.</span><span class="n">SCI_GETLINECOUNT</span> 
    <span class="k">else</span><span class="p">:</span>
        <span class="n">getlinecount</span> <span class="o">=</span> <span class="n">win32con</span><span class="o">.</span><span class="n">EM_GETLINECOUNT</span>
    
    <span class="n">numLines</span> <span class="o">=</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">SendMessage</span><span class="p">(</span><span class="n">hndle</span><span class="p">,</span> <span class="n">getlinecount</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">numLines</span></div>

<span class="c1"># length and buffer for receiving 1 line of text. If text length exceeds the</span>
<span class="c1"># LINE_BUFFER_LENGTH, it is doubled.</span>
<span class="c1">## &#39;c&#39; naar &#39;b&#39;  TODOQH</span>
<span class="n">LINE_BUFFER_LENGTH</span> <span class="o">=</span> <span class="mi">256</span>
<span class="n">LINE_TEXT_BUFFER</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="p">(</span><span class="n">LINE_BUFFER_LENGTH</span><span class="p">))</span>
<span class="n">bufferlength</span>  <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="n">LINE_BUFFER_LENGTH</span><span class="p">)</span> <span class="c1"># This is a C style int.</span>
<span class="n">LINE_TEXT_BUFFER</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">bufferlength</span> <span class="o">+</span> <span class="sa">b</span><span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="n">LINE_BUFFER_LENGTH</span><span class="p">)</span>

<div class="viewcode-block" id="getTextLine"><a class="viewcode-back" href="../../messagefunctions.html#natlink.messagefunctions.getTextLine">[docs]</a><span class="k">def</span> <span class="nf">getTextLine</span><span class="p">(</span><span class="n">hndle</span><span class="p">,</span> <span class="n">lineNum</span><span class="p">,</span> <span class="n">classname</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;get a line of text from buffer, with line number lineNum</span>
<span class="sd">    </span>
<span class="sd">    Note: the lines are dependent on the width of the control, if it scrolls,</span>
<span class="sd">    the number of lines increases.</span>
<span class="sd">    Note: lineNum is 0 based!!!</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">LINE_BUFFER_LENGTH</span><span class="p">,</span> <span class="n">LINE_TEXT_BUFFER</span>
    <span class="k">if</span> <span class="n">classname</span> <span class="ow">and</span> <span class="n">classname</span> <span class="o">==</span> <span class="s2">&quot;Scintilla&quot;</span><span class="p">:</span>
        <span class="n">getline</span><span class="o">=</span> <span class="n">scintillacon</span><span class="o">.</span><span class="n">SCI_GETLINE</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">getline</span> <span class="o">=</span> <span class="n">win32con</span><span class="o">.</span><span class="n">EM_GETLINE</span>
    
    
    
    
    <span class="n">lenReceived</span> <span class="o">=</span>  <span class="n">win32gui</span><span class="o">.</span><span class="n">SendMessage</span><span class="p">(</span><span class="n">hndle</span><span class="p">,</span> <span class="n">getline</span><span class="p">,</span>
                                        <span class="n">lineNum</span><span class="p">,</span> <span class="n">LINE_TEXT_BUFFER</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">LINE_BUFFER_LENGTH</span> <span class="o">-</span> <span class="n">lenReceived</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
        <span class="n">LINE_BUFFER_LENGTH</span> <span class="o">*=</span> <span class="mi">2</span>
        <span class="n">bufferlength</span>  <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="n">LINE_BUFFER_LENGTH</span><span class="p">)</span> <span class="c1"># This is a C style int.</span>
        <span class="n">LINE_TEXT_BUFFER</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">bufferlength</span> <span class="o">+</span> <span class="sa">b</span><span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="n">LINE_BUFFER_LENGTH</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;line too small, double to </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span> <span class="n">LINE_BUFFER_LENGTH</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">getTextLine</span><span class="p">(</span><span class="n">hndle</span><span class="p">,</span> <span class="n">lineNum</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">LINE_TEXT_BUFFER</span><span class="o">.</span><span class="n">tostring</span><span class="p">()[:</span><span class="n">lenReceived</span><span class="p">]</span></div>

<div class="viewcode-block" id="getRawTextLength"><a class="viewcode-back" href="../../messagefunctions.html#natlink.messagefunctions.getRawTextLength">[docs]</a><span class="k">def</span> <span class="nf">getRawTextLength</span><span class="p">(</span><span class="n">hndle</span><span class="p">,</span> <span class="n">classname</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;get the one stroke text length, this is with uncorrected \r\n characters</span>
<span class="sd">    </span>
<span class="sd">    can be used to check if buffer has changed in length...</span>
<span class="sd">    (this call takes nearly as much time as the getWindowTextAll call)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">classname</span> <span class="ow">and</span> <span class="n">classname</span> <span class="o">==</span> <span class="s2">&quot;Scintilla&quot;</span><span class="p">:</span>
        <span class="n">gettextlength</span> <span class="o">=</span> <span class="n">scintillacon</span><span class="o">.</span><span class="n">SCI_GETTEXTLENGTH</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">gettextlength</span> <span class="o">=</span> <span class="n">win32con</span><span class="o">.</span><span class="n">WM_GETTEXTLENGTH</span>
    
    <span class="k">return</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">SendMessage</span><span class="p">(</span><span class="n">hndle</span><span class="p">,</span> <span class="n">gettextlength</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span></div>
<span class="c1">#</span>

<span class="n">offsetLetter</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># ???           </span>
<span class="n">keySynonyms</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">backspace</span><span class="o">=</span><span class="s2">&quot;back&quot;</span><span class="p">,</span>
                   <span class="n">enter</span><span class="o">=</span><span class="s2">&quot;return&quot;</span><span class="p">)</span>
<span class="n">keySynonyms</span><span class="p">[</span><span class="s1">&#39;del&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;delete&quot;</span>


<span class="c1">## functions with sendkeys seem not to work. Want the hndle of a control, but this is not doable.</span>
<span class="c1">## the _sendkeys via ctypes seems to work better. </span>
<div class="viewcode-block" id="sendKey"><a class="viewcode-back" href="../../messagefunctions.html#natlink.messagefunctions.sendKey">[docs]</a><span class="k">def</span> <span class="nf">sendKey</span><span class="p">(</span><span class="n">hndle</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;sendKey function from messagesfunctions, not in active use</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># pylint: disable=C0321</span>
    <span class="n">kdown</span> <span class="o">=</span> <span class="n">win32con</span><span class="o">.</span><span class="n">WM_KEYDOWN</span>
    <span class="n">char</span> <span class="o">=</span> <span class="n">win32con</span><span class="o">.</span><span class="n">WM_CHAR</span>
    <span class="n">kup</span> <span class="o">=</span> <span class="n">win32con</span><span class="o">.</span><span class="n">WM_KEYUP</span>
    <span class="n">sm</span> <span class="o">=</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">SendMessage</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">ctrl</span> <span class="o">=</span> <span class="n">alt</span> <span class="o">=</span> <span class="n">shift</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">kCode</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;{&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">key</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;}&quot;</span><span class="p">):</span>
            <span class="n">key</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">keys</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;+&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s1">&#39;ctrl&#39;</span><span class="p">:</span> <span class="n">ctrl</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="s1">&#39;shift&#39;</span><span class="p">:</span> <span class="n">shift</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="s1">&#39;alt&#39;</span><span class="p">:</span> <span class="n">alt</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">k</span> <span class="o">=</span> <span class="n">keySynonyms</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
                    <span class="n">kCode</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">win32con</span><span class="p">,</span> <span class="s2">&quot;VK_</span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">k</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span><span class="kc">None</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">kCode</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="n">kCode</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;invalid key: {</span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span> <span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
            <span class="k">if</span> <span class="n">ctrl</span><span class="p">:</span>  <span class="n">sm</span><span class="p">(</span><span class="n">hndle</span><span class="p">,</span> <span class="n">kdown</span><span class="p">,</span> <span class="n">win32con</span><span class="o">.</span><span class="n">VK_CONTROL</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">shift</span><span class="p">:</span> <span class="n">sm</span><span class="p">(</span><span class="n">hndle</span><span class="p">,</span> <span class="n">kdown</span><span class="p">,</span> <span class="n">win32con</span><span class="o">.</span><span class="n">VK_SHIFT</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">alt</span><span class="p">:</span>   <span class="n">sm</span><span class="p">(</span><span class="n">hndle</span><span class="p">,</span> <span class="n">kdown</span><span class="p">,</span> <span class="n">win32con</span><span class="o">.</span><span class="n">VK_MENU</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        
            <span class="k">if</span> <span class="n">kCode</span><span class="p">:</span>
                <span class="n">sm</span><span class="p">(</span><span class="n">hndle</span><span class="p">,</span> <span class="n">kdown</span><span class="p">,</span> <span class="n">kCode</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                <span class="n">sm</span><span class="p">(</span><span class="n">hndle</span><span class="p">,</span> <span class="n">kup</span><span class="p">,</span> <span class="n">kCode</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">alt</span><span class="p">:</span>   <span class="n">sm</span><span class="p">(</span><span class="n">hndle</span><span class="p">,</span> <span class="n">kup</span><span class="p">,</span> <span class="n">win32con</span><span class="o">.</span><span class="n">VK_MENU</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">shift</span><span class="p">:</span> <span class="n">sm</span><span class="p">(</span><span class="n">hndle</span><span class="p">,</span> <span class="n">kup</span><span class="p">,</span> <span class="n">win32con</span><span class="o">.</span><span class="n">VK_SHIFT</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ctrl</span><span class="p">:</span>  <span class="n">sm</span><span class="p">(</span><span class="n">hndle</span><span class="p">,</span> <span class="n">kup</span><span class="p">,</span> <span class="n">win32con</span><span class="o">.</span><span class="n">VK_CONTROL</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">ord</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">32</span><span class="p">:</span>
                    <span class="n">sm</span><span class="p">(</span><span class="n">hndle</span><span class="p">,</span> <span class="n">char</span><span class="p">,</span> <span class="nb">ord</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># from space on</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">sm</span><span class="p">(</span><span class="n">hndle</span><span class="p">,</span> <span class="n">kdown</span><span class="p">,</span> <span class="nb">ord</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span> <span class="c1"># eg \r and \n</span>
                    <span class="n">sm</span><span class="p">(</span><span class="n">hndle</span><span class="p">,</span> <span class="n">kup</span><span class="p">,</span> <span class="nb">ord</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
                    
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;SendKey expects a string, not: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span> <span class="n">key</span><span class="p">)</span></div>

<div class="viewcode-block" id="waitForForegroundWindow"><a class="viewcode-back" href="../../messagefunctions.html#natlink.messagefunctions.waitForForegroundWindow">[docs]</a><span class="k">def</span> <span class="nf">waitForForegroundWindow</span><span class="p">(</span><span class="n">className</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nWait</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">waitingTime</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;wait some time for foreground window to get in front&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">className</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">className</span> <span class="o">=</span> <span class="p">[</span><span class="n">className</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">className</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;waitForForegroundWindow: no classname given&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>
    
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nWait</span><span class="p">):</span>
        <span class="n">hndle</span> <span class="o">=</span> <span class="n">getForegroundWindow</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">hndle</span><span class="p">:</span>
            <span class="n">currentClass</span> <span class="o">=</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">GetClassName</span><span class="p">(</span><span class="n">hndle</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">currentClass</span> <span class="ow">in</span> <span class="n">className</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">hndle</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">waitingTime</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="SendKeys"><a class="viewcode-back" href="../../messagefunctions.html#natlink.messagefunctions.SendKeys">[docs]</a><span class="k">def</span> <span class="nf">SendKeys</span><span class="p">(</span><span class="n">hndle</span><span class="p">,</span> <span class="n">keysString</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;send the keys to the window with hndle</span>
<span class="sd">    </span>
<span class="sd">    This function could be useful when you want to send keystrokes to</span>
<span class="sd">    other windows. But it fails, and should be repaired in that case.</span>
<span class="sd">    </span>
<span class="sd">    The :code:`SendMessage` trick, with windows messages, *does not work*,</span>
<span class="sd">    </span>
<span class="sd">    The :code:`SendInput` mechanism (as used in Dragonfly,</span>
<span class="sd">    and so in the `sendkeys.py` module of this module) is favourable.</span>
<span class="sd"> </span>
<span class="sd">    Example:</span>
<span class="sd">    ::</span>
<span class="sd">      hndle = getForegroundWindow()</span>
<span class="sd">      SendKeys(hndle, &quot;{shift+a}&quot;)   ## fails</span>
<span class="sd">      SendKeys(hndle, &quot;abc&quot;)         ## works</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">keysList</span> <span class="o">=</span> <span class="n">splitKeysString</span><span class="p">(</span><span class="n">keysString</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keysList</span><span class="p">:</span>
        <span class="n">sendKey</span><span class="p">(</span><span class="n">hndle</span><span class="p">,</span><span class="n">key</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="splitKeysString"><a class="viewcode-back" href="../../messagefunctions.html#natlink.messagefunctions.splitKeysString">[docs]</a><span class="k">def</span> <span class="nf">splitKeysString</span><span class="p">(</span><span class="n">keysString</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;split in single keys, either with braces around or single keystrokes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">L</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">hasBraces</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">keysString</span><span class="p">))</span>
    <span class="n">M</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">L</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">braceExact</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
            <span class="n">M</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">M</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">M</span></div>
    

<div class="viewcode-block" id="quitProgram"><a class="viewcode-back" href="../../messagefunctions.html#natlink.messagefunctions.quitProgram">[docs]</a><span class="k">def</span> <span class="nf">quitProgram</span><span class="p">(</span><span class="n">hwnd</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;send a WM_QUIT message</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#win32gui.DestroyWindow(hwnd)</span>
    <span class="n">win32gui</span><span class="o">.</span><span class="n">PostMessage</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span>
                         <span class="n">win32con</span><span class="o">.</span><span class="n">WM_DESTROY</span><span class="p">,</span>
                         <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span></div>

    <span class="c1">#_sendNotifyMessage(hwnd, win32con.WM_ACTIVATE)</span>
    <span class="c1">#oldHndle = win32gui.GetActiveWindow()</span>
    <span class="c1">#win32gui.SetActiveWindow(hwnd)</span>
    <span class="c1">#time.sleep(1)</span>
    <span class="c1">#</span>
    <span class="c1">#win32gui.PostQuitMessage(hwnd)</span>
    <span class="c1">#time.sleep(1)</span>
    <span class="c1">#win32gui.SetActiveWindow(oldHndle)</span>
    <span class="c1">#</span>

<span class="c1"># buffer and length for one stroke get window text:</span>
<span class="n">BUFFER_LENGTH</span> <span class="o">=</span> <span class="mi">1024</span>
<span class="n">TEXT_BUFFER</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="p">(</span><span class="n">BUFFER_LENGTH</span><span class="p">))</span>
<div class="viewcode-block" id="getWindowTextAll"><a class="viewcode-back" href="../../messagefunctions.html#natlink.messagefunctions.getWindowTextAll">[docs]</a><span class="k">def</span> <span class="nf">getWindowTextAll</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span> <span class="n">rawLength</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;get the buffer of a edit control in one stroke</span>
<span class="sd">    </span>
<span class="sd">    return the buffer and the raw length (uncorrected for \r\n and after text character)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># pylint: disable=W0603</span>
    <span class="k">global</span> <span class="n">TEXT_BUFFER</span><span class="p">,</span> <span class="n">BUFFER_LENGTH</span>
    <span class="k">if</span> <span class="n">rawLength</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rawLength</span> <span class="o">=</span> <span class="n">BUFFER_LENGTH</span> 
    <span class="k">if</span> <span class="n">rawLength</span> <span class="o">&gt;</span> <span class="n">BUFFER_LENGTH</span><span class="p">:</span>
        <span class="n">BUFFER_LENGTH</span> <span class="o">=</span> <span class="n">rawLength</span> <span class="o">+</span> <span class="mi">1000</span>   <span class="c1"># take a little extra!</span>
        <span class="n">TEXT_BUFFER</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="n">BUFFER_LENGTH</span><span class="p">)</span>
    <span class="n">valueLength</span> <span class="o">=</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">SendMessage</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span> <span class="n">win32con</span><span class="o">.</span><span class="n">WM_GETTEXT</span><span class="p">,</span>
                                            <span class="n">BUFFER_LENGTH</span><span class="p">,</span> <span class="n">TEXT_BUFFER</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">valueLength</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">0</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="n">BUFFER_LENGTH</span> <span class="o">-</span> <span class="n">valueLength</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">10</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;probably too small buffer for this control: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span> <span class="n">valueLength</span><span class="p">)</span>
        <span class="n">rawLength</span> <span class="o">=</span> <span class="n">getRawTextLength</span><span class="p">(</span><span class="n">hwnd</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1000</span>
        <span class="k">return</span> <span class="n">getWindowTextAll</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span> <span class="n">rawLength</span><span class="o">=</span><span class="n">rawLength</span><span class="p">)</span>
        
    <span class="n">result</span> <span class="o">=</span> <span class="n">TEXT_BUFFER</span><span class="o">.</span><span class="n">tostring</span><span class="p">()[:</span><span class="n">valueLength</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">result</span><span class="p">,</span> <span class="n">valueLength</span></div>

<span class="k">def</span> <span class="nf">_getMultipleWindowValues</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span> <span class="n">getCountMessage</span><span class="p">,</span> <span class="n">getValueMessage</span><span class="p">,</span> <span class="n">first</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    </span>
<span class="sd">    A common pattern in the Win32 API is that in order to retrieve a</span>
<span class="sd">    series of values, you use one message to get a count of available</span>
<span class="sd">    items, and another to retrieve them. This internal utility function</span>
<span class="sd">    performs the common processing for this pattern.</span>

<span class="sd">    Arguments:</span>
<span class="sd">    hwnd                Window handle for the window for which items should be</span>
<span class="sd">                        retrieved.</span>
<span class="sd">    getCountMessage     Item count message.</span>
<span class="sd">    getValueMessage     Value retrieval message.</span>

<span class="sd">    Returns:            Retrieved items.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="n">MAX_VALUE_LENGTH</span> <span class="o">=</span> <span class="mi">256</span>
    <span class="n">bufferlength</span>  <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="n">MAX_VALUE_LENGTH</span><span class="p">)</span> <span class="c1"># This is a C style int.</span>
    <span class="n">valuecount</span> <span class="o">=</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">SendMessage</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span> <span class="n">getCountMessage</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">itemIndex</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">valuecount</span><span class="p">):</span>
        <span class="n">valuebuffer</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span>
                                  <span class="n">bufferlength</span> <span class="o">+</span>
                                  <span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="p">(</span><span class="n">MAX_VALUE_LENGTH</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">bufferlength</span><span class="p">)))</span>
        <span class="n">valueLength</span> <span class="o">=</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">SendMessage</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span>
                                           <span class="n">getValueMessage</span><span class="p">,</span>
                                           <span class="n">itemIndex</span><span class="p">,</span>
                                           <span class="n">valuebuffer</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">valuebuffer</span><span class="o">.</span><span class="n">tostring</span><span class="p">()[:</span><span class="n">valueLength</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">result</span>

<span class="k">def</span> <span class="nf">_windowEnumerationHandler</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span> <span class="n">resultList</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;win32gui.EnumWindows() callback.</span>
<span class="sd">    </span>
<span class="sd">    Pass to win32gui.EnumWindows() or win32gui.EnumChildWindows() to</span>
<span class="sd">    generate a list of window handle, window text, window class tuples.</span>
<span class="sd">    stop enumeration, if checkI(mmediate) is set and contents match </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">hwnd</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;_windowEnumerationHandler, hwnd == 0, skip&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="c1"># try:</span>
    <span class="n">_testHndle</span> <span class="o">=</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">GetWindow</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="c1"># except pywintypes.error:</span>
    <span class="c1">#     if details[0] == 1400:</span>
    <span class="c1">#         print(f&#39;caught 1400 error, skip this window: {hwnd}&#39;% hwnd)</span>
    <span class="c1">#         return None</span>
    <span class="c1">#     raise</span>
    <span class="k">if</span> <span class="n">checkI</span><span class="p">:</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">className</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">wText</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">GetWindowText</span><span class="p">(</span><span class="n">hwnd</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">wText</span> <span class="ow">and</span> <span class="n">_normaliseText</span><span class="p">(</span><span class="n">text</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">wText</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span>
        <span class="k">if</span> <span class="n">wClass</span><span class="p">:</span>
            <span class="n">className</span> <span class="o">=</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">GetClassName</span><span class="p">(</span><span class="n">hwnd</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">wClass</span> <span class="ow">and</span> <span class="n">className</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">wClass</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">wText</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">GetWindowText</span><span class="p">(</span><span class="n">hwnd</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">wClass</span><span class="p">:</span>
            <span class="n">className</span> <span class="o">=</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">GetClassName</span><span class="p">(</span><span class="n">hwnd</span><span class="p">)</span>
        <span class="c1"># got it, append and stop:</span>
        <span class="n">resultList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>  <span class="p">(</span><span class="n">hwnd</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">className</span><span class="p">)</span> <span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="c1"># pass on window title and class name:</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">GetWindowText</span><span class="p">(</span><span class="n">hwnd</span><span class="p">)</span>
    <span class="n">className</span> <span class="o">=</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">GetClassName</span><span class="p">(</span><span class="n">hwnd</span><span class="p">)</span>
    <span class="c1">#visible = win32gui.SendMessage(hwnd, 2491)</span>
    <span class="n">resultList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>  <span class="p">(</span><span class="n">hwnd</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">className</span><span class="p">)</span> <span class="p">)</span>   
    <span class="k">return</span> <span class="kc">None</span>
    
<span class="k">def</span> <span class="nf">_buildWinLong</span><span class="p">(</span><span class="n">high</span><span class="p">,</span> <span class="n">low</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Build a windows long parameter from high and low words.</span>
<span class="sd">    </span>
<span class="sd">    See http://support.microsoft.com/support/kb/articles/q189/1/70.asp</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># return ((high &lt;&lt; 16) | low)</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&gt;L&#39;</span><span class="p">,</span>
                             <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;&gt;2H&#39;</span><span class="p">,</span>
                                         <span class="n">high</span><span class="p">,</span>
                                         <span class="n">low</span><span class="p">))</span> <span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        
<span class="k">def</span> <span class="nf">_sendNotifyMessage</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span> <span class="n">notifyMessage</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Send a notify message to a control.&#39;&#39;&#39;</span>
    <span class="n">win32gui</span><span class="o">.</span><span class="n">SendMessage</span><span class="p">(</span><span class="n">win32gui</span><span class="o">.</span><span class="n">GetParent</span><span class="p">(</span><span class="n">hwnd</span><span class="p">),</span>
                         <span class="n">win32con</span><span class="o">.</span><span class="n">WM_COMMAND</span><span class="p">,</span>
                         <span class="n">_buildWinLong</span><span class="p">(</span><span class="n">notifyMessage</span><span class="p">,</span>
                                       <span class="n">win32api</span><span class="o">.</span><span class="n">GetWindowLong</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span>
                                                              <span class="n">win32con</span><span class="o">.</span><span class="n">GWL_ID</span><span class="p">)),</span>
                         <span class="n">hwnd</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">_normaliseText</span><span class="p">(</span><span class="n">controlText</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Remove &#39;&amp;&#39; characters, but keep the case</span>
<span class="sd">    </span>
<span class="sd">    leave None or &#39;&#39; unchanged</span>
<span class="sd">    </span>
<span class="sd">    Useful for matching control text.&#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">controlText</span> <span class="ow">and</span> <span class="n">controlText</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;&amp;&quot;</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">controlText</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&amp;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">controlText</span>

<span class="k">def</span> <span class="nf">_findNamedSubmenu</span><span class="p">(</span><span class="n">hMenu</span><span class="p">,</span> <span class="n">hMenuItemCount</span><span class="p">,</span> <span class="n">submenuName</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Find the index number of a menu&#39;s submenu with a specific name.&#39;&#39;&#39;</span>
    <span class="k">for</span> <span class="n">submenuIndex</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">hMenuItemCount</span><span class="p">):</span>
        <span class="n">submenuInfo</span> <span class="o">=</span> <span class="n">_getMenuInfo</span><span class="p">(</span><span class="n">hMenu</span><span class="p">,</span> <span class="n">submenuIndex</span><span class="p">)</span>
        <span class="c1"># submenuInfoName = submenuInfo.name</span>
        <span class="k">if</span> <span class="n">_normaliseText</span><span class="p">(</span><span class="n">submenuInfo</span><span class="o">.</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">_normaliseText</span><span class="p">(</span><span class="n">submenuName</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">submenuIndex</span><span class="p">,</span> <span class="n">submenuInfo</span><span class="o">.</span><span class="n">submenu</span><span class="p">,</span> <span class="n">submenuInfo</span><span class="o">.</span><span class="n">itemCount</span>
    <span class="k">raise</span> <span class="n">WinGuiAutoError</span><span class="p">(</span><span class="s2">&quot;No submenu found for hMenu=&quot;</span> <span class="o">+</span>
                          <span class="nb">repr</span><span class="p">(</span><span class="n">hMenu</span><span class="p">)</span> <span class="o">+</span>
                          <span class="s2">&quot;, hMenuItemCount=&quot;</span> <span class="o">+</span>
                          <span class="nb">repr</span><span class="p">(</span><span class="n">hMenuItemCount</span><span class="p">)</span> <span class="o">+</span>
                          <span class="s2">&quot;, submenuName=&quot;</span> <span class="o">+</span>
                          <span class="nb">repr</span><span class="p">(</span><span class="n">submenuName</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">_dedup</span><span class="p">(</span><span class="n">thelist</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;De-duplicate deeply nested list.&#39;&#39;&#39;</span>
    <span class="n">found</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">def</span> <span class="nf">dodedup</span><span class="p">(</span><span class="n">thelist</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">thing</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">thelist</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">thing</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">dodedup</span><span class="p">(</span><span class="n">thing</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">thing</span> <span class="ow">in</span> <span class="n">found</span><span class="p">:</span>
                    <span class="k">del</span> <span class="n">thelist</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">found</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thing</span><span class="p">)</span>
                
                              
<span class="k">class</span> <span class="nc">Bunch</span><span class="p">:</span>
    <span class="c1"># pylint: disable=R0903</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwds</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">state</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">=</span><span class="si">%r</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                 <span class="k">for</span> <span class="p">(</span><span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                 <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
    
<div class="viewcode-block" id="WinGuiAutoError"><a class="viewcode-back" href="../../messagefunctions.html#natlink.messagefunctions.WinGuiAutoError">[docs]</a><span class="k">class</span> <span class="nc">WinGuiAutoError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="k">pass</span></div>

<span class="k">def</span> <span class="nf">self_test</span><span class="p">():</span>
    <span class="c1">#print(&quot;Let&#39;s see what top windows we have at the &#39;mo:&quot;)</span>
    <span class="c1">#pprint.pprint(dumpTopWindows())</span>
    <span class="c1">#x = input(&#39;-&gt;&#39;)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Open and locate Notepad&quot;</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">startfile</span><span class="p">(</span><span class="s1">&#39;notepad&#39;</span><span class="p">)</span>
    <span class="n">notepadWindow</span> <span class="o">=</span> <span class="n">findTopWindow</span><span class="p">(</span><span class="n">wantedClass</span><span class="o">=</span><span class="s1">&#39;Notepad&#39;</span><span class="p">)</span>
    <span class="n">_x</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s1">&#39;-&gt;&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Locate the &#39;find&#39; edit box&quot;</span><span class="p">)</span>
    <span class="n">findValue</span> <span class="o">=</span> <span class="n">findControls</span><span class="p">(</span><span class="n">notepadWindow</span><span class="p">,</span> <span class="n">wantedClass</span><span class="o">=</span><span class="s2">&quot;Edit&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">_x</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s1">&#39;-&gt;&#39;</span><span class="p">)</span>                               
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Enter some text - and wait long enough for it to be seen&quot;</span><span class="p">)</span>
    <span class="n">setEditText</span><span class="p">(</span><span class="n">findValue</span><span class="p">,</span> <span class="s2">&quot;Hello, mate!&quot;</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="o">.</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">_x</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s1">&#39;-&gt;&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Locate notepad&#39;s edit area, and enter various bits of text.&quot;</span><span class="p">)</span>
    <span class="n">editArea</span> <span class="o">=</span> <span class="n">findControl</span><span class="p">(</span><span class="n">notepadWindow</span><span class="p">,</span><span class="n">wantedClass</span><span class="o">=</span><span class="s2">&quot;Edit&quot;</span><span class="p">)</span>
    <span class="n">setEditText</span><span class="p">(</span><span class="n">editArea</span><span class="p">,</span> <span class="s2">&quot;Hello, again!&quot;</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="o">.</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">setEditText</span><span class="p">(</span><span class="n">editArea</span><span class="p">,</span> <span class="s2">&quot;You still there?&quot;</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="o">.</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">setEditText</span><span class="p">(</span><span class="n">editArea</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;Here come&quot;</span><span class="p">,</span> <span class="s2">&quot;two lines!&quot;</span><span class="p">])</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="o">.</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">_x</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s1">&#39;-&gt;&#39;</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Add some...&quot;</span><span class="p">)</span>
    <span class="n">setEditText</span><span class="p">(</span><span class="n">editArea</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;And a 3rd one!&quot;</span><span class="p">],</span> <span class="n">append</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="o">.</span><span class="mi">5</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;See what&#39;s there now:&quot;</span><span class="p">)</span>
    <span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">getEditText</span><span class="p">(</span><span class="n">editArea</span><span class="p">))</span>
    <span class="n">_x</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s1">&#39;-&gt;&#39;</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Exit notepad&quot;</span><span class="p">)</span>
    <span class="n">activateMenuItem</span><span class="p">(</span><span class="n">notepadWindow</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;bestand&#39;</span><span class="p">,</span> <span class="s1">&#39;afsluiten&#39;</span><span class="p">))</span>  <span class="c1"># was &#39;file&#39;, &#39;exit&#39;</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="o">.</span><span class="mi">5</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Don&#39;t save.&quot;</span><span class="p">)</span>
    <span class="n">saveDialog</span> <span class="o">=</span> <span class="n">findTopWindow</span><span class="p">(</span><span class="n">selectionFunction</span><span class="o">=</span><span class="k">lambda</span> <span class="n">hwnd</span><span class="p">:</span>
                                                 <span class="n">win32gui</span><span class="o">.</span><span class="n">GetWindowText</span><span class="p">(</span><span class="n">hwnd</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;Notepad&#39;</span><span class="p">)</span>
    <span class="n">noButton</span> <span class="o">=</span> <span class="n">findControl</span><span class="p">(</span><span class="n">saveDialog</span><span class="p">,</span><span class="n">wantedClass</span><span class="o">=</span><span class="s2">&quot;Button&quot;</span><span class="p">,</span> <span class="n">wantedText</span><span class="o">=</span><span class="s2">&quot;nee&quot;</span><span class="p">)</span>  <span class="c1"># was &#39;no&#39;</span>
    <span class="n">clickButton</span><span class="p">(</span><span class="n">noButton</span><span class="p">)</span>
    <span class="n">_x</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s1">&#39;-&gt;&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">test_with_dragonpad1</span><span class="p">(</span><span class="n">setText</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">dragonpadWindow</span> <span class="o">=</span> <span class="n">findTopWindow</span><span class="p">(</span><span class="n">wantedClass</span><span class="o">=</span><span class="s1">&#39;TalkpadClass&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;dragonpadWindow: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span> <span class="n">dragonpadWindow</span><span class="p">)</span>
    <span class="n">findValues</span> <span class="o">=</span> <span class="n">findControls</span><span class="p">(</span><span class="n">dragonpadWindow</span><span class="p">,</span> <span class="n">wantedClass</span><span class="o">=</span><span class="s2">&quot;RichEdit20A&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">findValues</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="n">findValue</span> <span class="o">=</span> <span class="n">findValues</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;findValue: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span> <span class="n">findValue</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">setText</span><span class="p">:</span>
        <span class="n">setEditText</span><span class="p">(</span><span class="n">findValue</span><span class="p">,</span> <span class="s2">&quot;Hello, mate!&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">findValue</span>

<span class="k">def</span> <span class="nf">test_with_notepad1</span><span class="p">(</span><span class="n">setText</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">notepadWindow</span> <span class="o">=</span> <span class="n">findTopWindow</span><span class="p">(</span><span class="n">wantedClass</span><span class="o">=</span><span class="s1">&#39;Notepad&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;notepadWindow: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span> <span class="n">notepadWindow</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">notepadWindow</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="n">findValue</span> <span class="o">=</span> <span class="n">findControls</span><span class="p">(</span><span class="n">notepadWindow</span><span class="p">,</span> <span class="n">wantedClass</span><span class="o">=</span><span class="s2">&quot;Edit&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;findValue: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span> <span class="n">findValue</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">setText</span><span class="p">:</span>
        <span class="n">setEditText</span><span class="p">(</span><span class="n">findValue</span><span class="p">,</span> <span class="s2">&quot;Hello, mate!&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">findValue</span>
    <span class="c1"># do &quot;switch to notepad&quot; and dictate &quot;this is a test&quot;</span>
    <span class="c1"># result:</span>
    <span class="c1"># Hello, mate! Hello, this is another test</span>

<span class="k">def</span> <span class="nf">test_with_wordpad1</span><span class="p">():</span>
    <span class="n">wordpadWindow</span> <span class="o">=</span> <span class="n">findTopWindow</span><span class="p">(</span><span class="n">wantedClass</span><span class="o">=</span><span class="s1">&#39;WordPadClass&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;wordpadWindow: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span> <span class="n">wordpadWindow</span><span class="p">)</span>
    <span class="n">findValue</span> <span class="o">=</span> <span class="n">findControls</span><span class="p">(</span><span class="n">wordpadWindow</span><span class="p">,</span> <span class="n">wantedClass</span><span class="o">=</span><span class="s2">&quot;RICHEDIT50W&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;findValue: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span> <span class="n">findValue</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">findValue</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">setText</span><span class="p">:</span>
        <span class="n">setEditText</span><span class="p">(</span><span class="n">findValue</span><span class="p">,</span> <span class="s2">&quot;Hello, mate!&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">findValue</span>
    <span class="c1"># do &quot;switch to wordpad&quot; and dictate &quot;this is a test&quot;</span>
    <span class="c1"># result:</span>
    <span class="c1"># Hello, mate! Hello, this is a test</span>

<span class="k">def</span> <span class="nf">test_with_excel</span><span class="p">():</span>
    <span class="n">excelWindows</span> <span class="o">=</span> <span class="n">findTopWindows</span><span class="p">(</span><span class="n">wantedClass</span><span class="o">=</span><span class="s1">&#39;XLMAIN&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">xl</span> <span class="ow">in</span> <span class="n">excelWindows</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;xl: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span> <span class="n">xl</span><span class="p">)</span>
        <span class="n">contents</span> <span class="o">=</span> <span class="n">dumpWindow</span><span class="p">(</span><span class="n">xl</span><span class="p">)</span>
        <span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">contents</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">excelWindows</span>

<div class="viewcode-block" id="test_with_pythonwin"><a class="viewcode-back" href="../../messagefunctions.html#natlink.messagefunctions.test_with_pythonwin">[docs]</a><span class="k">def</span> <span class="nf">test_with_pythonwin</span><span class="p">(</span><span class="n">topHwnd</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;pass top handle, use selection function from windowsparameter.py</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">windowparameters</span>
    <span class="n">selFunc</span> <span class="o">=</span> <span class="n">windowparameters</span><span class="o">.</span><span class="n">getPythonwinEditControl</span>
    <span class="n">controls</span> <span class="o">=</span> <span class="n">findControls</span><span class="p">(</span><span class="n">topHwnd</span><span class="p">,</span> <span class="n">selectionFunction</span><span class="o">=</span><span class="n">selFunc</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;controls pythonwin: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span> <span class="n">controls</span><span class="p">)</span>

    <span class="n">contents</span> <span class="o">=</span> <span class="n">dumpWindow</span><span class="p">(</span><span class="n">topHwnd</span><span class="p">)</span>
    <span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">contents</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">controls</span></div>

<div class="viewcode-block" id="test_with_komodo_messages"><a class="viewcode-back" href="../../messagefunctions.html#natlink.messagefunctions.test_with_komodo_messages">[docs]</a><span class="k">def</span> <span class="nf">test_with_komodo_messages</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;also TCP model could be set up, this is the try via scintilla window and messages</span>
<span class="sd">    </span>
<span class="sd">    discussion on: http://community.activestate.com/node/10359</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">komodoWindows</span> <span class="o">=</span> <span class="n">findTopWindows</span><span class="p">(</span><span class="n">wantedClass</span><span class="o">=</span><span class="s1">&#39;MozillaWindowClass&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ko</span> <span class="ow">in</span> <span class="n">komodoWindows</span><span class="p">:</span>
        <span class="n">contents</span> <span class="o">=</span> <span class="n">dumpWindow</span><span class="p">(</span><span class="n">ko</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">contents</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ko: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span> <span class="n">ko</span><span class="p">)</span>
            <span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">contents</span><span class="p">)</span></div>
        
    <span class="c1"># do &quot;switch to wordpad&quot; and dictate &quot;this is a test&quot;</span>
    <span class="c1"># result:</span>
    <span class="c1"># Hello, mate! Hello, this is a test</span>

<div class="viewcode-block" id="doHotshotTest"><a class="viewcode-back" href="../../messagefunctions.html#natlink.messagefunctions.doHotshotTest">[docs]</a><span class="k">def</span> <span class="nf">doHotshotTest</span><span class="p">(</span><span class="n">editControl</span><span class="p">,</span> <span class="n">nTests</span><span class="o">=</span><span class="mi">6</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;do some testing on control.</span>
<span class="sd">    </span>
<span class="sd">    With each higher value of nTests the amount of text is doubled (in the last set/get calls)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">hotshot</span><span class="o">,</span> <span class="nn">hotshot.stats</span>
    <span class="n">filePath</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;D:\messagesfunctions.prof&#39;</span>
    <span class="n">prof</span> <span class="o">=</span> <span class="n">hotshot</span><span class="o">.</span><span class="n">Profile</span><span class="p">(</span><span class="n">filePath</span><span class="p">)</span>
    <span class="n">prof</span><span class="o">.</span><span class="n">runcall</span><span class="p">(</span><span class="n">hotshot_test</span><span class="p">,</span> <span class="n">editControl</span><span class="p">,</span> <span class="n">nTests</span><span class="p">)</span>
    <span class="n">prof</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">stats</span> <span class="o">=</span> <span class="n">hotshot</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">filePath</span><span class="p">)</span>
    <span class="n">stats</span><span class="o">.</span><span class="n">strip_dirs</span><span class="p">()</span>
    <span class="n">stats</span><span class="o">.</span><span class="n">sort_stats</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;calls&#39;</span><span class="p">)</span>
    <span class="n">stats</span><span class="o">.</span><span class="n">print_stats</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span></div>

<div class="viewcode-block" id="doHotshotTestField"><a class="viewcode-back" href="../../messagefunctions.html#natlink.messagefunctions.doHotshotTestField">[docs]</a><span class="k">def</span> <span class="nf">doHotshotTestField</span><span class="p">(</span><span class="n">editControl</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;do some testing on control.</span>
<span class="sd">    </span>
<span class="sd">    With each higher value of nTests the amount of text is doubled (in the last set/get calls)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">hotshot</span><span class="o">,</span> <span class="nn">hotshot.stats</span>
    <span class="n">filePath</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;D:\messagesfunctions.prof&#39;</span>
    <span class="n">prof</span> <span class="o">=</span> <span class="n">hotshot</span><span class="o">.</span><span class="n">Profile</span><span class="p">(</span><span class="n">filePath</span><span class="p">)</span>
    <span class="n">prof</span><span class="o">.</span><span class="n">runcall</span><span class="p">(</span><span class="n">hotshot_test_selection</span><span class="p">,</span> <span class="n">editControl</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">23</span><span class="p">)</span>
    <span class="n">prof</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">stats</span> <span class="o">=</span> <span class="n">hotshot</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">filePath</span><span class="p">)</span>
    <span class="n">stats</span><span class="o">.</span><span class="n">strip_dirs</span><span class="p">()</span>
    <span class="n">stats</span><span class="o">.</span><span class="n">sort_stats</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;calls&#39;</span><span class="p">)</span>
    <span class="n">stats</span><span class="o">.</span><span class="n">print_stats</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span></div>

<div class="viewcode-block" id="hotshot_test_selection"><a class="viewcode-back" href="../../messagefunctions.html#natlink.messagefunctions.hotshot_test_selection">[docs]</a><span class="k">def</span> <span class="nf">hotshot_test_selection</span><span class="p">(</span><span class="n">editArea</span><span class="p">,</span> <span class="n">selStart</span><span class="p">,</span> <span class="n">selEnd</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;do some actions in hotshot profile mode, when a field is selected</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">setSelection</span><span class="p">(</span><span class="n">editArea</span><span class="p">,</span> <span class="n">selStart</span><span class="p">,</span> <span class="n">selEnd</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">_t</span> <span class="o">=</span> <span class="n">getEditText</span><span class="p">(</span><span class="n">editArea</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;selection at: </span><span class="si">%s</span><span class="s1">, </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span> <span class="p">(</span><span class="n">selStart</span><span class="p">,</span> <span class="n">selEnd</span><span class="p">))</span></div>

<div class="viewcode-block" id="doHotshotTestOutsideField"><a class="viewcode-back" href="../../messagefunctions.html#natlink.messagefunctions.doHotshotTestOutsideField">[docs]</a><span class="k">def</span> <span class="nf">doHotshotTestOutsideField</span><span class="p">(</span><span class="n">editControl</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;do some testing on control.</span>
<span class="sd">    </span>
<span class="sd">    With each higher value of nTests the amount of text is doubled (in the last set/get calls)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">hotshot</span><span class="o">,</span> <span class="nn">hotshot.stats</span>
    <span class="n">filePath</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;D:\messagesfunctionsoutside.prof&#39;</span>
    <span class="n">prof</span> <span class="o">=</span> <span class="n">hotshot</span><span class="o">.</span><span class="n">Profile</span><span class="p">(</span><span class="n">filePath</span><span class="p">)</span>
    <span class="n">prof</span><span class="o">.</span><span class="n">runcall</span><span class="p">(</span><span class="n">hotshot_test_selection</span><span class="p">,</span> <span class="n">editControl</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
    <span class="n">prof</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">stats</span> <span class="o">=</span> <span class="n">hotshot</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">filePath</span><span class="p">)</span>
    <span class="n">stats</span><span class="o">.</span><span class="n">strip_dirs</span><span class="p">()</span>
    <span class="n">stats</span><span class="o">.</span><span class="n">sort_stats</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;calls&#39;</span><span class="p">)</span>
    <span class="n">stats</span><span class="o">.</span><span class="n">print_stats</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="hotshot_test"><a class="viewcode-back" href="../../messagefunctions.html#natlink.messagefunctions.hotshot_test">[docs]</a><span class="k">def</span> <span class="nf">hotshot_test</span><span class="p">(</span><span class="n">editArea</span><span class="p">,</span> <span class="n">nTests</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;do some actions in hotshot profile mode</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">setEditText</span><span class="p">(</span><span class="n">editArea</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">setEditText</span><span class="p">(</span><span class="n">editArea</span><span class="p">,</span> <span class="s2">&quot;Hello, again!&quot;</span><span class="p">)</span>
    <span class="n">setEditText</span><span class="p">(</span><span class="n">editArea</span><span class="p">,</span> <span class="s2">&quot;You still there?&quot;</span><span class="p">)</span>
    <span class="c1">#setEditText(editArea, [&quot;Here come&quot;, &quot;two lines! The second one is not too short!&quot;])</span>
    <span class="c1">#setEditText(editArea, [&quot;&quot;, &quot;And a 3rd one! This one is considerable longer, because there must be something to test. I hope this testing gives some reliable result.&quot;, &quot;&quot;], append=True)</span>
    <span class="n">setEditText</span><span class="p">(</span><span class="n">editArea</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;Here come&quot;</span><span class="p">,</span> <span class="s2">&quot;two lines! The second one is not too short!&quot;</span><span class="p">])</span>
    <span class="n">setEditText</span><span class="p">(</span><span class="n">editArea</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;And a 3rd one! This one is considerable longer, because there must be something to test. I hope this testing gives some reliable result.&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">],</span> <span class="n">append</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


    <span class="k">for</span> <span class="n">_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nTests</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">getEditText</span><span class="p">(</span><span class="n">editArea</span><span class="p">)</span>
        <span class="n">setEditText</span><span class="p">(</span><span class="n">editArea</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">append</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">getEditText</span><span class="p">(</span><span class="n">editArea</span><span class="p">)</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
    <span class="n">lenresult</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;***number of tests: </span><span class="si">%s</span><span class="s1">, lines: </span><span class="si">%s</span><span class="s1">, characters: </span><span class="si">%s</span><span class="s1">  ***&#39;</span><span class="o">%</span> <span class="p">(</span><span class="n">nTests</span><span class="p">,</span> <span class="n">lines</span><span class="p">,</span> <span class="n">lenresult</span><span class="p">))</span></div>

<div class="viewcode-block" id="findPythonwinControl"><a class="viewcode-back" href="../../messagefunctions.html#natlink.messagefunctions.findPythonwinControl">[docs]</a><span class="k">def</span> <span class="nf">findPythonwinControl</span><span class="p">(</span><span class="n">topHwnd</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;pass the top handle&quot;&quot;&quot;</span>
    <span class="n">windowTitle</span> <span class="o">=</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">GetWindowText</span><span class="p">(</span><span class="n">topHwnd</span><span class="p">)</span>
    <span class="n">wantedText</span> <span class="o">=</span> <span class="n">windowTitle</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">controls1</span> <span class="o">=</span> <span class="n">findControls</span><span class="p">(</span><span class="n">topHwnd</span><span class="p">,</span><span class="n">wantedText</span><span class="o">=</span><span class="n">wantedText</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">controls1</span><span class="p">:</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">findAdditionalControls</span><span class="p">(</span><span class="n">controls1</span><span class="p">,</span> <span class="n">wantedClass</span><span class="o">=</span><span class="s2">&quot;Scintilla&quot;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;pythonwin: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span> <span class="n">result</span><span class="p">)</span></div>
    


<span class="k">def</span> <span class="nf">findDragonBar</span><span class="p">():</span>
    <span class="n">db</span> <span class="o">=</span> <span class="n">findTopWindow</span><span class="p">(</span><span class="n">wantedClass</span><span class="o">=</span><span class="s1">&#39;DgnBarMainWindowCls&#39;</span><span class="p">)</span>
    
<span class="k">def</span> <span class="nf">testExplorerViews</span><span class="p">(</span><span class="n">hndle</span><span class="p">):</span>
    <span class="c1"># PostMessage, 0x111, 28713,0,, ahk_pid %Win_pid% medium icons, AHK</span>
    <span class="c1"># PostMessage = ctypes.windll.user32.PostMessageA</span>
    <span class="n">win32gui</span><span class="o">.</span><span class="n">PostMessage</span><span class="p">(</span><span class="n">hndle</span><span class="p">,</span> <span class="mi">28713</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">win32gui</span><span class="o">.</span><span class="n">PostMessage</span><span class="p">(</span><span class="n">hndle</span><span class="p">,</span> <span class="mi">28716</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    
        
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="c1">#findDragonBar()</span>
    
    <span class="c1">#self_test()</span>
    <span class="c1">#editArea = test_with_aligen1(setText=0)</span>
    <span class="c1">#editArea = test_with_dragonpad1(setText=0)</span>
    <span class="c1">#editArea = test_with_notepad1()</span>
    <span class="c1">#editArea = test_with_wordpad1()</span>
    <span class="c1">#if not editArea:</span>
    <span class="c1">#    print(&#39;did not find the correct control, ensure your application is on!!&#39;</span>
    <span class="c1">#else:</span>
    <span class="c1">#    #doHotshotTest(editArea, 6)</span>
    <span class="c1">#    doHotshotTestField(editArea)</span>
    <span class="c1">#    doHotshotTestOutsideField(editArea)</span>
    
    <span class="c1">#getFolderFromCabinetWClass(1180166)</span>
    <span class="c1">#test_with_excel()</span>
    <span class="c1">#test_with_komodo_messages()</span>
    <span class="c1">#findPythonwinControl(133488)  # uses selectionFunction getPythonwinEditControl</span>
    <span class="c1">#test_with_pythonwin(133488)</span>
    <span class="c1">#pprint.pprint(dumpXplorer2())</span>
    
    <span class="c1"># view settings explorer (this one fails!)</span>
    <span class="c1"># testExplorerViews(986418)</span>
    <span class="c1"># g = getFolderFromCabinetWClass(1837622)</span>
    <span class="c1"># g = getFolderFromDialog(394720, &#39;#32770&#39;)</span>
    <span class="c1"># print(g, type(g))</span>
    <span class="c1"># hndle = getForegroundWindow()</span>
    <span class="c1"># SendKeys(hndle, &quot;{shift+a}&quot;)   ## fails</span>
    <span class="c1"># SendKeys(hndle, &quot;abc&quot;)         ## works</span>
    <span class="k">pass</span>
</pre></div>

           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Quintijn Hoogenboom.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>