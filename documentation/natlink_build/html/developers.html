<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Developers instructions &mdash; natlink 5.1.1 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Modules" href="modules.html" />
    <link rel="prev" title="Configure Natlink" href="configure.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> natlink
          </a>
              <div class="version">
                5.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Install instructions for Natlink</a></li>
<li class="toctree-l1"><a class="reference internal" href="configure.html">Configure Natlink</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Developers instructions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#setup-visual-studio-code-environment">Setup Visual Studio Code environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="#further-instructions">Further instructions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#invalid-options-visual-studio">Invalid options Visual Studio</a></li>
<li class="toctree-l2"><a class="reference internal" href="#fix">Fix</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="project.html">Project</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">natlink</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Developers instructions</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/developers.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="developers-instructions">
<h1>Developers instructions<a class="headerlink" href="#developers-instructions" title="Permalink to this headline"></a></h1>
<p>When you want to contribute to the Natlink development, you will need to compile the C++ code and compile the inno setup program. Try the instructions below.</p>
<section id="setup-visual-studio-code-environment">
<h2>Setup Visual Studio Code environment<a class="headerlink" href="#setup-visual-studio-code-environment" title="Permalink to this headline"></a></h2>
<ol class="arabic simple">
<li><p>Install <a class="reference external" href="https://visualstudio.microsoft.com/">Visual Studio</a>
(Community Edition 2019 or above) with <code class="docutils literal notranslate"><span class="pre">C++</span> <span class="pre">Desktop</span> <span class="pre">Development</span></code>
and <code class="docutils literal notranslate"><span class="pre">Microsoft</span> <span class="pre">Visual</span> <span class="pre">C++</span> <span class="pre">Redistributable</span></code>.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.microsoft.com/en-us/cpp/ide/using-the-visual-studio-ide-for-cpp-desktop-development">C++ Desktop
Development</a>
This contains the necessary compilers for <strong>(Visual Studio</strong> and
<strong>Visual Studio Code)</strong></p></li>
<li><p><a class="reference external" href="https://docs.microsoft.com/en-US/cpp/windows/latest-supported-vc-redist?view=msvc-170">Microsoft Visual C++ Redistributable 2015, 2017, 2019, and
2022</a>
(32-bit/X86 required)</p></li>
</ul>
</li>
<li><p>Install <a class="reference external" href="https://visualstudio.microsoft.com/">Visual Studio Code</a>
with the following Extensions</p>
<ul class="simple">
<li><p><a class="reference external" href="https://marketplace.visualstudio.com/items?itemName=ms-vscode.cpptools">C/C++</a></p></li>
<li><p><a class="reference external" href="https://marketplace.visualstudio.com/items?itemName=twxs.cmake">CMake</a></p></li>
</ul>
</li>
<li><p>Install <a class="reference external" href="https://jrsoftware.org/isdl.php">Inno</a> version 6.x.</p></li>
<li><p>Install <a class="reference external" href="https://www.python.org/downloads/">Python</a> version 3.8.x,
3.9.x, or 3.10.x 32-bit/X86 (Does not need to be on path)</p></li>
<li><p>After cloning Nalink open the project up in Visual Studio Code</p>
<ul class="simple">
<li><p>Set the Python Version <code class="docutils literal notranslate"><span class="pre">PYTHON_VERSION</span> <span class="pre">3.10</span></code> in
<a class="reference external" href="https://github.com/dictation-toolbox/natlink/blob/23b40fe23c0cb75c935cae6bc6800fa9cda748d9/CMakeLists.txt#L5">CMakeLists.txt</a>
(The CMakeLists.txt in top directory of the project)</p>
<ul>
<li><p>example for Python 3.8.x
<code class="docutils literal notranslate"><span class="pre">set(PYTHON_VERSION</span> <span class="pre">3.8</span> <span class="pre">CACHE</span> <span class="pre">STRING</span> <span class="pre">&quot;3.X</span> <span class="pre">for</span> <span class="pre">X</span> <span class="pre">&gt;=</span> <span class="pre">8&quot;)</span></code></p></li>
</ul>
</li>
<li><p>Selective equivalent to
<code class="docutils literal notranslate"><span class="pre">Visual</span> <span class="pre">Studio</span> <span class="pre">Community</span> <span class="pre">2022</span> <span class="pre">Release</span> <span class="pre">-</span> <span class="pre">x86</span></code> (32-bit/X86
required) to configure the compiler.</p>
<ul>
<li><p><img alt="image" src="https://user-images.githubusercontent.com/24551569/164919729-bd4b2096-6af3-4307-ba3c-ef6ff3b98c41.png" /></p></li>
</ul>
</li>
</ul>
</li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">build</span></code> directory will generate containing the configuration
selected and build artifacts (compiled code and installer)</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">build</span></code> directory can be safely deleted if you need to
reconfigure the project as it will just regenerate.</p></li>
</ul>
</li>
<li><p>Click the “build” button at the bottom of the editor to to build the
project and create the installer.</p>
<ul class="simple">
<li><p><img alt="image" src="https://user-images.githubusercontent.com/24551569/164919729-bd4b2096-6af3-4307-ba3c-ef6ff3b98c41.png" /></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">build</span></code> directory Installer location
<code class="docutils literal notranslate"><span class="pre">{project</span> <span class="pre">source</span> <span class="pre">directory}\build\InstallerSource\natlink5.1-py3.10-32-setup.exe</span></code></p></li>
</ul>
</li>
</ol>
</section>
<section id="further-instructions">
<h2>Further instructions<a class="headerlink" href="#further-instructions" title="Permalink to this headline"></a></h2>
</section>
<section id="invalid-options-visual-studio">
<h2>Invalid options Visual Studio<a class="headerlink" href="#invalid-options-visual-studio" title="Permalink to this headline"></a></h2>
<p>When the C++ compile redistributale is wrongly configured, the program <cite>dumpbinx.exe</cite> reports a dependency, which is not wanted:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PS</span> <span class="n">C</span><span class="p">:</span>\<span class="n">dt</span>\<span class="n">NatlinkDoc</span>\<span class="n">natlink</span>\<span class="n">documentation</span><span class="o">&gt;</span> <span class="o">.</span><span class="s2">&quot;C:\Program Files (x86)\Microsoft Visual Studio</span><span class="se">\201</span><span class="s2">9\Community\VC\Tools\MSVC</span><span class="se">\14</span><span class="s2">.29.30133</span><span class="se">\b</span><span class="s2">in\Hostx86</span><span class="se">\x86</span><span class="s2">\dumpbin.exe&quot;</span> <span class="o">/</span><span class="n">DEPENDENTS</span> <span class="s2">&quot;C:\Program Files (x86)\Natlink\site-packages</span><span class="se">\n</span><span class="s2">atlink\_natlink_core.pyd&quot;</span>
<span class="n">Microsoft</span> <span class="p">(</span><span class="n">R</span><span class="p">)</span> <span class="n">COFF</span><span class="o">/</span><span class="n">PE</span> <span class="n">Dumper</span> <span class="n">Version</span> <span class="mf">14.29.30136.0</span>
<span class="n">Copyright</span> <span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="n">Microsoft</span> <span class="n">Corporation</span><span class="o">.</span>  <span class="n">All</span> <span class="n">rights</span> <span class="n">reserved</span><span class="o">.</span>


<span class="n">Dump</span> <span class="n">of</span> <span class="n">file</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Program</span> <span class="n">Files</span> <span class="p">(</span><span class="n">x86</span><span class="p">)</span>\<span class="n">Natlink</span>\<span class="n">site</span><span class="o">-</span><span class="n">packages</span>\<span class="n">natlink</span>\<span class="n">_natlink_core</span><span class="o">.</span><span class="n">pyd</span>

<span class="n">File</span> <span class="n">Type</span><span class="p">:</span> <span class="n">DLL</span>

  <span class="n">Image</span> <span class="n">has</span> <span class="n">the</span> <span class="n">following</span> <span class="n">dependencies</span><span class="p">:</span>

    <span class="n">python38</span><span class="o">.</span><span class="n">dll</span>
    <span class="n">KERNEL32</span><span class="o">.</span><span class="n">dll</span>
    <span class="n">USER32</span><span class="o">.</span><span class="n">dll</span>
    <span class="n">SHELL32</span><span class="o">.</span><span class="n">dll</span>
    <span class="n">ole32</span><span class="o">.</span><span class="n">dll</span>
    <span class="n">OLEAUT32</span><span class="o">.</span><span class="n">dll</span>
    <span class="n">ADVAPI32</span><span class="o">.</span><span class="n">dll</span>
    <span class="n">MSVCP140D</span><span class="o">.</span><span class="n">dll</span>
    <span class="n">VCRUNTIME140D</span><span class="o">.</span><span class="n">dll</span>
    <span class="n">ucrtbased</span><span class="o">.</span><span class="n">dll</span>

<span class="p">(</span><span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<p>The <cite>VCRUNTIME140D.dll</cite> should not be there.</p>
</section>
<section id="fix">
<h2>Fix<a class="headerlink" href="#fix" title="Permalink to this headline"></a></h2>
<p>Static linking is established by installing:
<a class="reference external" href="https://docs.microsoft.com/en-us/cpp/c-runtime-library/crt-library-features?view=msvc-170&amp;viewFallbackFrom=vs-2019">https://docs.microsoft.com/en-us/cpp/c-runtime-library/crt-library-features?view=msvc-170&amp;viewFallbackFrom=vs-2019</a></p>
<p>Also see “Bundling vc redistributables”:
<a class="reference external" href="https://stackoverflow.com/questions/24574035/how-to-install-microsoft-vc-redistributables-silently-in-inno-setup">https://stackoverflow.com/questions/24574035/how-to-install-microsoft-vc-redistributables-silently-in-inno-setup</a></p>
<p>With install version 5.1.1  (with python 3.8), now the following output is given:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">Powershell</span><span class="p">)</span> <span class="o">.</span><span class="s2">&quot;C:\Program Files (x86)\Microsoft Visual Studio</span><span class="se">\201</span><span class="s2">9\Community\VC\Tools\MSVC</span><span class="se">\14</span><span class="s2">.29.30133</span><span class="se">\b</span><span class="s2">in\Hostx86</span><span class="se">\x86</span><span class="s2">\dumpbin.exe&quot;</span> <span class="o">/</span><span class="n">DEPENDENTS</span> <span class="s2">&quot;C:\Program Files (x86)\Natlink\site-packages</span><span class="se">\n</span><span class="s2">atlink\_natlink_core.pyd&quot;</span>
<span class="n">Dump</span> <span class="n">of</span> <span class="n">file</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Program</span> <span class="n">Files</span> <span class="p">(</span><span class="n">x86</span><span class="p">)</span>\<span class="n">Natlink</span>\<span class="n">site</span><span class="o">-</span><span class="n">packages</span>\<span class="n">natlink</span>\<span class="n">_natlink_core</span><span class="o">.</span><span class="n">pyd</span>

<span class="n">File</span> <span class="n">Type</span><span class="p">:</span> <span class="n">DLL</span>

  <span class="n">Image</span> <span class="n">has</span> <span class="n">the</span> <span class="n">following</span> <span class="n">dependencies</span><span class="p">:</span>

    <span class="n">python38</span><span class="o">.</span><span class="n">dll</span>
    <span class="n">KERNEL32</span><span class="o">.</span><span class="n">dll</span>
    <span class="n">USER32</span><span class="o">.</span><span class="n">dll</span>
    <span class="n">SHELL32</span><span class="o">.</span><span class="n">dll</span>
    <span class="n">ole32</span><span class="o">.</span><span class="n">dll</span>
    <span class="n">OLEAUT32</span><span class="o">.</span><span class="n">dll</span>
    <span class="n">ADVAPI32</span><span class="o">.</span><span class="n">dll</span>
<span class="p">(</span><span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<p>So issue#86(<a class="reference external" href="https://github.com/dictation-toolbox/natlink/issues/86">https://github.com/dictation-toolbox/natlink/issues/86</a>) is hopefully solved and explained with this all.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="configure.html" class="btn btn-neutral float-left" title="Configure Natlink" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="modules.html" class="btn btn-neutral float-right" title="Modules" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 1999, Joel Gould.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>