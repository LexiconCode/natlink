<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>natlink.natlinkstatus &mdash; natlink 5.1.1 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> natlink
          </a>
              <div class="version">
                5.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Install instructions for Natlink</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../configure.html">Configure Natlink</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developers.html">Developers instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../project.html">Project</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">natlink</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../index.html">Module code</a> &raquo;</li>
      <li>natlink.natlinkstatus</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for natlink.natlinkstatus</h1><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># natlinkstatus.py</span>
<span class="c1">#   This module gives the status of Natlink to natlinkmain</span>
<span class="c1">#</span>
<span class="c1">#  (C) Copyright Quintijn Hoogenboom, February 2008/January 2018/extended for python3, Natlink5.0.1 Febr 2022</span>
<span class="c1">#</span>
<span class="c1">#pylint:disable=C0302, C0116, R0201, R0902, R0904, R0912, W0107, E1101</span>
<span class="sd">&quot;&quot;&quot;The following functions are provided in this module:</span>

<span class="sd">The functions below are put into the class NatlinkStatus.</span>

<span class="sd">The functions below should not change anything in settings, only  get information.</span>

<span class="sd">getDNSInstallDir:</span>
<span class="sd">    removed, not needed any more</span>

<span class="sd">getDNSIniDir:</span>
<span class="sd">    returns the directory where the NatSpeak INI files are located,</span>
<span class="sd">    notably nssystem.ini and nsapps.ini. Got from loader.</span>

<span class="sd">getDNSVersion:</span>
<span class="sd">    returns the in the version number of NatSpeak, as an integer. So ..., 13, 15, ...</span>
<span class="sd">    no distinction is made here between different subversions.</span>
<span class="sd">    got indirectly from loader</span>

<span class="sd">getWindowsVersion:</span>
<span class="sd">    see source below</span>

<span class="sd">get_language: </span>
<span class="sd">    returns the 3 letter code of the language of the speech profile that</span>
<span class="sd">    is open: &#39;enx&#39;, &#39;nld&#39;, &quot;fra&quot;, &quot;deu&quot;, &quot;ita&quot;, &quot;esp&quot;</span>

<span class="sd">    get it from loader (property), is updated when user profile changes (on_change_callback)</span>
<span class="sd">    returns &#39;enx&#39; when Dragon is not running.</span>
<span class="sd">    </span>
<span class="sd">get_profile, get_user:</span>
<span class="sd">    returns the directory of the current user profile information and</span>
<span class="sd">    returns the name of the current user</span>
<span class="sd">    This information is collected from natlink.getCurrentUser(), or from</span>
<span class="sd">    the args in on_change_callback, with type == &#39;user&#39;</span>

<span class="sd">get_load_on_begin_utterance and set_load_on_begin_utterance:</span>
<span class="sd">    returns value of this property of the natlinkmain (loader) instance.</span>
<span class="sd">    True or False, or a (small) positive int, decreasing each utterance.</span>
<span class="sd">    </span>
<span class="sd">    or</span>
<span class="sd">    explicitly set this property.</span>
<span class="sd">    </span>
<span class="sd">getPythonVersion:</span>
<span class="sd">    return two character version, so without the dot! eg &#39;38&#39;,</span>
<span class="sd">    </span>
<span class="sd">    Note, no indication of 32 bit version, so no &#39;38-32&#39;</span>


<span class="sd">getUserDirectory: get the Natlink user directory, </span>
<span class="sd">    Especially Dragonfly users will use this directory for putting their grammar files in.</span>
<span class="sd">    Also users that have their own custom grammar files can use this user directory</span>

<span class="sd">getUnimacroDirectory: get the directory where the Unimacro system is.</span>
<span class="sd">    When git cloned, relative to the Core directory, otherwise somewhere or in the site-packages (if pipped). This grammar will (and should) hold the _control.py grammar</span>
<span class="sd">    and needs to be included in the load directories list of James&#39; natlinkmain</span>

<span class="sd">getUnimacroGrammarsDirectory: get the directory, where the user can put his Unimacro grammars. This directory will be</span>
<span class="sd">    located in the `ActiveGrammars` subdirectory of the `~/.unimacro&#39; or `%NATLINK_USERDIR%/.unimacro`).</span>

<span class="sd">getUnimacroUserDirectory: get the directory of Unimacro INI files, if not return &#39;&#39; or</span>
<span class="sd">      the Unimacro user directory</span>

<span class="sd">getVocolaDirectory: get the directory where the Vocola system is. When cloned from git, in Vocola, relative to</span>
<span class="sd">      the Core directory. Otherwise (when pipped) in some site-packages directory. It holds (and should hold) the</span>
<span class="sd">      grammar _vocola_main.py.</span>

<span class="sd">getVocolaUserDirectory: get the directory of Vocola User files, if not return &#39;&#39;</span>
<span class="sd">    (if run from natlinkconfigfunctions use getVocolaDirectoryFromIni, which checks inifile</span>
<span class="sd">     at each call...)</span>

<span class="sd">getVocolaGrammarsDirectory: get the directory, where the compiled Vocola grammars are/will be.</span>
<span class="sd">    This will be the `CompiledGrammars` subdirectory of `~/.vocolaGrammars` or</span>
<span class="sd">    `%NATLINK_USERDIR%/.vocola`.</span>

<span class="sd">getVocolaTakesLanguages: additional settings for Vocola</span>

<span class="sd">new 2014/2022</span>
<span class="sd">getDNSName: return &quot;NatSpeak&quot; for versions &lt;= 11 and &quot;Dragon&quot; for 12 (on) (obsolete in 2022)</span>
<span class="sd">getAhkExeDir: return the directory where AutoHotkey is found (only needed when not in default)</span>
<span class="sd">getAhkUserDir: return User Directory of AutoHotkey, not needed when it is in default.</span>
<span class="sd">get_language and other properties, see above.</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">stat</span>
<span class="kn">import</span> <span class="nn">platform</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">natlink</span> <span class="kn">import</span> <span class="n">loader</span>
<span class="k">except</span> <span class="ne">ModuleNotFoundError</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Natlink is not enabled, module natlink and/or natlink.loader cannot be found</span><span class="se">\n\t</span><span class="s1">exit natlinkstatus.py...&#39;</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
<span class="kn">from</span> <span class="nn">natlink</span> <span class="kn">import</span> <span class="n">config</span>
<span class="kn">from</span> <span class="nn">natlink</span> <span class="kn">import</span> <span class="n">singleton</span>
<span class="kn">import</span> <span class="nn">natlink</span>

<span class="c1">## setup a natlinkmain instance, for getting properties from the loader:</span>
<span class="c1">## note, when loading the natlink module via Dragon, you can call simply:</span>
<span class="c1"># # # natlinkmain = loader.NatlinkMain()</span>

<span class="c1">## setting up Logger and Config is needed, when running this for test:</span>
<span class="n">Logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;natlink&#39;</span><span class="p">)</span>
<span class="n">Config</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">NatlinkConfig</span><span class="o">.</span><span class="n">from_first_found_file</span><span class="p">(</span><span class="n">loader</span><span class="o">.</span><span class="n">config_locations</span><span class="p">())</span>
<span class="n">natlinkmain</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">NatlinkMain</span><span class="p">(</span><span class="n">Logger</span><span class="p">,</span> <span class="n">Config</span><span class="p">)</span>

<span class="c1"># the possible languages (for get_language), now in loader</span>

<span class="n">shiftKeyDict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;nld&quot;</span><span class="p">:</span> <span class="s2">&quot;Shift&quot;</span><span class="p">,</span>
                <span class="s2">&quot;enx&quot;</span><span class="p">:</span> <span class="s1">&#39;shift&#39;</span><span class="p">,</span>
                <span class="s2">&quot;fra&quot;</span><span class="p">:</span> <span class="s2">&quot;maj&quot;</span><span class="p">,</span>
                <span class="s2">&quot;deu&quot;</span><span class="p">:</span> <span class="s2">&quot;umschalt&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ita&quot;</span><span class="p">:</span> <span class="s2">&quot;maiusc&quot;</span><span class="p">,</span>
                <span class="s2">&quot;esp&quot;</span><span class="p">:</span> <span class="s2">&quot;may</span><span class="se">\xfa</span><span class="s2">s&quot;</span><span class="p">}</span>

<span class="n">thisDir</span><span class="p">,</span> <span class="n">thisFile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span>

<div class="viewcode-block" id="NatlinkStatus"><a class="viewcode-back" href="../../natlinkstatus.html#natlink.natlinkstatus.NatlinkStatus">[docs]</a><span class="k">class</span> <span class="nc">NatlinkStatus</span><span class="p">(</span><span class="n">metaclass</span><span class="o">=</span><span class="n">singleton</span><span class="o">.</span><span class="n">Singleton</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;this class holds the Natlink status functions.</span>
<span class="sd">    </span>
<span class="sd">    This class is a Singleton, which means that all instances are the same object.</span>

<span class="sd">    Some information is retrieved from the loader, the natlinkmain (Singleton) instance.</span>
<span class="sd">    </span>
<span class="sd">    In natlinkconfigfunctions.py, NatlinkStatus is subclassed for configuration purposes.</span>
<span class="sd">    in the PyTest folder there are/come test functions in TestNatlinkStatus</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">known_directory_options</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;userdirectory&#39;</span><span class="p">,</span> <span class="s1">&#39;dragonflyuserdirectory&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;unimacrodirectory&#39;</span><span class="p">,</span> <span class="s1">&#39;unimacrogrammarsdirectory&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;vocoladirectory&#39;</span><span class="p">,</span> <span class="s1">&#39;vocolagrammarsdirectory&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;initialise all instance variables, in this singleton class, hoeinstance</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">natlinkmain</span> <span class="o">=</span> <span class="n">natlinkmain</span>  <span class="c1"># global</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DNSVersion</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DNSIniDir</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NatlinkDirectory</span> <span class="o">=</span> <span class="kc">None</span>    <span class="c1"># CoreDirectory and NatlinkDirectory same...</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CoreDirectory</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">UserDirectory</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1">## Unimacro:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">UnimacroDirectory</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">UnimacroUserDirectory</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">UnimacroGrammarsDirectory</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1">## Vocola:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">VocolaUserDirectory</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">VocolaDirectory</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">VocolaGrammarsDirectory</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1">## AutoHotkey:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AhkUserDir</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AhkExeDir</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">NatlinkDirectory</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NatlinkDirectory</span> <span class="o">=</span> <span class="n">thisDir</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">CoreDirectory</span> <span class="o">=</span> <span class="n">thisDir</span>   <span class="c1"># maybe becoming obsolete</span>

<div class="viewcode-block" id="NatlinkStatus.refresh"><a class="viewcode-back" href="../../natlinkstatus.html#natlink.natlinkstatus.NatlinkStatus.refresh">[docs]</a>    <span class="k">def</span> <span class="nf">refresh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;rerun the __init__, refreshing all variables</span>
<span class="sd">        </span>
<span class="sd">        This should be done only from the natlinkconfigfunctions.py, in the configure phase of Natlink</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span></div>

<div class="viewcode-block" id="NatlinkStatus.getWindowsVersion"><a class="viewcode-back" href="../../natlinkstatus.html#natlink.natlinkstatus.NatlinkStatus.getWindowsVersion">[docs]</a>    <span class="nd">@staticmethod</span>    
    <span class="k">def</span> <span class="nf">getWindowsVersion</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;extract the windows version</span>

<span class="sd">        return 1 of the predefined values above, or just return what the system</span>
<span class="sd">        call returns</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">wVersion</span> <span class="o">=</span> <span class="n">platform</span><span class="o">.</span><span class="n">platform</span><span class="p">()</span>
        <span class="k">if</span> <span class="s1">&#39;-&#39;</span> <span class="ow">in</span> <span class="n">wVersion</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">wVersion</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Warning, probably cannot find correct Windows Version... (</span><span class="si">%s</span><span class="s1">)&#39;</span><span class="o">%</span> <span class="n">wVersion</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">wVersion</span></div>
    
<div class="viewcode-block" id="NatlinkStatus.getPythonVersion"><a class="viewcode-back" href="../../natlinkstatus.html#natlink.natlinkstatus.NatlinkStatus.getPythonVersion">[docs]</a>    <span class="k">def</span> <span class="nf">getPythonVersion</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;get the version of python</span>

<span class="sd">        Check if the version is supported on the &quot;lower&quot; side.</span>
<span class="sd">        </span>
<span class="sd">        length 2, without &quot;.&quot;, so &quot;38&quot; etc.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">version</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">version</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">version</span> <span class="o">=</span> <span class="n">version</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">version</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">user</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span>  <span class="bp">self</span><span class="o">.</span><span class="n">natlinkmain</span><span class="o">.</span><span class="n">user</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">profile</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span>  <span class="bp">self</span><span class="o">.</span><span class="n">natlinkmain</span><span class="o">.</span><span class="n">profile</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">language</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span>  <span class="bp">self</span><span class="o">.</span><span class="n">natlinkmain</span><span class="o">.</span><span class="n">language</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">load_on_begin_utterance</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;inspect current value of this loader setting</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span>  <span class="bp">self</span><span class="o">.</span><span class="n">natlinkmain</span><span class="o">.</span><span class="n">load_on_begin_utterance</span>
    
    <span class="k">def</span> <span class="nf">get_user</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span>  <span class="bp">self</span><span class="o">.</span><span class="n">user</span>

    <span class="k">def</span> <span class="nf">get_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span>  <span class="bp">self</span><span class="o">.</span><span class="n">profile</span>

    <span class="k">def</span> <span class="nf">get_language</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span>  <span class="bp">self</span><span class="o">.</span><span class="n">language</span>
    
    <span class="k">def</span> <span class="nf">get_load_on_begin_utterance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_on_begin_utterance</span>
    
<div class="viewcode-block" id="NatlinkStatus.getDNSIniDir"><a class="viewcode-back" href="../../natlinkstatus.html#natlink.natlinkstatus.NatlinkStatus.getDNSIniDir">[docs]</a>    <span class="k">def</span> <span class="nf">getDNSIniDir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;get the path (one above the users profile paths) where the INI files</span>
<span class="sd">        should be located</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># first try if set (by configure dialog/natlinkinstallfunctions.py) if regkey is set:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">DNSIniDir</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">DNSIniDir</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">DNSIniDir</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">get_config_info_from_registry</span><span class="p">(</span><span class="s2">&quot;dragonIniDir&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">DNSIniDir</span></div>

    
<div class="viewcode-block" id="NatlinkStatus.getDNSVersion"><a class="viewcode-back" href="../../natlinkstatus.html#natlink.natlinkstatus.NatlinkStatus.getDNSVersion">[docs]</a>    <span class="k">def</span> <span class="nf">getDNSVersion</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;find the correct DNS version number (as an integer)</span>

<span class="sd">        2022: extract from the dragonIniDir setting in the registry, via loader function</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">DNSVersion</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">DNSVersion</span>
        <span class="n">dragonIniDir</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">get_config_info_from_registry</span><span class="p">(</span><span class="s2">&quot;dragonIniDir&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dragonIniDir</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">version</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">dragonIniDir</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:])</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;getDNSVersion, invalid version found &quot;</span><span class="si">{dragonIniDir[-2:]}</span><span class="s1">&quot;, return 0&#39;</span><span class="p">)</span>
                <span class="n">version</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Error, cannot get dragonIniDir from registry, unknown DNSVersion &quot;</span><span class="si">{</span><span class="n">dragonIniDir</span><span class="si">}</span><span class="s1">&quot;, return 0&#39;</span><span class="p">)</span>
            <span class="n">version</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DNSVersion</span> <span class="o">=</span> <span class="n">version</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">DNSVersion</span></div>
    
<div class="viewcode-block" id="NatlinkStatus.VocolaIsEnabled"><a class="viewcode-back" href="../../natlinkstatus.html#natlink.natlinkstatus.NatlinkStatus.VocolaIsEnabled">[docs]</a>    <span class="k">def</span> <span class="nf">VocolaIsEnabled</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if Vocola is enables</span>
<span class="sd">        </span>
<span class="sd">        To be so,</span>
<span class="sd">        1. the VocolaUserDirectory (where the vocola command files (.vcl) are located)</span>
<span class="sd">        should be defined in the user config file</span>
<span class="sd">        2. the VocolaDirectory should be found, and hold &#39;_vocola_main.py&#39;</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">isdir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span>
        <span class="n">vocUserDir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getVocolaUserDirectory</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">vocUserDir</span> <span class="ow">and</span> <span class="n">isdir</span><span class="p">(</span><span class="n">vocUserDir</span><span class="p">):</span>
            <span class="n">vocDir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getVocolaDirectory</span><span class="p">()</span>
            <span class="n">vocGrammarsDir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getVocolaGrammarsDirectory</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">vocDir</span> <span class="ow">and</span> <span class="n">isdir</span><span class="p">(</span><span class="n">vocDir</span><span class="p">)</span> <span class="ow">and</span> <span class="n">vocGrammarsDir</span> <span class="ow">and</span> <span class="n">isdir</span><span class="p">(</span><span class="n">vocGrammarsDir</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span></div>

    
<div class="viewcode-block" id="NatlinkStatus.UnimacroIsEnabled"><a class="viewcode-back" href="../../natlinkstatus.html#natlink.natlinkstatus.NatlinkStatus.UnimacroIsEnabled">[docs]</a>    <span class="k">def</span> <span class="nf">UnimacroIsEnabled</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;UnimacroIsEnabled: see if UnimacroDirectory and UnimacroUserDirectory are there</span>

<span class="sd">        _control.py should be in the UnimacroDirectory. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">isdir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span>
        <span class="n">uDir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getUnimacroDirectory</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">uDir</span><span class="p">:</span>
            <span class="c1"># print(&#39;no valid UnimacroDirectory, Unimacro is disabled&#39;)</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">isdir</span><span class="p">(</span><span class="n">uDir</span><span class="p">):</span>
            <span class="n">files</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">uDir</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="s1">&#39;_control.py&#39;</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;UnimacroDirectory is present (</span><span class="si">{</span><span class="n">uDir</span><span class="si">}</span><span class="s1">), but not &quot;_control.py&quot; grammar file&#39;</span><span class="p">)</span>
                <span class="k">return</span>  <span class="kc">False</span> <span class="c1"># _control.py should be in Unimacro directory</span>

        <span class="n">uuDir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getUnimacroUserDirectory</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">uuDir</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="n">ugDir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getUnimacroGrammarsDirectory</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">ugDir</span> <span class="ow">and</span> <span class="n">isdir</span><span class="p">(</span><span class="n">ugDir</span><span class="p">)):</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;UnimacroGrammarsDirectory (</span><span class="si">{</span><span class="n">ugDir</span><span class="si">}</span><span class="s1">) not present, please create&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span>            </div>

    
    <span class="k">def</span> <span class="nf">UserIsEnabled</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">userDir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getUserDirectory</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">userDir</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>

<div class="viewcode-block" id="NatlinkStatus.getNatlinkIni"><a class="viewcode-back" href="../../natlinkstatus.html#natlink.natlinkstatus.NatlinkStatus.getNatlinkIni">[docs]</a>    <span class="k">def</span> <span class="nf">getNatlinkIni</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;return the path of the natlink.ini file</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">config_locations</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">OSError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;getNatlinkIni: not a valid file: &quot;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s1">&quot;&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">path</span></div>
    
<div class="viewcode-block" id="NatlinkStatus.getNatlinkUserDirectory"><a class="viewcode-back" href="../../natlinkstatus.html#natlink.natlinkstatus.NatlinkStatus.getNatlinkUserDirectory">[docs]</a>    <span class="k">def</span> <span class="nf">getNatlinkUserDirectory</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;get the directory where &quot;natlink.ini&quot; should be stored</span>
<span class="sd">        </span>
<span class="sd">        This must be a local directory, default `~`, but can be changed by</span>
<span class="sd">        setting `NATLINK_USERDIR` to for example `~/Documents`.</span>
<span class="sd">        </span>
<span class="sd">        Other directories that are created and checked by packages, and should be local, can be</span>
<span class="sd">        stored here, for example `VocolaGrammarsDirectory` (VocolaGrammars) and</span>
<span class="sd">        `UnimacroGrammarsDirectory` (UnimacroGrammars).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">natlink_ini_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getNatlinkIni</span><span class="p">())</span>
        <span class="n">natlink_user_dir</span> <span class="o">=</span> <span class="n">natlink_ini_path</span><span class="o">.</span><span class="n">parent</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">natlink_user_dir</span><span class="p">)</span></div>
    
    <span class="k">def</span> <span class="nf">getUnimacroUserDirectory</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">isdir</span><span class="p">,</span> <span class="n">abspath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">UnimacroUserDirectory</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">UnimacroUserDirectory</span>
        <span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;unimacrouserdirectory&#39;</span>
        <span class="n">value</span> <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">natlinkmain</span><span class="o">.</span><span class="n">getconfigsetting</span><span class="p">(</span><span class="n">section</span><span class="o">=</span><span class="s2">&quot;unimacro&quot;</span><span class="p">,</span> <span class="n">option</span><span class="o">=</span><span class="n">key</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">value</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">UnimacroUserDirectory</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="k">return</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">isdir</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">UnimacroUserDirectory</span> <span class="o">=</span> <span class="n">value</span>
            <span class="k">return</span> <span class="n">abspath</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="c1"># for future use:</span>
        <span class="n">expanded</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">expand_path</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">expanded</span> <span class="ow">and</span> <span class="n">isdir</span><span class="p">(</span><span class="n">expanded</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">UnimacroUserDirectory</span> <span class="o">=</span> <span class="n">expanded</span>
            <span class="k">return</span> <span class="n">abspath</span><span class="p">(</span><span class="n">expanded</span><span class="p">)</span>
        <span class="c1"># nothing or wrong directory:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;invalid path for UnimacroUserDirectory: &quot;</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s1">&quot;, return &quot;&quot;&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">UnimacroUserDirectory</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
    
    
<div class="viewcode-block" id="NatlinkStatus.getUnimacroDirectory"><a class="viewcode-back" href="../../natlinkstatus.html#natlink.natlinkstatus.NatlinkStatus.getUnimacroDirectory">[docs]</a>    <span class="k">def</span> <span class="nf">getUnimacroDirectory</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;return the path to the UnimacroDirectory</span>
<span class="sd">        </span>
<span class="sd">        This is the directory where the _control.py grammar is, and</span>
<span class="sd">        is normally got via `pip install unimacro`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># When git cloned, relative to the Core directory, otherwise somewhere or in the site-packages (if pipped).</span>
        <span class="n">join</span><span class="p">,</span> <span class="n">isdir</span><span class="p">,</span> <span class="n">isfile</span><span class="p">,</span> <span class="n">abspath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">UnimacroDirectory</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">UnimacroDirectory</span>
        <span class="n">uDir</span> <span class="o">=</span> <span class="n">join</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">prefix</span><span class="p">,</span> <span class="s2">&quot;lib&quot;</span><span class="p">,</span> <span class="s2">&quot;site-packages&quot;</span><span class="p">,</span> <span class="s2">&quot;unimacro&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">isdir</span><span class="p">(</span><span class="n">uDir</span><span class="p">):</span>
            <span class="n">uFile</span> <span class="o">=</span> <span class="s2">&quot;_control.py&quot;</span>
            <span class="n">controlGrammar</span> <span class="o">=</span> <span class="n">join</span><span class="p">(</span><span class="n">uDir</span><span class="p">,</span> <span class="n">uFile</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">isfile</span><span class="p">(</span><span class="n">controlGrammar</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">UnimacroDirectory</span> <span class="o">=</span> <span class="n">abspath</span><span class="p">(</span><span class="n">uDir</span><span class="p">)</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">UnimacroDirectory</span>
            <span class="c1"># print(f&#39;UnimacroDirectory found: &quot;{uDir}&quot;, but no valid file: &quot;{uFile}&quot;, return &quot;&quot;&#39;)</span>
            <span class="k">return</span> <span class="s2">&quot;&quot;</span>
        <span class="c1"># print(&#39;UnimacroDirectory not found in &quot;lib/site-packages/unimacro&quot;, return &quot;&quot;&#39;)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">UnimacroDirectory</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span></div>
        
    
<div class="viewcode-block" id="NatlinkStatus.getUnimacroGrammarsDirectory"><a class="viewcode-back" href="../../natlinkstatus.html#natlink.natlinkstatus.NatlinkStatus.getUnimacroGrammarsDirectory">[docs]</a>    <span class="k">def</span> <span class="nf">getUnimacroGrammarsDirectory</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;return the path to the directory where the ActiveGrammars of Unimacro are located.</span>
<span class="sd">        </span>
<span class="sd">        Expected in &quot;UnimacroGrammars&quot; of the natlink user directory</span>
<span class="sd">        (May 2022)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">UnimacroGrammarsDirectory</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">UnimacroGrammarsDirectory</span>
        
        <span class="n">natlink_user_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getNatlinkUserDirectory</span><span class="p">()</span>
        
        <span class="n">um_grammars_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">natlink_user_dir</span><span class="p">)</span><span class="o">/</span><span class="s1">&#39;UnimacroGrammars&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">um_grammars_dir</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
            <span class="n">um_grammars_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">()</span>
        <span class="n">um_grammars_dir</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">um_grammars_dir</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">UnimacroGrammarsDirectory</span> <span class="o">=</span> <span class="n">um_grammars_dir</span>

        <span class="k">return</span> <span class="n">um_grammars_dir</span></div>
    
<div class="viewcode-block" id="NatlinkStatus.getNatlinkDirectory"><a class="viewcode-back" href="../../natlinkstatus.html#natlink.natlinkstatus.NatlinkStatus.getNatlinkDirectory">[docs]</a>    <span class="k">def</span> <span class="nf">getNatlinkDirectory</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;return the path of the NatlinkDirectory</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">NatlinkDirectory</span></div>

<div class="viewcode-block" id="NatlinkStatus.getCoreDirectory"><a class="viewcode-back" href="../../natlinkstatus.html#natlink.natlinkstatus.NatlinkStatus.getCoreDirectory">[docs]</a>    <span class="k">def</span> <span class="nf">getCoreDirectory</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;return the path of the coreDirectory, same as NatlinkDirectory, obsolete</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">CoreDirectory</span></div>
    
<div class="viewcode-block" id="NatlinkStatus.getUserDirectory"><a class="viewcode-back" href="../../natlinkstatus.html#natlink.natlinkstatus.NatlinkStatus.getUserDirectory">[docs]</a>    <span class="k">def</span> <span class="nf">getUserDirectory</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;return the path to the Natlink User directory</span>

<span class="sd">        this one is not any more for Unimacro, but for User specified grammars, also Dragonfly</span>

<span class="sd">        should be set in configurenatlink, otherwise ignore...</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">isdir</span><span class="p">,</span> <span class="n">abspath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">UserDirectory</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">UserDirectory</span>
        <span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;UserDirectory&#39;</span>
        <span class="n">value</span> <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">natlinkmain</span><span class="o">.</span><span class="n">getconfigsetting</span><span class="p">(</span><span class="n">section</span><span class="o">=</span><span class="s1">&#39;directories&#39;</span><span class="p">,</span> <span class="n">option</span><span class="o">=</span><span class="n">key</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">and</span> <span class="n">isdir</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">UserDirectory</span> <span class="o">=</span> <span class="n">abspath</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">UserDirectory</span>
        <span class="n">expanded</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">expand_path</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">expanded</span> <span class="ow">and</span> <span class="n">isdir</span><span class="p">(</span><span class="n">expanded</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">UserDirectory</span> <span class="o">=</span> <span class="n">abspath</span><span class="p">(</span><span class="n">expanded</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">UserDirectory</span>
            
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;invalid path for UserDirectory: &quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span><span class="o">%</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">UserDirectory</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span></div>

    
    
    <span class="k">def</span> <span class="nf">getVocolaUserDirectory</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="n">isdir</span><span class="p">,</span> <span class="n">abspath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">VocolaUserDirectory</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">VocolaUserDirectory</span>
        <span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;vocolauserdirectory&#39;</span>
        <span class="n">section</span> <span class="o">=</span> <span class="s1">&#39;vocola&#39;</span>
        <span class="n">value</span> <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">natlinkmain</span><span class="o">.</span><span class="n">getconfigsetting</span><span class="p">(</span><span class="n">section</span><span class="o">=</span><span class="n">section</span><span class="p">,</span> <span class="n">option</span><span class="o">=</span><span class="n">key</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">value</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">VocolaUserDirectory</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="k">return</span> <span class="s1">&#39;&#39;</span>

        <span class="k">if</span> <span class="n">isdir</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">VocolaUserDirectory</span> <span class="o">=</span> <span class="n">abspath</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">value</span>
        <span class="c1"># for future use:</span>
        <span class="n">expanded</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">expand_path</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">expanded</span> <span class="ow">and</span> <span class="n">isdir</span><span class="p">(</span><span class="n">expanded</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">VocolaUserDirectory</span> <span class="o">=</span> <span class="n">abspath</span><span class="p">(</span><span class="n">expanded</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">VocolaUserDirectory</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;invalid path for VocolaUserDirectory: &quot;</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s1">&quot;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">VocolaUserDirectory</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
    
    <span class="k">def</span> <span class="nf">getVocolaDirectory</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">isdir</span><span class="p">,</span> <span class="n">isfile</span><span class="p">,</span> <span class="n">join</span><span class="p">,</span> <span class="n">abspath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">VocolaDirectory</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">VocolaDirectory</span>

        <span class="c1">## try in site-packages:</span>
        <span class="n">vocDir</span> <span class="o">=</span> <span class="n">join</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">prefix</span><span class="p">,</span> <span class="s2">&quot;lib&quot;</span><span class="p">,</span> <span class="s2">&quot;site-packages&quot;</span><span class="p">,</span> <span class="s2">&quot;vocola2&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">isdir</span><span class="p">(</span><span class="n">vocDir</span><span class="p">):</span>
            <span class="c1"># print(&#39;VocolaDirectory not found in &quot;lib/site-packages/vocola2&quot;, return &quot;&quot;&#39;)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">VocolaDirectory</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="k">return</span> <span class="s1">&#39;&#39;</span>
        <span class="n">vocFile</span> <span class="o">=</span> <span class="s2">&quot;_vocola_main.py&quot;</span>
        <span class="n">checkGrammar</span> <span class="o">=</span> <span class="n">join</span><span class="p">(</span><span class="n">vocDir</span><span class="p">,</span> <span class="n">vocFile</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">isfile</span><span class="p">(</span><span class="n">checkGrammar</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;VocolaDirectory found in &quot;</span><span class="si">{</span><span class="n">vocDir</span><span class="si">}</span><span class="s1">&quot;, but no file &quot;</span><span class="si">{</span><span class="n">vocFile</span><span class="si">}</span><span class="s1">&quot; found, return &quot;&quot;&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">VocolaDirectory</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="k">return</span> <span class="s1">&#39;&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">VocolaDirectory</span> <span class="o">=</span> <span class="n">abspath</span><span class="p">(</span><span class="n">vocDir</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">VocolaDirectory</span>

    
<div class="viewcode-block" id="NatlinkStatus.getVocolaGrammarsDirectory"><a class="viewcode-back" href="../../natlinkstatus.html#natlink.natlinkstatus.NatlinkStatus.getVocolaGrammarsDirectory">[docs]</a>    <span class="k">def</span> <span class="nf">getVocolaGrammarsDirectory</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;return the VocolaGrammarsDirectory, but only if Vocola is enabled</span>
<span class="sd">        </span>
<span class="sd">        If so, the subdirectory VocolaGrammars is created if not there yet.</span>
<span class="sd">        </span>
<span class="sd">        The path of this &quot;VocolaGrammars&quot; directory is returned.</span>
<span class="sd">        </span>
<span class="sd">        If Vocola is not enabled, or anything goes wrong, return &quot;&quot;</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">VocolaGrammarsDirectory</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">VocolaGrammarsDirectory</span>
        
        <span class="n">natlink_user_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getNatlinkUserDirectory</span><span class="p">()</span>
        
        <span class="n">voc_grammars_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">natlink_user_dir</span><span class="p">)</span><span class="o">/</span><span class="s1">&#39;VocolaGrammars&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">voc_grammars_dir</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
            <span class="n">voc_grammars_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">()</span>
        <span class="n">voc_grammars_dir</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">voc_grammars_dir</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">VocolaGrammarsDirectory</span> <span class="o">=</span> <span class="n">voc_grammars_dir</span>

        <span class="k">return</span> <span class="n">voc_grammars_dir</span></div>
    
    <span class="k">def</span> <span class="nf">getAhkUserDir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getAhkUserDirFromIni</span><span class="p">()</span>

    
    <span class="k">def</span> <span class="nf">getAhkUserDirFromIni</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">isdir</span><span class="p">,</span> <span class="n">abspath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span>
        <span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;AhkUserDir&#39;</span>
        <span class="n">value</span> <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">natlinkmain</span><span class="o">.</span><span class="n">getconfigsetting</span><span class="p">(</span><span class="n">section</span><span class="o">=</span><span class="s1">&#39;autohotkey&#39;</span><span class="p">,</span> <span class="n">option</span><span class="o">=</span><span class="n">key</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">value</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">AhkUserDir</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="k">return</span> <span class="n">value</span>
            
        <span class="k">if</span> <span class="n">isdir</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">AhkUserDir</span> <span class="o">=</span> <span class="n">abspath</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">value</span>
        <span class="n">expanded</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">expand_path</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">expanded</span> <span class="ow">and</span> <span class="n">isdir</span><span class="p">(</span><span class="n">expanded</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">AhkUserDir</span><span class="o">=</span> <span class="n">abspath</span><span class="p">(</span><span class="n">expanded</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">AhkUserDir</span>
  
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;invalid path for AhkUserDir: &quot;</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s1">&quot;, return &quot;&quot;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AhkUserDir</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
    
    
    <span class="k">def</span> <span class="nf">getAhkExeDir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">AhkExeDir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">AhkExeDir</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getAhkExeDirFromIni</span><span class="p">()</span>

    
    <span class="k">def</span> <span class="nf">getAhkExeDirFromIni</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">isdir</span><span class="p">,</span> <span class="n">abspath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span>
        <span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;AhkExeDir&#39;</span>
        <span class="n">value</span> <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">natlinkmain</span><span class="o">.</span><span class="n">getconfigsetting</span><span class="p">(</span><span class="n">section</span><span class="o">=</span><span class="s1">&#39;autohotkey&#39;</span><span class="p">,</span> <span class="n">option</span><span class="o">=</span><span class="n">key</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">value</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">AhkExeDir</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="k">return</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">isdir</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">AhkExeDir</span> <span class="o">=</span> <span class="n">abspath</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">value</span>
        <span class="n">expanded</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">expand_path</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">expanded</span> <span class="ow">and</span> <span class="n">isdir</span><span class="p">(</span><span class="n">expanded</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">AhkExeDir</span> <span class="o">=</span> <span class="n">abspath</span><span class="p">(</span><span class="n">expanded</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">AhkExeDir</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;invalid path for AhkExeDir: &quot;</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s1">&quot;, return &quot;&quot;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AhkExeDir</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>

<div class="viewcode-block" id="NatlinkStatus.getExtraGrammarDirectories"><a class="viewcode-back" href="../../natlinkstatus.html#natlink.natlinkstatus.NatlinkStatus.getExtraGrammarDirectories">[docs]</a>    <span class="k">def</span> <span class="nf">getExtraGrammarDirectories</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;record grammar directories that are unknown to natlinkstatus and natlinkconfigfunctions</span>
<span class="sd">        </span>
<span class="sd">        These directories can be entered &quot;manually&quot; in the `natlink.ini` file</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">natlinkmain</span><span class="o">.</span><span class="n">getconfigsetting</span><span class="p">(</span><span class="n">section</span><span class="o">=</span><span class="s1">&#39;directories&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">result</span> <span class="k">if</span> <span class="n">s</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">known_directory_options</span><span class="p">]</span></div>

    <span class="k">def</span> <span class="nf">getUnimacroIniFilesEditor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;UnimacroIniFilesEditor&#39;</span>
        <span class="n">value</span> <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">natlinkmain</span><span class="o">.</span><span class="n">getconfigsetting</span><span class="p">(</span><span class="n">section</span><span class="o">=</span><span class="s1">&#39;unimacro&#39;</span><span class="p">,</span> <span class="n">option</span><span class="o">=</span><span class="n">key</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">value</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;notepad&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">UnimacroIsEnabled</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">value</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
    
<div class="viewcode-block" id="NatlinkStatus.getShiftKey"><a class="viewcode-back" href="../../natlinkstatus.html#natlink.natlinkstatus.NatlinkStatus.getShiftKey">[docs]</a>    <span class="k">def</span> <span class="nf">getShiftKey</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;return the shiftkey, for setting in natlinkmain when user language changes.</span>

<span class="sd">        used for self.playString in natlinkutils, for the dropping character bug. (dec 2015, QH).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">## TODO: must be windows language...</span>
        <span class="n">windowsLanguage</span> <span class="o">=</span> <span class="s1">&#39;enx&#39;</span>  <span class="c1">### ??? TODO QH</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;{</span><span class="si">%s</span><span class="s2">}&quot;</span><span class="o">%</span> <span class="n">shiftKeyDict</span><span class="p">[</span><span class="n">windowsLanguage</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;no shiftKey code provided for language: &quot;</span><span class="si">{</span><span class="n">windowsLanguage</span><span class="si">}</span><span class="s1">&quot;, take empty string.&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="s2">&quot;&quot;</span></div>

    <span class="c1"># get additional options Vocola</span>
    
<div class="viewcode-block" id="NatlinkStatus.getVocolaTakesLanguages"><a class="viewcode-back" href="../../natlinkstatus.html#natlink.natlinkstatus.NatlinkStatus.getVocolaTakesLanguages">[docs]</a>    <span class="k">def</span> <span class="nf">getVocolaTakesLanguages</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;gets and value for distinction of different languages in Vocola</span>
<span class="sd">        If Vocola is not enabled, this option will also return False</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;vocolatakeslanguages&#39;</span>
        <span class="k">return</span>  <span class="bp">self</span><span class="o">.</span><span class="n">natlinkmain</span><span class="o">.</span><span class="n">getconfigsetting</span><span class="p">(</span><span class="n">section</span><span class="o">=</span><span class="s2">&quot;vocola&quot;</span><span class="p">,</span> <span class="n">option</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="s1">&#39;getboolean&#39;</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="NatlinkStatus.getVocolaTakesUnimacroActions"><a class="viewcode-back" href="../../natlinkstatus.html#natlink.natlinkstatus.NatlinkStatus.getVocolaTakesUnimacroActions">[docs]</a>    <span class="k">def</span> <span class="nf">getVocolaTakesUnimacroActions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;gets and value for optional Vocola takes Unimacro actions</span>
<span class="sd">        If Vocola is not enabled, this option will also return False</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;VocolaTakesUnimacroActions&#39;</span>
        <span class="k">return</span>  <span class="bp">self</span><span class="o">.</span><span class="n">natlinkmain</span><span class="o">.</span><span class="n">getconfigsetting</span><span class="p">(</span><span class="n">section</span><span class="o">=</span><span class="s2">&quot;vocola&quot;</span><span class="p">,</span> <span class="n">option</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="s1">&#39;getboolean&#39;</span><span class="p">)</span></div>

    
    <span class="k">def</span> <span class="nf">getInstallVersion</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">version</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">get_config_info_from_registry</span><span class="p">(</span><span class="s2">&quot;version&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">version</span>
    
<div class="viewcode-block" id="NatlinkStatus.getDNSName"><a class="viewcode-back" href="../../natlinkstatus.html#natlink.natlinkstatus.NatlinkStatus.getDNSName">[docs]</a>    <span class="nd">@staticmethod</span>  
    <span class="k">def</span> <span class="nf">getDNSName</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;return NatSpeak for versions &lt;= 11, and Dragon for versions &gt;= 12</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;Dragon&quot;</span></div>

    
<div class="viewcode-block" id="NatlinkStatus.getNatlinkStatusDict"><a class="viewcode-back" href="../../natlinkstatus.html#natlink.natlinkstatus.NatlinkStatus.getNatlinkStatusDict">[docs]</a>    <span class="k">def</span> <span class="nf">getNatlinkStatusDict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;return actual status in a dict</span>
<span class="sd">        </span>
<span class="sd">        Most values come via properties...</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">D</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># properties:</span>
        <span class="n">D</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_user</span><span class="p">()</span>
        <span class="n">D</span><span class="p">[</span><span class="s1">&#39;profile&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_profile</span><span class="p">()</span>
        <span class="n">D</span><span class="p">[</span><span class="s1">&#39;language&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_language</span><span class="p">()</span>
        <span class="n">D</span><span class="p">[</span><span class="s1">&#39;load_on_begin_utterance&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_load_on_begin_utterance</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;DNSIniDir&#39;</span><span class="p">,</span> <span class="s1">&#39;WindowsVersion&#39;</span><span class="p">,</span> <span class="s1">&#39;DNSVersion&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;PythonVersion&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;DNSName&#39;</span><span class="p">,</span> <span class="s1">&#39;NatlinkIni&#39;</span><span class="p">,</span> <span class="s1">&#39;NatlinkUserDirectory&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;UnimacroDirectory&#39;</span><span class="p">,</span> <span class="s1">&#39;UnimacroUserDirectory&#39;</span><span class="p">,</span> <span class="s1">&#39;UnimacroGrammarsDirectory&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;VocolaDirectory&#39;</span><span class="p">,</span> <span class="s1">&#39;VocolaUserDirectory&#39;</span><span class="p">,</span> <span class="s1">&#39;VocolaGrammarsDirectory&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;VocolaTakesLanguages&#39;</span><span class="p">,</span> <span class="s1">&#39;VocolaTakesUnimacroActions&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;UnimacroIniFilesEditor&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;ExtraGrammarDirectories&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;InstallVersion&#39;</span><span class="p">,</span>
                    <span class="c1"># &#39;IncludeUnimacroInPythonPath&#39;,</span>
                    <span class="s1">&#39;AhkExeDir&#39;</span><span class="p">,</span> <span class="s1">&#39;AhkUserDir&#39;</span><span class="p">]:</span>
<span class="c1">##                    &#39;BaseTopic&#39;, &#39;BaseModel&#39;]:</span>
            <span class="n">func_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;get</span><span class="si">{</span><span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="n">func</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func_name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">func</span><span class="p">:</span>
                <span class="n">D</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;no valid function for getting key: &quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1">&quot; (&quot;</span><span class="si">{</span><span class="n">func_name</span><span class="si">}</span><span class="s1">&quot;)&#39;</span><span class="p">)</span>

        <span class="n">D</span><span class="p">[</span><span class="s1">&#39;NatlinkDirectory&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getNatlinkDirectory</span><span class="p">()</span>
        <span class="n">D</span><span class="p">[</span><span class="s1">&#39;UserDirectory&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getUserDirectory</span><span class="p">()</span>
        <span class="n">D</span><span class="p">[</span><span class="s1">&#39;vocolaIsEnabled&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">VocolaIsEnabled</span><span class="p">()</span>

        <span class="n">D</span><span class="p">[</span><span class="s1">&#39;unimacroIsEnabled&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">UnimacroIsEnabled</span><span class="p">()</span>
        <span class="n">D</span><span class="p">[</span><span class="s1">&#39;userIsEnabled&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">UserIsEnabled</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">D</span></div>

    
    <span class="k">def</span> <span class="nf">getNatlinkStatusString</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">L</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">D</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getNatlinkStatusDict</span><span class="p">()</span>
        <span class="n">L</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;--- properties:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">appendAndRemove</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="s1">&#39;user&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">appendAndRemove</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="s1">&#39;profile&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">appendAndRemove</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="s1">&#39;language&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">appendAndRemove</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="s1">&#39;load_on_begin_utterance&#39;</span><span class="p">)</span>

        <span class="c1"># Natlink::</span>
        <span class="n">L</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;NatlinkDirectory&#39;</span><span class="p">,</span> <span class="s1">&#39;InstallVersion&#39;</span><span class="p">,</span> <span class="s1">&#39;NatlinkIni&#39;</span><span class="p">,</span> <span class="s1">&#39;NatlinkUserDirectory&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">appendAndRemove</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>

        <span class="c1">## Vocola::</span>
        <span class="k">if</span> <span class="n">D</span><span class="p">[</span><span class="s1">&#39;vocolaIsEnabled&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">appendAndRemove</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="s1">&#39;vocolaIsEnabled&#39;</span><span class="p">,</span> <span class="s2">&quot;---Vocola is enabled&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;VocolaUserDirectory&#39;</span><span class="p">,</span> <span class="s1">&#39;VocolaDirectory&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;VocolaGrammarsDirectory&#39;</span><span class="p">,</span> <span class="s1">&#39;VocolaTakesLanguages&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;VocolaTakesUnimacroActions&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">appendAndRemove</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">appendAndRemove</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="s1">&#39;vocolaIsEnabled&#39;</span><span class="p">,</span> <span class="s2">&quot;---Vocola is disabled&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;VocolaUserDirectory&#39;</span><span class="p">,</span> <span class="s1">&#39;VocolaDirectory&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;VocolaGrammarsDirectory&#39;</span><span class="p">,</span> <span class="s1">&#39;VocolaTakesLanguages&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;VocolaTakesUnimacroActions&#39;</span><span class="p">):</span>
                <span class="k">del</span> <span class="n">D</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

        <span class="c1">## Unimacro:</span>
        <span class="k">if</span> <span class="n">D</span><span class="p">[</span><span class="s1">&#39;unimacroIsEnabled&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">appendAndRemove</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="s1">&#39;unimacroIsEnabled&#39;</span><span class="p">,</span> <span class="s2">&quot;---Unimacro is enabled&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;UnimacroUserDirectory&#39;</span><span class="p">,</span> <span class="s1">&#39;UnimacroDirectory&#39;</span><span class="p">,</span> <span class="s1">&#39;UnimacroGrammarsDirectory&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">appendAndRemove</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;UnimacroIniFilesEditor&#39;</span><span class="p">,):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">appendAndRemove</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">appendAndRemove</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="s1">&#39;unimacroIsEnabled&#39;</span><span class="p">,</span> <span class="s2">&quot;---Unimacro is disabled&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;UnimacroUserDirectory&#39;</span><span class="p">,</span> <span class="s1">&#39;UnimacroIniFilesEditor&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;UnimacroDirectory&#39;</span><span class="p">,</span> <span class="s1">&#39;UnimacroGrammarsDirectory&#39;</span><span class="p">):</span>
                <span class="k">del</span> <span class="n">D</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="c1">##  UserDirectory:</span>
        <span class="k">if</span> <span class="n">D</span><span class="p">[</span><span class="s1">&#39;userIsEnabled&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">appendAndRemove</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="s1">&#39;userIsEnabled&#39;</span><span class="p">,</span> <span class="s2">&quot;---User defined grammars are enabled&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;UserDirectory&#39;</span><span class="p">,):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">appendAndRemove</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">appendAndRemove</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="s1">&#39;userIsEnabled&#39;</span><span class="p">,</span> <span class="s2">&quot;---User defined grammars are disabled&quot;</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">D</span><span class="p">[</span><span class="s1">&#39;UserDirectory&#39;</span><span class="p">]</span>

        <span class="c1">## remaining Natlink options:</span>
        <span class="n">L</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;other Natlink info:&#39;</span><span class="p">)</span>

        <span class="c1"># system:</span>
        <span class="n">L</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;system information:&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;DNSIniDir&#39;</span><span class="p">,</span> <span class="s1">&#39;DNSVersion&#39;</span><span class="p">,</span> <span class="s1">&#39;DNSName&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;WindowsVersion&#39;</span><span class="p">,</span> <span class="s1">&#39;PythonVersion&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">appendAndRemove</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>

        <span class="c1"># forgotten???</span>
        <span class="k">if</span> <span class="n">D</span><span class="p">:</span>
            <span class="n">L</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;remaining information:&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">appendAndRemove</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>

        <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>

    
    <span class="k">def</span> <span class="nf">appendAndRemove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Key</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">text</span><span class="p">:</span>
            <span class="n">List</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Key</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">Key</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">6</span><span class="p">:</span>
                <span class="n">List</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t</span><span class="si">{</span><span class="n">Key</span><span class="si">}</span><span class="se">\t\t\t</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">Key</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">13</span><span class="p">:</span>
                <span class="n">List</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t</span><span class="si">{</span><span class="n">Key</span><span class="si">}</span><span class="se">\t\t</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">List</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t</span><span class="si">{</span><span class="n">Key</span><span class="si">}</span><span class="se">\t</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Key</span><span class="p">]</span></div>
        
<span class="k">def</span> <span class="nf">getFileDate</span><span class="p">(</span><span class="n">modName</span><span class="p">):</span>
    <span class="c1">#pylint:disable=C0321</span>
    <span class="k">try</span><span class="p">:</span> <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">stat</span><span class="p">(</span><span class="n">modName</span><span class="p">)[</span><span class="n">stat</span><span class="o">.</span><span class="n">ST_MTIME</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span> <span class="k">return</span> <span class="mi">0</span>        <span class="c1"># file not found</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">NatlinkStatus</span><span class="p">()</span>

    <span class="n">Lang</span> <span class="o">=</span> <span class="n">status</span><span class="o">.</span><span class="n">get_language</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;language: &quot;</span><span class="si">{</span><span class="n">Lang</span><span class="si">}</span><span class="s1">&quot;&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">status</span><span class="o">.</span><span class="n">getNatlinkStatusString</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;load_on_begin_utterance: </span><span class="si">{</span><span class="n">status</span><span class="o">.</span><span class="n">get_load_on_begin_utterance</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">dns_version</span> <span class="o">=</span> <span class="n">status</span><span class="o">.</span><span class="n">getDNSVersion</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;DNSVersion: </span><span class="si">{</span><span class="n">dns_version</span><span class="si">}</span><span class="s1"> (type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">dns_version</span><span class="p">)</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
 
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">natlink</span><span class="o">.</span><span class="n">natConnect</span><span class="p">()</span>
    <span class="n">main</span><span class="p">()</span>
    <span class="n">natlink</span><span class="o">.</span><span class="n">natDisconnect</span><span class="p">()</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 1999, Joel Gould.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>