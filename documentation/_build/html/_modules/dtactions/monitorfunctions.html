

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>natlink.monitorfunctions &mdash; natlink 1.1.0 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> natlink
          

          
          </a>

          
            
            
              <div class="version">
                1.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../project.html">Project</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">natlink</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>natlink.monitorfunctions</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for natlink.monitorfunctions</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;gives the monitor information of all the monitors </span>

<span class="sd">and provide functions for moving a (top level) window to a position on</span>
<span class="sd">the current or on a different monitor.</span>

<span class="sd">The start of this module was taken from O&#39;Reilly, and has been enhanced for use</span>
<span class="sd">with NatLink speech recognition commands, see Unimacro_</span>

<span class="sd">Quintijn Hoogenboom, february 2010/May 2021</span>

<span class="sd">.. _Unimacro: http://qh.antenna.nl/unimacro</span>



<span class="sd">**The basic information** is collected in:</span>

<span class="sd">- :code:`MONITOR_INFO`, a `dict` with keys the handles of the monitor.</span>
<span class="sd">  These keys are converted to `int`, and for 2 monitors probably 65537 and</span>
<span class="sd">  65539, and put in global variable :code:`MONITOR_HNDLES` (a `list`)</span>

<span class="sd">- Each item of `MONITOR_INFO` is again a dictionary with for example my second monitor info:</span>
<span class="sd">  |  {&#39;Device&#39;: &#39;\\\\.\\DISPLAY2&#39;,</span>
<span class="sd">  |  &#39;Flags&#39;: 0,</span>
<span class="sd">  |  &#39;Monitor&#39;: (1680, 0, 2704, 768),</span>
<span class="sd">  |  &#39;Work&#39;: (1787, 0, 2704, 768),</span>
<span class="sd">  |  &#39;offsetx&#39;: 107,</span>
<span class="sd">  |  &#39;offsety&#39;: 0}</span>
<span class="sd">   </span>
<span class="sd">  Thus holding the Monitor info and the Work info. The `Work` info gives the space for normal windows,</span>
<span class="sd">  so exclusive of the Windows Taskbar and the Dragon Bar (the old fashioned one).</span>
<span class="sd"> </span>
<span class="sd">  As an extra `offsetx` and `offsety` are calculated,</span>
<span class="sd">  which give the width/height of task bar and possibly other &quot;bars&quot;. In this example I have the task bar</span>
<span class="sd">  vertically placed at the left side of this second monitor, and it has a width of 107 pixels.``</span>

<span class="sd">- :code:`MONITOR_HNDLES`: a list of the available monitors (the handles are int, see above)</span>
<span class="sd">- :code:`VIRTUAL_SCREEN`: a 4 tuple giving the (left, top, right, bottom) of the complete (virtual) screen</span>
<span class="sd">- :code:`BORDERX`, :code:`BORDERY`: the border width of windows. With this a window can be sized a little bit.</span>

<span class="sd">- :code:`MA`, :code:`WA`, :code:`RA`</span>

<span class="sd">  Each area (`MA`: Monitor, `WA`: Work, `RA`: restore area of a window) is a 4 length tuple</span>
<span class="sd">  giving (left, top, right, bottom).</span>

<span class="sd">Biggest puzzle of the calculations is changing the restore_area (from GetWindowPlacement) to the Work area of</span>
<span class="sd">a new monitor. Important is the `offsetx` and `offsety` (difference between Monitor coordinates and Work area</span>
<span class="sd">coordinates). The `RA` (restore_area) is relative to the Work area of the monitor it is on,</span>
<span class="sd">so the `offsetx` and `offsety`</span>
<span class="sd">must be subtracted from the calculated coordinates. (something like that)</span>

<span class="sd">**This module provides functions for getting:**</span>

<span class="sd">all the info:</span>
<span class="sd">  :code:`monitor_info(force=None)`:       giving the above mentioned data</span>

<span class="sd">which is the nearest monitor, using API functions:</span>
<span class="sd">  :code:`get_nearest_monitor_window(winHndle)`</span>

<span class="sd">  :code:`get_nearest_monitor_point(point)`</span>

<span class="sd">  (you could also use :code:`get_nearest_monitor_rect`, but this was not needed here)</span>

<span class="sd">further info:</span>
<span class="sd">  :code:`get_other_monitors(mon)`:     give a list of the other monitor hndles (after collecting the current monitor)</span>
<span class="sd">    </span>
<span class="sd">for individual points:</span>
<span class="sd">  (used by natlinkutilsqh.py in Unimacro (NatLink, speech recognition)</span>
<span class="sd">  </span>
<span class="sd">  :code:`is_inside_monitor(point)`:             returns True if the point is inside one of the monitors (monitor area)</span>
<span class="sd">  :code:`get_closest_position(point)`:          returns a point that is closest to an outside point on one of the monitors</span>
<span class="sd">    </span>
<span class="sd">for user calls:</span>
<span class="sd">  :code:`maximize_window(winHndle)`:            just maximize</span>
<span class="sd">  :code:`minimize_window(winHndle)`:            just minimize</span>

<span class="sd">  :code:`move_to_monitor(winHndle, newMonitor, oldMonitor, resize)`: move to another monitor</span>
<span class="sd">  preserving position of restore_area as much as possible.</span>
<span class="sd">  resize: 0 if window is (assumed to be) fixed in size.</span>
<span class="sd">  This can be found with: :code:`window_can_be_resized(winHndle)`</span>
<span class="sd">        </span>
<span class="sd">  :code:`restore_window(winHndle, monitor, ...)`: placing in various spots and widths/heights</span>
<span class="sd">  see at definition for parameters</span>
<span class="sd">    </span>
<span class="sd">Several test functions demonstrate the result of different monitor functions.</span>
<span class="sd">Switch them on or of at the bottom of the file</span>

<span class="sd">Functions:</span>
<span class="sd">==========</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="c1"># pylint: disable=C0302</span>
<span class="kn">import</span> <span class="nn">pprint</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">win32api</span>
<span class="kn">import</span> <span class="nn">win32gui</span>
<span class="kn">import</span> <span class="nn">win32con</span>
<span class="kn">from</span> <span class="nn">natlink</span> <span class="kn">import</span> <span class="n">messagefunctions</span> <span class="c1"># only for taskbar position (left, bottom etc)</span>

<span class="n">MONITOR_INFO</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">MONITOR_HNDLES</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">BORDERX</span> <span class="o">=</span> <span class="n">BORDERY</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">VIRTUAL_SCREEN</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">NMON</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="monitor_info"><a class="viewcode-back" href="../../monitorfunctions.html#natlink.monitorfunctions.monitor_info">[docs]</a><span class="k">def</span> <span class="nf">monitor_info</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;collecting all the essential information</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># pylint: disable=W0603</span>
    <span class="k">global</span> <span class="n">MONITOR_INFO</span>
    <span class="k">global</span> <span class="n">MONITOR_HNDLES</span>
    <span class="k">global</span> <span class="n">BORDERX</span><span class="p">,</span> <span class="n">BORDERY</span>
    <span class="k">global</span> <span class="n">VIRTUAL_SCREEN</span>
    <span class="k">global</span> <span class="n">NMON</span>  <span class="c1"># number of monitors</span>
    <span class="n">NMON</span> <span class="o">=</span> <span class="n">win32api</span><span class="o">.</span><span class="n">GetSystemMetrics</span><span class="p">(</span><span class="n">win32con</span><span class="o">.</span><span class="n">SM_CMONITORS</span><span class="p">)</span>    <span class="c1"># 80</span>
    <span class="k">if</span> <span class="n">NMON</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;monitor_info: system should have at least one monitor, strange result: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span> <span class="n">NMON</span><span class="p">)</span>
    <span class="n">MONITOR_INFO</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">ALL_MONITOR_INFO</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">win32api</span><span class="o">.</span><span class="n">EnumDisplayMonitors</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">hndle</span><span class="p">,</span> <span class="n">_dummy</span><span class="p">,</span> <span class="n">_monitorRect</span> <span class="ow">in</span> <span class="n">ALL_MONITOR_INFO</span><span class="p">:</span>
        <span class="n">hndle</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">hndle</span><span class="p">)</span>
        <span class="n">MONITOR_INFO</span><span class="p">[</span><span class="n">hndle</span><span class="p">]</span> <span class="o">=</span> <span class="n">win32api</span><span class="o">.</span><span class="n">GetMonitorInfo</span><span class="p">(</span><span class="n">hndle</span><span class="p">)</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">MONITOR_INFO</span><span class="p">[</span><span class="n">hndle</span><span class="p">]</span>
        <span class="n">m</span><span class="p">[</span><span class="s1">&#39;offsetx&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="s1">&#39;Work&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="s1">&#39;Monitor&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">m</span><span class="p">[</span><span class="s1">&#39;offsety&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="s1">&#39;Work&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">m</span><span class="p">[</span><span class="s1">&#39;Monitor&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="n">MONITOR_HNDLES</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">MONITOR_INFO</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">BORDERX</span> <span class="o">=</span> <span class="n">win32api</span><span class="o">.</span><span class="n">GetSystemMetrics</span><span class="p">(</span><span class="n">win32con</span><span class="o">.</span><span class="n">SM_CXBORDER</span><span class="p">)</span>  <span class="c1"># 5</span>
    <span class="n">BORDERY</span> <span class="o">=</span> <span class="n">win32api</span><span class="o">.</span><span class="n">GetSystemMetrics</span><span class="p">(</span><span class="n">win32con</span><span class="o">.</span><span class="n">SM_CYBORDER</span><span class="p">)</span>  <span class="c1"># 6</span>
    <span class="n">VIRTUAL_SCREEN</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">VIRTUAL_SCREEN</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">win32api</span><span class="o">.</span><span class="n">GetSystemMetrics</span><span class="p">(</span><span class="n">win32con</span><span class="o">.</span><span class="n">SM_XVIRTUALSCREEN</span><span class="p">))</span>  <span class="c1"># 76</span>
    <span class="n">VIRTUAL_SCREEN</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">win32api</span><span class="o">.</span><span class="n">GetSystemMetrics</span><span class="p">(</span><span class="n">win32con</span><span class="o">.</span><span class="n">SM_YVIRTUALSCREEN</span><span class="p">))</span>  <span class="c1"># 77</span>
    <span class="n">VIRTUAL_SCREEN</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VIRTUAL_SCREEN</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">win32api</span><span class="o">.</span><span class="n">GetSystemMetrics</span><span class="p">(</span><span class="n">win32con</span><span class="o">.</span><span class="n">SM_CXVIRTUALSCREEN</span><span class="p">))</span>  <span class="c1"># 78</span>
    <span class="n">VIRTUAL_SCREEN</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VIRTUAL_SCREEN</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">win32api</span><span class="o">.</span><span class="n">GetSystemMetrics</span><span class="p">(</span><span class="n">win32con</span><span class="o">.</span><span class="n">SM_CYVIRTUALSCREEN</span><span class="p">))</span>  <span class="c1"># 79</span></div>

<div class="viewcode-block" id="getScreenRectData"><a class="viewcode-back" href="../../monitorfunctions.html#natlink.monitorfunctions.getScreenRectData">[docs]</a><span class="k">def</span> <span class="nf">getScreenRectData</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;return width, height, xmin, ymin, xmax, ymax for complete screen</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">monitor_info</span><span class="p">()</span>
    <span class="n">vs</span> <span class="o">=</span> <span class="n">VIRTUAL_SCREEN</span>
    <span class="k">return</span> <span class="n">vs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">vs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">vs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="n">vs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">vs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">vs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">vs</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">vs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span></div>

<div class="viewcode-block" id="fake_monitor_info_for_testing"><a class="viewcode-back" href="../../monitorfunctions.html#natlink.monitorfunctions.fake_monitor_info_for_testing">[docs]</a><span class="k">def</span> <span class="nf">fake_monitor_info_for_testing</span><span class="p">(</span><span class="n">nmon</span><span class="p">,</span> <span class="n">virtual_screen</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;test if changed monitor data come through in calling program</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># pylint: disable=W0603</span>
    <span class="k">global</span> <span class="n">NMON</span><span class="p">,</span> <span class="n">VIRTUAL_SCREEN</span>
    <span class="n">NMON</span> <span class="o">=</span> <span class="n">nmon</span>
    <span class="n">VIRTUAL_SCREEN</span> <span class="o">=</span> <span class="n">virtual_screen</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;fake_monitor_info_for_testing, set NMON to </span><span class="si">%s</span><span class="s1"> and VIRTUAL_SCREEN to </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span> <span class="p">(</span><span class="n">nmon</span><span class="p">,</span> <span class="n">virtual_screen</span><span class="p">))</span></div>
    
    
<span class="c1">###########################################</span>
<span class="c1"># three wrapper functions around api calls:</span>
<span class="c1">#    -MonitorFromPoint</span>
<span class="c1">#    -MonitorFromRect</span>
<span class="c1">#    -MonitorFromWindow</span>
<span class="c1"># using constant: MONITOR_DEFAULTTONEAREST</span>



<div class="viewcode-block" id="get_nearest_monitor_window"><a class="viewcode-back" href="../../monitorfunctions.html#natlink.monitorfunctions.get_nearest_monitor_window">[docs]</a><span class="k">def</span> <span class="nf">get_nearest_monitor_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;give monitor number of the monitor which is nearest to the window</span>
<span class="sd">    </span>
<span class="sd">    input:</span>
<span class="sd">      the handle of the window, most often got by:</span>
<span class="sd">      winHndle = win32gui.GetForegroundWindow()</span>
<span class="sd">               </span>
<span class="sd">    output:</span>
<span class="sd">      the monitor handle as an integer (65537, 65539 often on a 2 monitor configuration)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mon</span> <span class="o">=</span> <span class="n">win32api</span><span class="o">.</span><span class="n">MonitorFromWindow</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">win32con</span><span class="o">.</span><span class="n">MONITOR_DEFAULTTONEAREST</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">mon</span><span class="p">)</span></div>

<div class="viewcode-block" id="get_nearest_monitor_point"><a class="viewcode-back" href="../../monitorfunctions.html#natlink.monitorfunctions.get_nearest_monitor_point">[docs]</a><span class="k">def</span> <span class="nf">get_nearest_monitor_point</span><span class="p">(</span> <span class="n">point</span> <span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;give monitor number of the monitor which is nearest to the point</span>
<span class="sd">    point is a tuple (x, y) of coordinates</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mon</span> <span class="o">=</span> <span class="n">win32api</span><span class="o">.</span><span class="n">MonitorFromPoint</span><span class="p">(</span><span class="n">point</span> <span class="p">,</span> <span class="n">win32con</span><span class="o">.</span><span class="n">MONITOR_DEFAULTTONEAREST</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">mon</span><span class="p">)</span></div>

<div class="viewcode-block" id="get_other_monitors"><a class="viewcode-back" href="../../monitorfunctions.html#natlink.monitorfunctions.get_other_monitors">[docs]</a><span class="k">def</span> <span class="nf">get_other_monitors</span><span class="p">(</span><span class="n">mon</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;give list of other monitors</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mon</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">mon</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">MONITOR_HNDLES</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">monitor_info</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">MONITOR_HNDLES</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;no monitor handles found&quot;</span><span class="p">)</span>
    <span class="c1">#print &#39;mon: %s, int(mon): %s&#39;% (mon, int(mon))</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">hndle</span> <span class="k">for</span> <span class="n">hndle</span> <span class="ow">in</span> <span class="n">MONITOR_HNDLES</span> <span class="k">if</span> <span class="n">hndle</span> <span class="o">!=</span> <span class="n">mon</span><span class="p">]</span></div>
    <span class="c1">#other = [hndle for ]</span>

<div class="viewcode-block" id="get_current_monitor_rect"><a class="viewcode-back" href="../../monitorfunctions.html#natlink.monitorfunctions.get_current_monitor_rect">[docs]</a><span class="k">def</span> <span class="nf">get_current_monitor_rect</span><span class="p">(</span> <span class="n">pos</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;get rectangle positions of the foreground monitor,</span>
<span class="sd">    pass (xpos, ypos) of current mouse position</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">monitor_info</span><span class="p">()</span>
    <span class="n">mon</span> <span class="o">=</span> <span class="n">get_nearest_monitor_point</span><span class="p">(</span> <span class="n">pos</span> <span class="p">)</span>
    <span class="n">moninfo</span> <span class="o">=</span> <span class="n">MONITOR_INFO</span><span class="p">[</span><span class="n">mon</span><span class="p">]</span>
    <span class="n">rect</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">moninfo</span><span class="p">[</span><span class="s1">&#39;Monitor&#39;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">rect</span></div>
<div class="viewcode-block" id="get_current_monitor_rect_work"><a class="viewcode-back" href="../../monitorfunctions.html#natlink.monitorfunctions.get_current_monitor_rect_work">[docs]</a><span class="k">def</span> <span class="nf">get_current_monitor_rect_work</span><span class="p">(</span> <span class="n">pos</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;get rectangle positions of the foreground monitor,</span>
<span class="sd">    pass (xpos, ypos) of current mouse position</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">monitor_info</span><span class="p">()</span>
    <span class="n">mon</span> <span class="o">=</span> <span class="n">get_nearest_monitor_point</span><span class="p">(</span> <span class="n">pos</span> <span class="p">)</span>
    <span class="n">moninfo</span> <span class="o">=</span> <span class="n">MONITOR_INFO</span><span class="p">[</span><span class="n">mon</span><span class="p">]</span>
    <span class="n">rect</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">moninfo</span><span class="p">[</span><span class="s1">&#39;Work&#39;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">rect</span></div>

<div class="viewcode-block" id="get_monitor_rect"><a class="viewcode-back" href="../../monitorfunctions.html#natlink.monitorfunctions.get_monitor_rect">[docs]</a><span class="k">def</span> <span class="nf">get_monitor_rect</span><span class="p">(</span><span class="n">monitorIndex</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;get rectangle positions of indexed monitor</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">monitor_info</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">moninfo</span> <span class="o">=</span> <span class="n">MONITOR_INFO</span><span class="p">[</span><span class="n">MONITOR_HNDLES</span><span class="p">[</span><span class="n">monitorIndex</span><span class="p">]]</span>
    <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;monitorfunctions.get_monitor_rect: monitorindex not available </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span> <span class="n">monitorIndex</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="n">rect</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">moninfo</span><span class="p">[</span><span class="s1">&#39;Monitor&#39;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">rect</span></div>

<div class="viewcode-block" id="get_monitor_rect_work"><a class="viewcode-back" href="../../monitorfunctions.html#natlink.monitorfunctions.get_monitor_rect_work">[docs]</a><span class="k">def</span> <span class="nf">get_monitor_rect_work</span><span class="p">(</span><span class="n">monitorIndex</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;get rectangle positions of indexed monitor, the Work area</span>
<span class="sd">    </span>
<span class="sd">    so ignoring Dragon bar or taskbar.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">monitor_info</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">moninfo</span> <span class="o">=</span> <span class="n">MONITOR_INFO</span><span class="p">[</span><span class="n">MONITOR_HNDLES</span><span class="p">[</span><span class="n">monitorIndex</span><span class="p">]]</span>
    <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;monitorfunctions.get_monitor_rect: monitorindex not available </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span> <span class="n">monitorIndex</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="n">rect</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">moninfo</span><span class="p">[</span><span class="s1">&#39;Work&#39;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">rect</span></div>

<div class="viewcode-block" id="window_can_be_resized"><a class="viewcode-back" href="../../monitorfunctions.html#natlink.monitorfunctions.window_can_be_resized">[docs]</a><span class="k">def</span> <span class="nf">window_can_be_resized</span><span class="p">(</span><span class="n">windowHndle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;returns 1 if the window can be resized (has a maximize button)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">wstyle</span> <span class="o">=</span> <span class="n">win32api</span><span class="o">.</span><span class="n">GetWindowLong</span><span class="p">(</span><span class="n">windowHndle</span><span class="p">,</span> <span class="n">win32con</span><span class="o">.</span><span class="n">GWL_STYLE</span><span class="p">)</span>
    <span class="n">canBeResized</span> <span class="o">=</span> <span class="p">(</span><span class="n">wstyle</span> <span class="o">&amp;</span> <span class="n">win32con</span><span class="o">.</span><span class="n">WS_MAXIMIZEBOX</span> <span class="o">==</span> <span class="n">win32con</span><span class="o">.</span><span class="n">WS_MAXIMIZEBOX</span><span class="p">)</span>
    <span class="c1">#print &#39;wstyle: %x, maximizebox: %x, &#39;</span>
    <span class="k">return</span> <span class="n">canBeResized</span></div>

<div class="viewcode-block" id="get_taskbar_position"><a class="viewcode-back" href="../../monitorfunctions.html#natlink.monitorfunctions.get_taskbar_position">[docs]</a><span class="k">def</span> <span class="nf">get_taskbar_position</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;return left, top, right or bottom</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">monitor_info</span><span class="p">()</span>
    <span class="c1"># m = MONITOR_INFO</span>
    <span class="n">hApp</span> <span class="o">=</span> <span class="n">messagefunctions</span><span class="o">.</span><span class="n">findTopWindow</span><span class="p">(</span><span class="n">wantedClass</span><span class="o">=</span><span class="s1">&#39;Shell_TrayWnd&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">hApp</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;no taskbar (system tray) found&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="n">info</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">GetWindowPlacement</span><span class="p">(</span><span class="n">hApp</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">RA</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
    <span class="n">mon</span> <span class="o">=</span> <span class="n">get_nearest_monitor_window</span><span class="p">(</span><span class="n">hApp</span><span class="p">)</span>
    <span class="n">work</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">MONITOR_INFO</span><span class="p">[</span><span class="n">mon</span><span class="p">][</span><span class="s1">&#39;Work&#39;</span><span class="p">])</span>
    <span class="c1">#print &#39;RA:   %s&#39;% RA</span>
    <span class="c1">#print &#39;work: %s&#39;% work</span>
    <span class="c1"># bottom 3</span>
    <span class="c1"># right 2</span>
    <span class="c1"># top 1</span>
    <span class="c1"># left 0</span>
    <span class="k">if</span> <span class="n">RA</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">work</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">BORDERX</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;left&#39;</span>  <span class="c1"># right pos of RA == left pos of work area</span>
    <span class="k">if</span> <span class="n">RA</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">work</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">BORDERY</span><span class="p">:</span> 
        <span class="k">return</span> <span class="s1">&#39;bottom&#39;</span> <span class="c1"># top of RA == bottom of work area</span>
    <span class="k">if</span> <span class="n">RA</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">work</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">BORDERX</span><span class="p">:</span> 
        <span class="k">return</span> <span class="s1">&#39;right&#39;</span> <span class="c1"># left of RA == right of work area (account for Dragon bar)</span>
    <span class="k">if</span> <span class="n">RA</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">work</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">BORDERY</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;top&#39;</span>
    <span class="k">return</span> <span class="kc">False</span></div>

<span class="c1">#======================== on same monitor: ==========================================</span>

<div class="viewcode-block" id="restore_window"><a class="viewcode-back" href="../../monitorfunctions.html#natlink.monitorfunctions.restore_window">[docs]</a><span class="k">def</span> <span class="nf">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">monitor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">xpos</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;move window inside same monitor, restore format</span>
<span class="sd">    </span>
<span class="sd">    (for moving an amount of pixels or across the monitor border use move_window</span>
<span class="sd">     for resizing an amount of pixels, to an edge or across the monitor border use</span>
<span class="sd">    stretch_window or shrink_window)</span>
<span class="sd">    </span>
<span class="sd">    if no parameters are passed, the window is restored, but inside its</span>
<span class="sd">    working area if it fits. If it does not fit, the left top is shown.</span>

<span class="sd">    winHndle: hndle of the program</span>
<span class="sd">    monitor: hndle of the monitor (from which the monitor_info is got)</span>
<span class="sd">    xwidth, ywidth: passed to width in _get_new_coordinates_same_monitor, see there</span>
<span class="sd">    xpos, ypos: passed to position in _get_new_coordinates_same_monitor, see there</span>
<span class="sd">    keepinside: should normally be the same as the window_can_be_resized value,</span>
<span class="sd">        default taken from this function</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># pylint: disable=R0913</span>
    <span class="n">monitor_info</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">monitor</span><span class="p">:</span>
        <span class="n">monitor</span> <span class="o">=</span> <span class="n">get_nearest_monitor_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">)</span>
    <span class="n">toRestore</span> <span class="o">=</span> <span class="n">win32con</span><span class="o">.</span><span class="n">SW_RESTORE</span>
    <span class="n">info</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">GetWindowPlacement</span><span class="p">(</span><span class="n">winHndle</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">MI</span> <span class="o">=</span> <span class="n">MONITOR_INFO</span><span class="p">[</span><span class="n">monitor</span><span class="p">]</span>
    <span class="n">RA</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
    <span class="c1"># maximized =  ( info[1] == win32con.SW_SHOWMAXIMIZED)</span>
    <span class="k">if</span> <span class="n">keepinside</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">keepinside</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">window_can_be_resized</span><span class="p">(</span><span class="n">winHndle</span><span class="p">)</span>

    <span class="c1"># for non resizable windows:</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">window_can_be_resized</span><span class="p">(</span><span class="n">winHndle</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;no resize window, setting xwidth and ywidth to 0(width was: </span><span class="si">%s</span><span class="s1">, </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span>\
                <span class="p">(</span><span class="n">xwidth</span><span class="p">,</span> <span class="n">ywidth</span><span class="p">))</span>
        <span class="c1">## center in correct way:</span>
        <span class="c1">#if xwidth:</span>
        <span class="c1">#    xpos = 0.5</span>
        <span class="c1">#if not ywidth:</span>
        <span class="c1">#    ypos = 0.5</span>
        <span class="c1"># set width to non resize:</span>
        <span class="n">xwidth</span> <span class="o">=</span> <span class="n">ywidth</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1">#print &#39;maximized: %s&#39;% maximized</span>
    <span class="c1">#print &#39;previous  RA: %s&#39;% RA</span>
    <span class="n">newRA</span> <span class="o">=</span> <span class="n">_change_restore_area</span><span class="p">(</span><span class="n">RA</span><span class="p">,</span> <span class="n">monitor_info</span><span class="o">=</span><span class="n">MI</span><span class="p">,</span>
                                 <span class="n">xpos</span><span class="o">=</span><span class="n">xpos</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="n">ypos</span><span class="p">,</span>
                                 <span class="n">xwidth</span><span class="o">=</span><span class="n">xwidth</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="n">ywidth</span><span class="p">,</span>
                                 <span class="n">keepinside</span><span class="o">=</span><span class="n">keepinside</span><span class="p">)</span>
    <span class="n">info</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">toRestore</span>
    <span class="n">info</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">newRA</span><span class="p">)</span>
    <span class="n">win32gui</span><span class="o">.</span><span class="n">SetWindowPlacement</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">info</span><span class="p">)</span> <span class="p">)</span></div>
    
<div class="viewcode-block" id="move_window"><a class="viewcode-back" href="../../monitorfunctions.html#natlink.monitorfunctions.move_window">[docs]</a><span class="k">def</span> <span class="nf">move_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">direction</span><span class="p">,</span> <span class="n">amount</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;pixels&#39;</span><span class="p">,</span>
                <span class="n">keepinside</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keepinsideall</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">monitor</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;moves a window, can go across monitor borders and out of the total area</span>
<span class="sd">    </span>
<span class="sd">        :`winHndle`: hndle of the program</span>
<span class="sd">        :`monitor`:</span>
<span class="sd">          hndle of the monitor (is collected if not passed)</span>
<span class="sd">        :`direction`:</span>
<span class="sd">          - a string, left, right, up, down or</span>
<span class="sd">          - a direction in degrees (0 = up, 90 = right, 180 = down, 270 = left)</span>
<span class="sd">        :`amount`: number of pixels (for moving to left edge, use restore_window)</span>
<span class="sd">        :`keepinside`: keep inside the work area of the monitor</span>
<span class="sd">        :`keepinsideall`: keep inside the virtual area of all monitors.</span>
<span class="sd">        </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># pylint: disable=R0913</span>
    <span class="n">monitor_info</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">monitor</span><span class="p">:</span>
        <span class="n">monitor</span> <span class="o">=</span> <span class="n">get_nearest_monitor_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">)</span>
    <span class="n">toRestore</span> <span class="o">=</span> <span class="n">win32con</span><span class="o">.</span><span class="n">SW_RESTORE</span>
    <span class="n">info</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">GetWindowPlacement</span><span class="p">(</span><span class="n">winHndle</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">MI</span> <span class="o">=</span> <span class="n">MONITOR_INFO</span><span class="p">[</span><span class="n">monitor</span><span class="p">]</span>
    <span class="n">RA</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
    <span class="n">resize</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">newRA</span> <span class="o">=</span> <span class="n">_move_resize_restore_area</span><span class="p">(</span><span class="n">RA</span><span class="p">,</span> <span class="n">resize</span><span class="p">,</span> <span class="n">direction</span><span class="p">,</span> <span class="n">amount</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span>
                               <span class="n">keepinside</span><span class="o">=</span><span class="n">keepinside</span><span class="p">,</span> <span class="n">keepinsideall</span><span class="o">=</span><span class="n">keepinsideall</span><span class="p">,</span>
                               <span class="n">monitor_info</span><span class="o">=</span><span class="n">MI</span><span class="p">)</span>
    <span class="n">info</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">toRestore</span>
    <span class="n">info</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">newRA</span><span class="p">)</span>
    <span class="n">win32gui</span><span class="o">.</span><span class="n">SetWindowPlacement</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">info</span><span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="stretch_window"><a class="viewcode-back" href="../../monitorfunctions.html#natlink.monitorfunctions.stretch_window">[docs]</a><span class="k">def</span> <span class="nf">stretch_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">direction</span><span class="p">,</span> <span class="n">amount</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;pixels&#39;</span><span class="p">,</span>
                <span class="n">keepinside</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keepinsideall</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">monitor</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;resize a window, making it larger, can go across monitor borders and out of the total area</span>
<span class="sd">    </span>
<span class="sd">        winHndle: hndle of the program</span>
<span class="sd">        monitor: hdnle of the monitor (is collected if not passed)</span>
<span class="sd">        direction: a string, left, right, up, down or</span>
<span class="sd">            a direction in degrees (0 = up, 90 = right, 180 = down, 270 = left)</span>
<span class="sd">        amount: number of pixels (for moving to left edge, use restore_window)</span>
<span class="sd">        keepinside: keep inside the work area of the monitor</span>
<span class="sd">        keepinsideall: keep inside the virtual area of all monitors.</span>
<span class="sd">        </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># pylint: disable=R0913</span>
    <span class="n">monitor_info</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">monitor</span><span class="p">:</span>
        <span class="n">monitor</span> <span class="o">=</span> <span class="n">get_nearest_monitor_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">)</span>
    <span class="n">toRestore</span> <span class="o">=</span> <span class="n">win32con</span><span class="o">.</span><span class="n">SW_RESTORE</span>
    <span class="n">info</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">GetWindowPlacement</span><span class="p">(</span><span class="n">winHndle</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">MI</span> <span class="o">=</span> <span class="n">MONITOR_INFO</span><span class="p">[</span><span class="n">monitor</span><span class="p">]</span>
    <span class="n">RA</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
    <span class="n">resize</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">newRA</span> <span class="o">=</span> <span class="n">_move_resize_restore_area</span><span class="p">(</span><span class="n">RA</span><span class="p">,</span> <span class="n">resize</span><span class="p">,</span> <span class="n">direction</span><span class="p">,</span> <span class="n">amount</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span>
                               <span class="n">keepinside</span><span class="o">=</span><span class="n">keepinside</span><span class="p">,</span> <span class="n">keepinsideall</span><span class="o">=</span><span class="n">keepinsideall</span><span class="p">,</span>
                               <span class="n">monitor_info</span><span class="o">=</span><span class="n">MI</span><span class="p">)</span>
    <span class="n">info</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">toRestore</span>
    <span class="n">info</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">newRA</span><span class="p">)</span>
    <span class="n">win32gui</span><span class="o">.</span><span class="n">SetWindowPlacement</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">info</span><span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="shrink_window"><a class="viewcode-back" href="../../monitorfunctions.html#natlink.monitorfunctions.shrink_window">[docs]</a><span class="k">def</span> <span class="nf">shrink_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">direction</span><span class="p">,</span> <span class="n">amount</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;pixels&#39;</span><span class="p">,</span>
                <span class="n">keepinside</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keepinsideall</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">monitor</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;resize a window, making it smaller, can go across monitor borders and out of the total area</span>

<span class="sd">    </span>
<span class="sd">        winHndle: hndle of the program</span>
<span class="sd">        monitor: hdnle of the monitor (is collected if not passed)</span>
<span class="sd">        direction: a string, left, right, up, down or</span>
<span class="sd">            a direction in degrees (0 = up, 90 = right, 180 = down, 270 = left)</span>
<span class="sd">        amount: number of pixels (for moving to left edge, use restore_window)</span>
<span class="sd">        when shrink relative, take size of the window rather than distance to edge or corner</span>

<span class="sd">        keepinside: keep inside the work area of the monitor</span>
<span class="sd">        keepinsideall: keep inside the virtual area of all monitors.</span>
<span class="sd">        </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># pylint: disable=R0913</span>
    <span class="n">monitor_info</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">monitor</span><span class="p">:</span>
        <span class="n">monitor</span> <span class="o">=</span> <span class="n">get_nearest_monitor_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">)</span>
    <span class="n">toRestore</span> <span class="o">=</span> <span class="n">win32con</span><span class="o">.</span><span class="n">SW_RESTORE</span>
    <span class="n">info</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">GetWindowPlacement</span><span class="p">(</span><span class="n">winHndle</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">MI</span> <span class="o">=</span> <span class="n">MONITOR_INFO</span><span class="p">[</span><span class="n">monitor</span><span class="p">]</span>
    <span class="n">RA</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
    <span class="n">resize</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">newRA</span> <span class="o">=</span> <span class="n">_move_resize_restore_area</span><span class="p">(</span><span class="n">RA</span><span class="p">,</span> <span class="n">resize</span><span class="p">,</span> <span class="n">direction</span><span class="p">,</span> <span class="n">amount</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span>
                               <span class="n">keepinside</span><span class="o">=</span><span class="n">keepinside</span><span class="p">,</span> <span class="n">keepinsideall</span><span class="o">=</span><span class="n">keepinsideall</span><span class="p">,</span>
                               <span class="n">monitor_info</span><span class="o">=</span><span class="n">MI</span><span class="p">)</span>
    <span class="n">info</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">toRestore</span>
    <span class="n">info</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">newRA</span><span class="p">)</span>
    <span class="n">win32gui</span><span class="o">.</span><span class="n">SetWindowPlacement</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">info</span><span class="p">)</span> <span class="p">)</span></div>
    

<div class="viewcode-block" id="maximize_window"><a class="viewcode-back" href="../../monitorfunctions.html#natlink.monitorfunctions.maximize_window">[docs]</a><span class="k">def</span> <span class="nf">maximize_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;maximize to the monitor (it is on at the moment)&quot;&quot;&quot;</span>
    <span class="n">monitor_info</span><span class="p">()</span>
    <span class="n">toMaximize</span> <span class="o">=</span> <span class="n">win32con</span><span class="o">.</span><span class="n">SW_SHOWMAXIMIZED</span>
    <span class="n">info</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">GetWindowPlacement</span><span class="p">(</span><span class="n">winHndle</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">info</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">toMaximize</span>
    <span class="n">win32gui</span><span class="o">.</span><span class="n">SetWindowPlacement</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">info</span><span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="minimize_window"><a class="viewcode-back" href="../../monitorfunctions.html#natlink.monitorfunctions.minimize_window">[docs]</a><span class="k">def</span> <span class="nf">minimize_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;minimize the window&quot;&quot;&quot;</span>
    <span class="n">monitor_info</span><span class="p">()</span>
    <span class="n">toMinimize</span> <span class="o">=</span> <span class="n">win32con</span><span class="o">.</span><span class="n">SW_SHOWMINIMIZED</span>
    <span class="n">info</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">GetWindowPlacement</span><span class="p">(</span><span class="n">winHndle</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">info</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">toMinimize</span>
    <span class="n">win32gui</span><span class="o">.</span><span class="n">SetWindowPlacement</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">info</span><span class="p">)</span> <span class="p">)</span></div>


<span class="k">def</span> <span class="nf">_move_resize_restore_area</span><span class="p">(</span><span class="n">RestoreArea</span><span class="p">,</span> <span class="n">resize</span><span class="p">,</span> <span class="n">direction</span><span class="p">,</span> <span class="n">amount</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span>
                              <span class="n">keepinside</span><span class="p">,</span> <span class="n">keepinsideall</span><span class="p">,</span> <span class="n">monitor_info</span><span class="p">,</span> <span class="n">min_size</span><span class="o">=</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">70</span><span class="p">)</span> <span class="p">):</span> 
    <span class="sd">&quot;&quot;&quot;change the coordinates of the RA according to direction and amount</span>
<span class="sd">    </span>
<span class="sd">    the amount in combination with direction provides numerous, confusing possibilities</span>
<span class="sd">    </span>
<span class="sd">    RA: the restore area</span>
<span class="sd">    resize: 0 = move, 1 = resize in the target direction</span>
<span class="sd">                      -1 = resize away from target direction (making smaller)</span>
<span class="sd">    direction: left|right|up|down|lefttop|righttop|leftbottom|rightbottom or</span>
<span class="sd">               a number of degrees (0=up, 90=right, 180=down, 270=left)</span>
<span class="sd">    units: relative (amount between 0 and 1)|pixels|percent (of screen size)</span>
<span class="sd">    amount: 0 &lt; amount &lt;= 1: for units == relative</span>
<span class="sd">            &gt;= 1 (int): an absolute number of pixels|percent of screen size</span>
<span class="sd">    keepinside: whether to check for the window being inside after the move/resize</span>
<span class="sd">    keepinsideall: whether to check for the window being inside the virtual screen (all monitors)</span>
<span class="sd">    monitor_info: the info (dict) of the current monitor</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># pylint: disable=R0912, R0913, R0914, R0915    </span>
    <span class="n">RA</span> <span class="o">=</span> <span class="n">RestoreArea</span><span class="p">[:]</span>
    <span class="c1"># raWidth = RA[2] - RA[0]</span>
    <span class="c1"># raHeight = RA[3] - RA[1]</span>
    <span class="n">WA</span> <span class="o">=</span> <span class="n">monitor_info</span><span class="p">[</span><span class="s1">&#39;Work&#39;</span><span class="p">]</span>
    <span class="n">MA</span> <span class="o">=</span> <span class="n">monitor_info</span><span class="p">[</span><span class="s1">&#39;Monitor&#39;</span><span class="p">]</span>
    <span class="c1">#offsetx = monitor_info[&#39;offsetx&#39;]</span>
    <span class="c1">#offsety = monitor_info[&#39;offsety&#39;]</span>
    
    <span class="c1"># norm to 0 oriented</span>
    <span class="n">RA</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-=</span> <span class="n">MA</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">RA</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-=</span> <span class="n">MA</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">RA</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-=</span> <span class="n">MA</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">RA</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-=</span> <span class="n">MA</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">WAWidth</span> <span class="o">=</span> <span class="n">WA</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">WA</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">WAHeight</span> <span class="o">=</span> <span class="n">WA</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">WA</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">boundingbox</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">WAWidth</span><span class="p">,</span> <span class="n">WAHeight</span><span class="p">]</span>
    <span class="n">alpha</span><span class="p">,</span> <span class="n">distance</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;lefttop&#39;</span><span class="p">:</span>
        <span class="n">alpha</span><span class="p">,</span> <span class="n">distance</span> <span class="o">=</span> <span class="n">_get_angle_distance_side_corners</span><span class="p">(</span><span class="n">RA</span><span class="p">,</span> <span class="n">boundingbox</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;righttop&#39;</span><span class="p">:</span>
        <span class="n">alpha</span><span class="p">,</span> <span class="n">distance</span> <span class="o">=</span> <span class="n">_get_angle_distance_side_corners</span><span class="p">(</span><span class="n">RA</span><span class="p">,</span> <span class="n">boundingbox</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;leftbottom&#39;</span><span class="p">:</span>
        <span class="n">alpha</span><span class="p">,</span> <span class="n">distance</span> <span class="o">=</span> <span class="n">_get_angle_distance_side_corners</span><span class="p">(</span><span class="n">RA</span><span class="p">,</span> <span class="n">boundingbox</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;rightbottom&#39;</span><span class="p">:</span>
        <span class="n">alpha</span><span class="p">,</span> <span class="n">distance</span> <span class="o">=</span> <span class="n">_get_angle_distance_side_corners</span><span class="p">(</span><span class="n">RA</span><span class="p">,</span> <span class="n">boundingbox</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;right&#39;</span><span class="p">:</span>
        <span class="n">alpha</span><span class="p">,</span> <span class="n">distance</span> <span class="o">=</span> <span class="mi">90</span><span class="p">,</span> <span class="n">boundingbox</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">RA</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">direction</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;down&#39;</span><span class="p">,</span><span class="s1">&#39;bottom&#39;</span><span class="p">):</span>
        <span class="n">alpha</span><span class="p">,</span> <span class="n">distance</span> <span class="o">=</span> <span class="mi">180</span><span class="p">,</span> <span class="n">boundingbox</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">RA</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;left&#39;</span><span class="p">:</span>
        <span class="n">alpha</span><span class="p">,</span> <span class="n">distance</span> <span class="o">=</span> <span class="mi">270</span><span class="p">,</span> <span class="n">RA</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">boundingbox</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">direction</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="s1">&#39;up&#39;</span><span class="p">):</span>
        <span class="n">alpha</span><span class="p">,</span> <span class="n">distance</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">RA</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">boundingbox</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">direction</span>
              <span class="p">)</span> <span class="ow">in</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="n">direction</span>

    <span class="c1"># setting reverse (for making smaller)</span>
    <span class="k">if</span> <span class="n">resize</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">reverse</span> <span class="o">=</span> <span class="n">resize</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">reverse</span> <span class="o">=</span> <span class="mi">1</span>
    
    <span class="k">if</span> <span class="n">units</span> <span class="o">==</span> <span class="s1">&#39;pixels&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">alpha</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;alpha unknown, do not know where to move to&#39;</span><span class="p">)</span>
        <span class="n">deltax</span><span class="p">,</span> <span class="n">deltay</span> <span class="o">=</span> <span class="n">_get_deltax_deltay_from_angle_distance</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">amount</span><span class="p">)</span>
        <span class="n">amountx</span> <span class="o">=</span>  <span class="n">_round_float</span><span class="p">(</span><span class="n">deltax</span> <span class="o">*</span> <span class="n">reverse</span><span class="p">)</span>
        <span class="n">amounty</span> <span class="o">=</span>  <span class="n">_round_float</span><span class="p">(</span><span class="n">deltay</span> <span class="o">*</span> <span class="n">reverse</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">units</span> <span class="o">==</span> <span class="s1">&#39;relative&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">alpha</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;alpha unknown, do not know where to move to&#39;</span><span class="p">)</span>
        <span class="n">distance</span> <span class="o">=</span> <span class="n">_get_distance_in_direction</span><span class="p">(</span><span class="n">RA</span><span class="p">,</span> <span class="n">boundingbox</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>  <span class="c1">#if distance is None:</span>
        <span class="c1">#    nearest_corner, distance = </span>
        <span class="n">deltax</span><span class="p">,</span> <span class="n">deltay</span> <span class="o">=</span> <span class="n">_get_deltax_deltay_from_angle_distance</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">distance</span><span class="p">)</span>
        <span class="n">amountx</span> <span class="o">=</span> <span class="n">_round_float</span><span class="p">(</span><span class="n">deltax</span> <span class="o">*</span> <span class="n">reverse</span> <span class="o">*</span> <span class="n">amount</span><span class="p">)</span>
        <span class="n">amounty</span> <span class="o">=</span> <span class="n">_round_float</span><span class="p">(</span><span class="n">deltay</span> <span class="o">*</span> <span class="n">reverse</span> <span class="o">*</span> <span class="n">amount</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;_move_resize_restore_area: units should be &#39;relative&#39; or &#39;pixels&#39;, not &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span><span class="o">%</span> <span class="n">units</span><span class="p">)</span>
    <span class="n">side_corner</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;up&#39;</span><span class="p">:</span>
        <span class="n">side_corner</span> <span class="o">=</span> <span class="s1">&#39;top&#39;</span>
    <span class="k">elif</span> <span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;down&#39;</span><span class="p">:</span>
        <span class="n">side_corner</span> <span class="o">=</span> <span class="s1">&#39;bottom&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">side_corner</span> <span class="o">=</span> <span class="n">direction</span>
        
        
    <span class="n">RA</span> <span class="o">=</span> <span class="n">_adjust_coordinates_side_corners</span><span class="p">(</span><span class="n">RA</span><span class="p">,</span> <span class="n">amountx</span><span class="p">,</span> <span class="n">amounty</span><span class="p">,</span> <span class="n">resize</span><span class="p">,</span> <span class="n">side_corner</span><span class="o">=</span><span class="n">side_corner</span><span class="p">,</span> <span class="n">min_size</span><span class="o">=</span><span class="n">min_size</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">keepinside</span><span class="p">:</span>
        <span class="n">fixed_width</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">resize</span>
        <span class="n">RA</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">RA</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">keepinside_restore_area</span><span class="p">(</span><span class="n">RA</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">RA</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">WAWidth</span><span class="p">,</span> <span class="n">fixed_width</span><span class="o">=</span><span class="n">fixed_width</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">RA</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">RA</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">keepinside_restore_area</span><span class="p">(</span><span class="n">RA</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">RA</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">WAHeight</span><span class="p">,</span> <span class="n">fixed_width</span><span class="o">=</span><span class="n">fixed_width</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        
    <span class="c1"># correct for WA again:</span>
    <span class="n">RA</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">MA</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">RA</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">MA</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">RA</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+=</span> <span class="n">MA</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">RA</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+=</span> <span class="n">MA</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">keepinsideall</span><span class="p">:</span>
        <span class="n">fixed_width</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">resize</span> <span class="c1"># if it is a move</span>
        <span class="n">RA</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">RA</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">keepinside_all_screens</span><span class="p">(</span><span class="n">RA</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">RA</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">VIRTUAL_SCREEN</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">VIRTUAL_SCREEN</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">fixed_width</span><span class="p">)</span>
        <span class="n">RA</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">RA</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">keepinside_all_screens</span><span class="p">(</span><span class="n">RA</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">RA</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">VIRTUAL_SCREEN</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">VIRTUAL_SCREEN</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">fixed_width</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">RA</span>

<span class="k">def</span> <span class="nf">_get_distance_in_direction</span><span class="p">(</span><span class="n">RestoreArea</span><span class="p">,</span> <span class="n">boundingbox</span><span class="p">,</span> <span class="n">angle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;calculate the distance from window (restore area) to the bounding box</span>
<span class="sd">    </span>
<span class="sd">    alpha is direction to appropriate cornerpoint</span>
<span class="sd">    return distance  (0 if direction fails, distance to cornerpoint maximum)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># pylint: disable=R0911, C0321</span>
    <span class="n">RA</span> <span class="o">=</span> <span class="n">RestoreArea</span><span class="p">[:]</span>
    <span class="n">angle</span> <span class="o">=</span> <span class="n">angle</span> <span class="o">%</span> <span class="mi">360</span>
    <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">angle</span> <span class="o">&lt;</span> <span class="mi">90</span><span class="p">:</span>
        <span class="n">alpha</span><span class="p">,</span> <span class="n">distance</span> <span class="o">=</span> <span class="n">_get_angle_distance_side_corners</span><span class="p">(</span><span class="n">RA</span><span class="p">,</span> <span class="n">boundingbox</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">alpha</span> <span class="o">&lt;</span> <span class="mi">90</span><span class="p">:</span> <span class="k">return</span> <span class="mi">0</span> <span class="c1"># not same direction</span>
        <span class="n">angle</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mi">90</span> <span class="o">-</span> <span class="n">angle</span><span class="p">,</span> <span class="mi">90</span> <span class="o">-</span> <span class="n">alpha</span> <span class="c1"># for easier goniometry</span>
    <span class="k">elif</span> <span class="mi">90</span> <span class="o">&lt;=</span> <span class="n">angle</span> <span class="o">&lt;</span> <span class="mi">180</span><span class="p">:</span>
        <span class="n">alpha</span><span class="p">,</span> <span class="n">distance</span> <span class="o">=</span> <span class="n">_get_angle_distance_side_corners</span><span class="p">(</span><span class="n">RA</span><span class="p">,</span> <span class="n">boundingbox</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="mi">90</span> <span class="o">&lt;=</span> <span class="n">alpha</span> <span class="o">&lt;</span> <span class="mi">180</span><span class="p">:</span> <span class="k">return</span> <span class="mi">0</span>
        <span class="n">angle</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="n">angle</span> <span class="o">-</span> <span class="mi">90</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">-</span><span class="mi">90</span>
    <span class="k">elif</span> <span class="mi">180</span> <span class="o">&lt;=</span> <span class="n">angle</span> <span class="o">&lt;</span> <span class="mi">270</span><span class="p">:</span>
        <span class="n">alpha</span><span class="p">,</span> <span class="n">distance</span> <span class="o">=</span> <span class="n">_get_angle_distance_side_corners</span><span class="p">(</span><span class="n">RA</span><span class="p">,</span> <span class="n">boundingbox</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="mi">180</span> <span class="o">&lt;=</span> <span class="n">alpha</span> <span class="o">&lt;</span> <span class="mi">270</span><span class="p">:</span> <span class="k">return</span> <span class="mi">0</span>
        <span class="n">angle</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mi">270</span> <span class="o">-</span> <span class="n">angle</span><span class="p">,</span> <span class="mi">270</span> <span class="o">-</span> <span class="n">alpha</span>
    <span class="k">elif</span> <span class="mi">270</span> <span class="o">&lt;=</span> <span class="n">angle</span> <span class="o">&lt;=</span> <span class="mi">360</span><span class="p">:</span>
        <span class="n">alpha</span><span class="p">,</span> <span class="n">distance</span> <span class="o">=</span> <span class="n">_get_angle_distance_side_corners</span><span class="p">(</span><span class="n">RA</span><span class="p">,</span> <span class="n">boundingbox</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="mi">270</span> <span class="o">&lt;=</span> <span class="n">alpha</span>  <span class="o">&lt;</span> <span class="mi">360</span><span class="p">:</span> <span class="k">return</span> <span class="mi">0</span> <span class="c1"># not same direction</span>
        <span class="n">angle</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="n">angle</span> <span class="o">-</span> <span class="mi">270</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">-</span> <span class="mi">270</span> <span class="c1"># for easier goniometry</span>
    
    <span class="k">if</span> <span class="n">angle</span> <span class="o">==</span> <span class="n">alpha</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">distance</span>
    <span class="k">if</span> <span class="n">angle</span> <span class="o">&lt;</span> <span class="n">alpha</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">distance</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">alpha</span><span class="p">))</span><span class="o">/</span><span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">angle</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">distance</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">alpha</span><span class="p">))</span><span class="o">/</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">angle</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">_round_float</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;round to integer</span>
<span class="sd">&gt;&gt;&gt; _round_float(0)</span>
<span class="sd">0</span>
<span class="sd">&gt;&gt;&gt; _round_float(0.4)</span>
<span class="sd">0</span>
<span class="sd">&gt;&gt;&gt; _round_float(0.5)</span>
<span class="sd">1</span>
<span class="sd">&gt;&gt;&gt; _round_float(-0.5)</span>
<span class="sd">-1</span>
<span class="sd">&gt;&gt;&gt; _round_float(-1.9)</span>
<span class="sd">-2</span>
<span class="sd">&gt;&gt;&gt; _round_float(1.9999999999999999)</span>
<span class="sd">2</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">f</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">f</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">f</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">f</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span>
    <span class="k">return</span> <span class="mi">0</span>

<span class="k">def</span> <span class="nf">_get_angle_distance_side_corners</span><span class="p">(</span><span class="n">RA</span><span class="p">,</span> <span class="n">boundingbox</span><span class="p">,</span> <span class="n">xindex</span><span class="p">,</span> <span class="n">yindex</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;return angle and distance of RA point and WA point</span>
<span class="sd">       give RA and WA and:</span>
<span class="sd">        xindex: 0 left, 1 right</span>
<span class="sd">        yindex: 0 top, 1 bottom</span>
<span class="sd">        </span>
<span class="sd">    return (alpha (in degrees), distance (in pixels))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bb</span> <span class="o">=</span> <span class="n">boundingbox</span> <span class="c1">##(should be [0, 0, widhtofWA, heightofWA])</span>
    <span class="k">if</span> <span class="n">xindex</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">yindex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_get_angle_distance</span><span class="p">(</span> <span class="n">RA</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">RA</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">bb</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">bb</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">xindex</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">yindex</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_get_angle_distance</span><span class="p">(</span> <span class="n">RA</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">RA</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">bb</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">bb</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">xindex</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">yindex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_get_angle_distance</span><span class="p">(</span> <span class="n">RA</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">RA</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">bb</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">bb</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">xindex</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">yindex</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_get_angle_distance</span><span class="p">(</span> <span class="n">RA</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">RA</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">bb</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">bb</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;_get_angle_distance_side_corners: invalid parameters xindex (</span><span class="si">%s</span><span class="s2">), yindex (</span><span class="si">%s</span><span class="s2">) (should be 0 or 1)&quot;</span><span class="o">%</span>
                     <span class="p">(</span><span class="n">xindex</span><span class="p">,</span> <span class="n">yindex</span><span class="p">))</span>
        
<span class="k">def</span> <span class="nf">_get_angle_distance</span><span class="p">(</span><span class="n">px</span><span class="p">,</span> <span class="n">py</span><span class="p">,</span> <span class="n">qx</span><span class="p">,</span> <span class="n">qy</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;calculate angle and distance of two points</span>
<span class="sd">    px, py: (pixel) coordinates of first point (corner of window)</span>
<span class="sd">    qx, qy: (pixel) coordinates of second point (corner of monitor)</span>
<span class="sd">    return: (angle, dist)</span>
<span class="sd">            angle (in degrees) up = 0, right = 90 etc, viewed from p to q</span>
<span class="sd">            dist: pixels () (rounded to int)</span>
<span class="sd">(see unittestMonitorfunctions for more tests)</span>
<span class="sd">#&gt;&gt;&gt; _get_angle_distance(20, 100, 0, 0)# fourth quadrant</span>
<span class="sd">#(348.69, 101.98)</span>
<span class="sd">#&gt;&gt;&gt; _get_angle_distance(0, 100, 0, 0)# point up</span>
<span class="sd">#(0, 100.0)</span>
<span class="sd">#&gt;&gt;&gt; _get_angle_distance(300, 600, 1000, 600)# point right</span>
<span class="sd">#(90, 700.0)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># pylint: disable=R0912, R1716</span>
    <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">qx</span><span class="o">-</span><span class="n">px</span><span class="p">,</span> <span class="n">qy</span><span class="o">-</span><span class="n">py</span>
    <span class="n">dist</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">dx</span><span class="o">*</span><span class="n">dx</span> <span class="o">+</span> <span class="n">dy</span><span class="o">*</span><span class="n">dy</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">dx</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">dy</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dy</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="mi">180</span><span class="p">,</span> <span class="n">dist</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dist</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">dy</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">dx</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="n">dist</span><span class="p">)</span>
        <span class="c1"># dx &lt; 0</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">270</span><span class="p">,</span> <span class="n">dist</span><span class="p">)</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">atan</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">fabs</span><span class="p">(</span><span class="mf">1.0</span><span class="o">*</span><span class="n">dy</span><span class="o">/</span><span class="n">dx</span><span class="p">)))</span>
    <span class="k">if</span> <span class="n">dx</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">dy</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># first quadrant</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="mi">90</span> <span class="o">-</span> <span class="n">alpha</span>
    <span class="k">elif</span> <span class="n">dx</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">dy</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># second quadrant</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="mi">90</span> <span class="o">+</span> <span class="n">alpha</span>
    <span class="k">elif</span> <span class="n">dx</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">dy</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># third quadrant</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="mi">270</span> <span class="o">-</span> <span class="n">alpha</span>
    <span class="k">elif</span> <span class="n">dx</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">dy</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># fourth quadrant</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="mi">270</span> <span class="o">+</span> <span class="n">alpha</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;impossible to come here&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">dist</span>
  
<span class="k">def</span> <span class="nf">_get_deltax_deltay_from_angle_distance</span><span class="p">(</span><span class="n">angle</span><span class="p">,</span> <span class="n">distance</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;calculates &quot;back&quot; the px - py and qx - qy from _get_angle_distance</span>

<span class="sd">#&gt;&gt;&gt; angle, distance = _get_angle_distance(20, 100, 0, 0)# fourth quadrant</span>
<span class="sd">#&gt;&gt;&gt; angle, distance</span>
<span class="sd">#(348.69, 101.98)</span>
<span class="sd">#&gt;&gt;&gt; _get_deltax_deltay_from_angle_distance(angle, distance)</span>
<span class="sd">#(-20, 99.99999)</span>
<span class="sd">#</span>
<span class="sd">#&gt;&gt;&gt; angle, distance = _get_angle_distance(300, 600, 1000, 600)# point right</span>
<span class="sd">#&gt;&gt;&gt; angle, distance</span>
<span class="sd">#(90, 700.0)</span>
<span class="sd">#&gt;&gt;&gt; _get_deltax_deltay_from_angle_distance(angle, distance)</span>
<span class="sd">#(700.0, 0)</span>
<span class="sd">test with unittestMonitorfunctions)</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">angle</span>
    <span class="n">deltax</span> <span class="o">=</span> <span class="n">distance</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">alpha</span><span class="p">))</span> 
    <span class="n">deltay</span> <span class="o">=</span> <span class="o">-</span> <span class="n">distance</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">alpha</span><span class="p">))</span> 
    <span class="k">return</span> <span class="n">deltax</span><span class="p">,</span> <span class="n">deltay</span>
    
<span class="k">def</span> <span class="nf">_adjust_coordinates_side_corners</span><span class="p">(</span><span class="n">RestoreArea</span><span class="p">,</span> <span class="n">amountx</span><span class="p">,</span> <span class="n">amounty</span><span class="p">,</span> <span class="n">resize</span><span class="p">,</span> <span class="n">side_corner</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">min_size</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">70</span><span class="p">)):</span>
    <span class="sd">&quot;&quot;&quot;adjust RestoreArea in the wanted direction</span>
<span class="sd">       give RA</span>
<span class="sd">        amountx and amounty (can be negative)</span>
<span class="sd">                eg amountx = -5 means go left 5, resize == 1 doing on left side (larger)</span>
<span class="sd">                                                 resize == -1 doing on right side (smaller)</span>
<span class="sd">                                                (resize false: does not matter where)</span>
<span class="sd">        resize (include the other point)</span>
<span class="sd">                resize = 0(None): move, also change the opposite point</span>
<span class="sd">                resize = 1: make larger (see note below)</span>
<span class="sd">                resize = -1: make smaller (only relevant if side_corner is NOT given)</span>
<span class="sd">        side_corner in lefttop, righttop leftbottom rightbottom or</span>
<span class="sd">                       left right up down or center or None</span>
<span class="sd">                (note: if side_corner is given, a resize (if given) is always into the</span>
<span class="sd">                    direction with respect to side_corner, so smaller/larger is not controlled by</span>
<span class="sd">                    resize)</span>
<span class="sd">            (assume amount points in correct direction)</span>
<span class="sd">       resize: 0 = cannot resize (move)</span>
<span class="sd">       min_size (in case of resize, minimum size of width/height)</span>
<span class="sd">        </span>
<span class="sd">    returns adjusted RA</span>
<span class="sd">    </span>
<span class="sd">(see unittestMonitorfunctions for tests)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># pylint: disable=R0912, R0913, R0915</span>
    <span class="n">RA</span> <span class="o">=</span> <span class="n">RestoreArea</span><span class="p">[:]</span>
    <span class="n">validvaluesside_corner</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;rightbottom&#39;</span><span class="p">,</span> <span class="s1">&#39;righttop&#39;</span><span class="p">,</span> <span class="s1">&#39;leftbottom&#39;</span><span class="p">,</span> <span class="s1">&#39;lefttop&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="s1">&#39;bottom&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;leftcenter&#39;</span><span class="p">,</span> <span class="s1">&#39;rightcenter&#39;</span><span class="p">,</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;centertop&#39;</span><span class="p">,</span> <span class="s1">&#39;centerbottom&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">side_corner</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">resize</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">reverse</span> <span class="o">=</span> <span class="n">resize</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">reverse</span> <span class="o">=</span> <span class="mi">1</span>
            
        <span class="k">if</span> <span class="n">amountx</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">amounty</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">RA</span>  <span class="c1"># no changes to be expected</span>
            <span class="k">if</span> <span class="n">amounty</span> <span class="o">*</span> <span class="n">reverse</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">side_corner</span> <span class="o">=</span> <span class="s1">&#39;bottom&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># amounty &lt; 0:</span>
                <span class="n">side_corner</span> <span class="o">=</span> <span class="s1">&#39;top&#39;</span>
        <span class="k">elif</span> <span class="n">amountx</span> <span class="o">*</span> <span class="n">reverse</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">amounty</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">side_corner</span> <span class="o">=</span> <span class="s1">&#39;right&#39;</span>
            <span class="k">elif</span> <span class="n">amounty</span> <span class="o">*</span> <span class="n">reverse</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">side_corner</span> <span class="o">=</span> <span class="s1">&#39;rightbottom&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># amounty &lt; 0:</span>
                <span class="n">side_corner</span> <span class="o">=</span> <span class="s1">&#39;righttop&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># amountx * reverse negative</span>
            <span class="k">if</span> <span class="n">amounty</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">side_corner</span> <span class="o">=</span> <span class="s1">&#39;left&#39;</span>
            <span class="k">elif</span> <span class="n">amounty</span> <span class="o">*</span> <span class="n">reverse</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">side_corner</span> <span class="o">=</span> <span class="s1">&#39;leftbottom&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># amounty &lt; 0:</span>
                <span class="n">side_corner</span> <span class="o">=</span> <span class="s1">&#39;lefttop&#39;</span>


    <span class="k">if</span> <span class="n">side_corner</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">validvaluesside_corner</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;side_corner (&#39;</span><span class="si">%s</span><span class="s2">&#39;) should be one of the valid values: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span>
                         <span class="p">(</span><span class="n">side_corner</span><span class="p">,</span> <span class="n">validvaluesside_corner</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">resize</span> <span class="ow">and</span> <span class="n">resize</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">True</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;resize (&#39;</span><span class="si">%s</span><span class="s2">&#39;) should be false, or True, 1 (larger) or -1 (smaller)&quot;</span><span class="o">%</span> <span class="n">resize</span><span class="p">)</span>
        
    <span class="k">if</span> <span class="n">amountx</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">side_corner</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;lefttop&#39;</span><span class="p">,</span> <span class="s1">&#39;leftbottom&#39;</span><span class="p">,</span> <span class="s1">&#39;left&#39;</span><span class="p">):</span>
            <span class="n">RA</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">amountx</span>
            <span class="k">if</span> <span class="n">resize</span><span class="p">:</span>
                <span class="c1"># allow for minimum size of result:</span>
                <span class="n">RA</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">RA</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">RA</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">min_size</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">RA</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+=</span> <span class="n">amountx</span>
        <span class="k">elif</span> <span class="n">side_corner</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;centertop&#39;</span><span class="p">,</span> <span class="s1">&#39;centerbottom&#39;</span><span class="p">,</span> <span class="s1">&#39;center&#39;</span><span class="p">):</span>
            <span class="c1"># resize not relevant</span>
            <span class="n">left</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">amountx</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">right</span> <span class="o">=</span> <span class="n">amountx</span> <span class="o">-</span> <span class="n">left</span>
            <span class="n">RA</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-=</span> <span class="n">left</span>
            <span class="n">RA</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+=</span> <span class="n">right</span>
        <span class="k">else</span><span class="p">:</span>           
            <span class="n">RA</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+=</span> <span class="n">amountx</span>
            <span class="k">if</span> <span class="n">resize</span><span class="p">:</span>
                <span class="n">RA</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">RA</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">min_size</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">RA</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">RA</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">amountx</span>

    <span class="k">if</span> <span class="n">amounty</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">side_corner</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;lefttop&#39;</span><span class="p">,</span> <span class="s1">&#39;righttop&#39;</span><span class="p">,</span> <span class="s1">&#39;top&#39;</span><span class="p">):</span>
            <span class="c1"># doing y upwards:</span>
            <span class="n">RA</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">amounty</span>
            <span class="k">if</span> <span class="n">resize</span><span class="p">:</span>
                <span class="n">RA</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">RA</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">RA</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="n">min_size</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">RA</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+=</span> <span class="n">amounty</span>
        <span class="k">elif</span> <span class="n">side_corner</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;leftcenter&#39;</span><span class="p">,</span> <span class="s1">&#39;rightcenter&#39;</span><span class="p">,</span> <span class="s1">&#39;center&#39;</span><span class="p">):</span>
            <span class="c1"># resize not relevant</span>
            <span class="n">up</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">amounty</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">down</span> <span class="o">=</span> <span class="n">amounty</span> <span class="o">-</span> <span class="n">right</span>
            <span class="n">RA</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-=</span> <span class="n">up</span>
            <span class="n">RA</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+=</span> <span class="n">down</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># doing y downwards</span>
            <span class="n">RA</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+=</span> <span class="n">amounty</span>
            <span class="k">if</span> <span class="n">resize</span><span class="p">:</span>
                <span class="n">RA</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">RA</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">min_size</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">RA</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">RA</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">amounty</span>

    <span class="k">return</span> <span class="n">RA</span>

        
<span class="k">def</span> <span class="nf">_change_restore_area</span><span class="p">(</span><span class="n">RA</span><span class="p">,</span> <span class="n">monitor_info</span><span class="p">,</span> <span class="n">xwidth</span><span class="p">,</span> <span class="n">ywidth</span><span class="p">,</span>
                            <span class="n">xpos</span><span class="p">,</span> <span class="n">ypos</span><span class="p">,</span> <span class="n">keepinside</span><span class="p">):</span> 
    <span class="sd">&quot;&quot;&quot;change the placing or the RA in the same monitor</span>
<span class="sd">     for parameters, see restore_window above and</span>
<span class="sd">     _get_new_coordinates_same_monitor below</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># pylint: disable=R0913</span>
    <span class="c1"># raWidth = RA[2] - RA[0]</span>
    <span class="c1"># raHeight = RA[3] - RA[1]</span>
    <span class="n">WA</span> <span class="o">=</span> <span class="n">monitor_info</span><span class="p">[</span><span class="s1">&#39;Work&#39;</span><span class="p">]</span>
    <span class="n">MA</span> <span class="o">=</span> <span class="n">monitor_info</span><span class="p">[</span><span class="s1">&#39;Monitor&#39;</span><span class="p">]</span>
    <span class="c1">#offsetx = monitor_info[&#39;offsetx&#39;]</span>
    <span class="c1">#offsety = monitor_info[&#39;offsety&#39;]</span>
    
    <span class="c1"># norm to 0 oriented</span>
    <span class="n">RA</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-=</span> <span class="n">MA</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">RA</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-=</span> <span class="n">MA</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">RA</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-=</span> <span class="n">MA</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">RA</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-=</span> <span class="n">MA</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">WAWidth</span> <span class="o">=</span> <span class="n">WA</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">WA</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">WAHeight</span> <span class="o">=</span> <span class="n">WA</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">WA</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="n">RA</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">RA</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">_get_new_coordinates_same_monitor</span><span class="p">(</span><span class="n">begin</span><span class="o">=</span><span class="n">RA</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">end</span><span class="o">=</span><span class="n">RA</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="n">WAWidth</span><span class="p">,</span>
                                                    <span class="n">width</span><span class="o">=</span><span class="n">xwidth</span><span class="p">,</span> <span class="n">positioning</span><span class="o">=</span><span class="n">xpos</span><span class="p">)</span>
    <span class="n">RA</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">RA</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">_get_new_coordinates_same_monitor</span><span class="p">(</span><span class="n">begin</span><span class="o">=</span><span class="n">RA</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">end</span><span class="o">=</span><span class="n">RA</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="n">WAHeight</span><span class="p">,</span>
                                                    <span class="n">width</span><span class="o">=</span><span class="n">ywidth</span><span class="p">,</span> <span class="n">positioning</span><span class="o">=</span><span class="n">ypos</span><span class="p">)</span>

    <span class="n">fixed_width</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">keepinside</span>
    <span class="n">RA</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">RA</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">keepinside_restore_area</span><span class="p">(</span><span class="n">RA</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">RA</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">WAWidth</span><span class="p">,</span> <span class="n">fixed_width</span><span class="o">=</span><span class="n">fixed_width</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">RA</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">RA</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">keepinside_restore_area</span><span class="p">(</span><span class="n">RA</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">RA</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">WAHeight</span><span class="p">,</span> <span class="n">fixed_width</span><span class="o">=</span><span class="n">fixed_width</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># correct for WA again:</span>
    <span class="n">RA</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">MA</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">RA</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">MA</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">RA</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+=</span> <span class="n">MA</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">RA</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+=</span> <span class="n">MA</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="k">return</span> <span class="n">RA</span>

<span class="k">def</span> <span class="nf">_get_new_coordinates_same_monitor</span><span class="p">(</span><span class="n">begin</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">positioning</span><span class="p">,</span> <span class="n">minWidth</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;sqeeze or make larger  the coordinates of the window in either direction</span>
<span class="sd">    </span>
<span class="sd">    think in width here:</span>
<span class="sd">    begin, end, actual coordinates with respect to left or top of</span>
<span class="sd">        actual monitor </span>
<span class="sd">    size: allowed size of the work area (width of height)</span>
<span class="sd">    width: if false (None or 0) the same width is taken</span>
<span class="sd">           if 1: size is taken</span>
<span class="sd">           if &lt; 1 (and &gt; 0, assumed) this part of the size is taken</span>
<span class="sd">    </span>
<span class="sd">    positioning: give the wanted position on the monitor:</span>
<span class="sd">        None: do nothing, leave begin</span>
<span class="sd">        &#39;left&#39;, &#39;up&#39;: move to begin</span>
<span class="sd">        &#39;right&#39;, &#39;down&#39;: move to end</span>
<span class="sd">        &#39;center&#39;: center on the size</span>
<span class="sd">        &#39;relative&#39;: take the same spacing left and right as before the width change</span>
<span class="sd">        a number between 0 and 1 (inclusive): calculate the left and right spacing</span>
<span class="sd">            according to this number</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># pylint: disable=R0912, R0913,  </span>
    <span class="n">oldwidth</span> <span class="o">=</span> <span class="n">end</span> <span class="o">-</span> <span class="n">begin</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">width</span><span class="p">:</span>
        <span class="n">width</span> <span class="o">=</span> <span class="n">end</span> <span class="o">-</span> <span class="n">begin</span>
    <span class="k">elif</span> <span class="n">width</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># take size of monitor, positioning parameter irrelevant:</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="n">size</span>
    <span class="k">elif</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">width</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">width</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">size</span> <span class="o">*</span> <span class="n">width</span><span class="p">)</span>  <span class="c1"># 0.5 takes half the screen</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;get_new_coordinates_same_monitor, illogical value for width: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span> <span class="n">width</span><span class="p">)</span>
    <span class="n">width</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">minWidth</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">positioning</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">begin</span><span class="p">,</span> <span class="n">begin</span> <span class="o">+</span> <span class="n">width</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">positioning</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        
        <span class="k">if</span> <span class="n">positioning</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;up&#39;</span><span class="p">):</span>
            <span class="n">positioning</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">elif</span> <span class="n">positioning</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="s1">&#39;down&#39;</span><span class="p">):</span>
            <span class="n">positioning</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">positioning</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;center&#39;</span><span class="p">,):</span>
            <span class="n">positioning</span> <span class="o">=</span> <span class="mf">0.5</span>
        <span class="k">elif</span> <span class="n">positioning</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;relative&#39;</span><span class="p">,):</span>
            <span class="c1"># relative to old spacing</span>
            <span class="n">oldspacing</span> <span class="o">=</span> <span class="n">size</span> <span class="o">-</span> <span class="n">oldwidth</span>
            <span class="c1"># newspacing = max(size - width, 0)</span>
            <span class="k">if</span> <span class="n">oldspacing</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">positioning</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">*</span> <span class="n">begin</span> <span class="o">/</span> <span class="n">oldspacing</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">positioning</span> <span class="o">=</span> <span class="mf">0.5</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;_get_new_coordinates_same_monitor: invalid positioning option: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span> <span class="n">positioning</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">positioning</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">positioning</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;get_new_coordinates_same_monitor: positioning number, should be between 0 and 1 (inclusive), not: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span> <span class="n">positioning</span><span class="p">)</span>
    <span class="n">spacing</span> <span class="o">=</span> <span class="nb">max</span><span class="p">((</span><span class="n">size</span> <span class="o">-</span> <span class="n">width</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">left</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">spacing</span> <span class="o">*</span> <span class="n">positioning</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">left</span><span class="p">,</span> <span class="n">left</span> <span class="o">+</span> <span class="n">width</span>

<div class="viewcode-block" id="keepinside_all_screens"><a class="viewcode-back" href="../../monitorfunctions.html#natlink.monitorfunctions.keepinside_all_screens">[docs]</a><span class="k">def</span> <span class="nf">keepinside_all_screens</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">virtL</span><span class="p">,</span> <span class="n">virtR</span><span class="p">,</span> <span class="n">fixed_width</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;keep inside the virtual screen, allow for border</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    (horizontal and vertical called separate</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># pylint: disable=R0913</span>
    <span class="k">if</span> <span class="n">left</span> <span class="o">&lt;</span> <span class="n">virtL</span> <span class="o">-</span> <span class="n">border</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">fixed_width</span><span class="p">:</span>
            <span class="n">right</span> <span class="o">+=</span> <span class="n">virtL</span> <span class="o">-</span> <span class="n">left</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">right</span> <span class="o">&gt;</span> <span class="n">virtR</span> <span class="o">+</span> <span class="n">border</span><span class="p">:</span>
                <span class="n">right</span> <span class="o">=</span> <span class="n">virtR</span> <span class="o">+</span> <span class="n">border</span>
        <span class="n">left</span> <span class="o">=</span> <span class="n">virtL</span> <span class="o">-</span> <span class="n">border</span>
    <span class="k">if</span> <span class="n">right</span> <span class="o">&gt;</span> <span class="n">virtR</span> <span class="o">+</span> <span class="n">border</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">fixed_width</span><span class="p">:</span>
            <span class="n">left</span> <span class="o">-=</span> <span class="n">right</span> <span class="o">-</span> <span class="n">virtR</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">left</span> <span class="o">&lt;</span> <span class="n">virtL</span> <span class="o">-</span> <span class="n">border</span><span class="p">:</span>
                <span class="n">left</span> <span class="o">=</span> <span class="n">virtL</span> <span class="o">-</span> <span class="n">border</span>
        <span class="n">right</span> <span class="o">=</span> <span class="n">virtR</span> <span class="o">+</span> <span class="n">border</span>
    <span class="k">return</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span></div>

<div class="viewcode-block" id="keepinside_restore_area"><a class="viewcode-back" href="../../monitorfunctions.html#natlink.monitorfunctions.keepinside_restore_area">[docs]</a><span class="k">def</span> <span class="nf">keepinside_restore_area</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">fixed_width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;adjust (restore)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">span</span> <span class="o">=</span> <span class="n">right</span> <span class="o">-</span> <span class="n">left</span>
    <span class="k">if</span> <span class="o">-</span><span class="n">margin</span> <span class="o">&lt;</span> <span class="n">left</span> <span class="o">&lt;</span> <span class="n">right</span> <span class="o">&lt;</span> <span class="n">size</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span>
    <span class="k">if</span> <span class="n">fixed_width</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">left</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">margin</span> <span class="ow">or</span> <span class="n">span</span> <span class="o">&gt;</span> <span class="n">size</span> <span class="o">+</span> <span class="n">margin</span><span class="o">*</span><span class="mi">2</span><span class="p">:</span>
            <span class="n">left</span> <span class="o">=</span> <span class="o">-</span><span class="n">margin</span>
            <span class="n">right</span> <span class="o">=</span> <span class="n">span</span> <span class="o">-</span> <span class="n">margin</span>
        <span class="k">elif</span> <span class="n">right</span> <span class="o">&gt;</span> <span class="n">size</span> <span class="o">+</span> <span class="n">margin</span><span class="p">:</span>
            <span class="n">right</span> <span class="o">=</span> <span class="n">size</span> <span class="o">+</span> <span class="n">margin</span>
            <span class="n">left</span> <span class="o">=</span> <span class="n">right</span> <span class="o">-</span> <span class="n">span</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># width may alter, adjust to possibilities of monitor</span>
        <span class="k">if</span> <span class="n">left</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">margin</span> <span class="ow">or</span> <span class="n">span</span> <span class="o">&gt;</span> <span class="n">size</span> <span class="o">+</span> <span class="n">margin</span><span class="o">*</span><span class="mi">2</span><span class="p">:</span>
            <span class="n">left</span> <span class="o">=</span> <span class="o">-</span><span class="n">margin</span>
            <span class="n">right</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">left</span><span class="o">+</span><span class="n">span</span><span class="p">,</span> <span class="n">size</span><span class="o">+</span><span class="n">margin</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">right</span> <span class="o">&gt;</span> <span class="n">size</span> <span class="o">+</span> <span class="n">margin</span><span class="p">:</span>
            <span class="n">right</span> <span class="o">=</span> <span class="n">size</span> <span class="o">+</span> <span class="n">margin</span>
            <span class="n">left</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">right</span><span class="o">-</span><span class="n">span</span><span class="p">,</span> <span class="o">-</span><span class="n">margin</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span></div>
            

<span class="c1">#===================== more monitors: ===============================================</span>
<div class="viewcode-block" id="move_to_monitor"><a class="viewcode-back" href="../../monitorfunctions.html#natlink.monitorfunctions.move_to_monitor">[docs]</a><span class="k">def</span> <span class="nf">move_to_monitor</span><span class="p">(</span><span class="n">hndle</span><span class="p">,</span> <span class="n">monitor</span><span class="p">,</span> <span class="n">currentMon</span><span class="p">,</span> <span class="n">resize</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;move window with hndle to monitor with hndle monitor</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># pylint: disable=R0914</span>
    <span class="n">monitor_info</span><span class="p">()</span>
    
    <span class="c1"># toMin = win32con.SW_SHOWMINIMIZED</span>
    <span class="n">toMax</span> <span class="o">=</span> <span class="n">win32con</span><span class="o">.</span><span class="n">SW_SHOWMAXIMIZED</span>
    <span class="n">toRestore</span> <span class="o">=</span> <span class="n">win32con</span><span class="o">.</span><span class="n">SW_RESTORE</span>
    <span class="n">info</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">GetWindowPlacement</span><span class="p">(</span><span class="n">hndle</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">MInew</span> <span class="o">=</span> <span class="n">MONITOR_INFO</span><span class="p">[</span><span class="n">monitor</span><span class="p">]</span>
    <span class="n">MIcur</span> <span class="o">=</span> <span class="n">MONITOR_INFO</span><span class="p">[</span><span class="n">currentMon</span><span class="p">]</span>
    <span class="n">RA</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
    <span class="n">maximized</span> <span class="o">=</span>  <span class="p">(</span> <span class="n">info</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">win32con</span><span class="o">.</span><span class="n">SW_SHOWMAXIMIZED</span><span class="p">)</span>
    <span class="n">newRA</span> <span class="o">=</span> <span class="n">correct_restore_area</span><span class="p">(</span><span class="n">RA</span><span class="p">,</span> <span class="n">monitor_info_new</span><span class="o">=</span><span class="n">MInew</span><span class="p">,</span>
                                 <span class="n">monitor_info_old</span><span class="o">=</span><span class="n">MIcur</span><span class="p">,</span>
                                 <span class="n">resize</span><span class="o">=</span><span class="n">resize</span><span class="p">,</span>
                                 <span class="n">keepinside</span><span class="o">=</span><span class="n">resize</span><span class="p">)</span>  
    <span class="n">info</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">toRestore</span>
    <span class="k">if</span> <span class="n">maximized</span><span class="p">:</span>
        <span class="n">offsetx</span> <span class="o">=</span> <span class="n">MInew</span><span class="p">[</span><span class="s1">&#39;offsetx&#39;</span><span class="p">]</span>
        <span class="n">offsety</span> <span class="o">=</span> <span class="n">MInew</span><span class="p">[</span><span class="s1">&#39;offsety&#39;</span><span class="p">]</span>
        <span class="n">work</span> <span class="o">=</span> <span class="n">MInew</span><span class="p">[</span><span class="s1">&#39;Work&#39;</span><span class="p">]</span>

        <span class="c1"># set RA temp to place where maximized window will come as well:</span>
        <span class="n">info</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">work</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">offsetx</span><span class="o">-</span><span class="n">BORDERX</span><span class="p">,</span> <span class="n">work</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">offsety</span><span class="o">-</span><span class="n">BORDERY</span><span class="p">,</span> <span class="n">work</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">offsetx</span><span class="o">+</span><span class="n">BORDERX</span><span class="p">,</span> <span class="n">work</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="n">offsety</span><span class="o">+</span><span class="n">BORDERY</span><span class="p">)</span>
        <span class="n">info</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">toRestore</span>
        <span class="c1"># set to restore in new maximized coordinates:</span>
        <span class="n">win32gui</span><span class="o">.</span><span class="n">SetWindowPlacement</span><span class="p">(</span><span class="n">hndle</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">info</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">info</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">toMax</span>
        <span class="n">info</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">newRA</span><span class="p">)</span>
        <span class="c1"># set to max, with new calculated restore parameters:</span>
        <span class="n">win32gui</span><span class="o">.</span><span class="n">SetWindowPlacement</span><span class="p">(</span><span class="n">hndle</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">info</span><span class="p">)</span> <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">info</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">newRA</span><span class="p">)</span>
        <span class="n">win32gui</span><span class="o">.</span><span class="n">SetWindowPlacement</span><span class="p">(</span><span class="n">hndle</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">info</span><span class="p">)</span> <span class="p">)</span></div>
 
<div class="viewcode-block" id="correct_restore_area"><a class="viewcode-back" href="../../monitorfunctions.html#natlink.monitorfunctions.correct_restore_area">[docs]</a><span class="k">def</span> <span class="nf">correct_restore_area</span><span class="p">(</span><span class="n">RA</span><span class="p">,</span> <span class="n">monitor_info_new</span><span class="p">,</span> <span class="n">monitor_info_old</span><span class="p">,</span>
                         <span class="n">resize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;place RA inside the newWA, preserving relative position as much as possible (other monitor)</span>
<span class="sd">    </span>
<span class="sd">    input: restore_area (RA) in &#39;Work&#39; coordinates</span>
<span class="sd">           info of monitor_info_new and monitor_info_old</span>
<span class="sd">           resize: resize relative to previous if true, keep size if false.</span>
<span class="sd">           keepinside: keep the window inside the work area of the monitor (normally when resize = true)</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># pylint: disable=R0914, W0613</span>
    <span class="c1"># raWidth = RA[2] - RA[0]</span>
    <span class="c1"># raHeight = RA[3] - RA[1]</span>
    <span class="n">oldWA</span> <span class="o">=</span> <span class="n">monitor_info_old</span><span class="p">[</span><span class="s1">&#39;Work&#39;</span><span class="p">]</span>
    <span class="n">newWA</span> <span class="o">=</span> <span class="n">monitor_info_new</span><span class="p">[</span><span class="s1">&#39;Work&#39;</span><span class="p">]</span>
    <span class="n">oldMA</span> <span class="o">=</span> <span class="n">monitor_info_old</span><span class="p">[</span><span class="s1">&#39;Monitor&#39;</span><span class="p">]</span>
    <span class="n">newMA</span> <span class="o">=</span> <span class="n">monitor_info_new</span><span class="p">[</span><span class="s1">&#39;Monitor&#39;</span><span class="p">]</span>
    <span class="c1">#offsetx_new = monitor_info_new[&#39;offsetx&#39;]</span>
    <span class="c1">#offsety_new = monitor_info_new[&#39;offsety&#39;]</span>
    <span class="c1">#offsetx_old = monitor_info_old[&#39;offsetx&#39;]</span>
    <span class="c1">#offsety_old = monitor_info_old[&#39;offsety&#39;]</span>
    
    <span class="c1"># norm to 0 oriented</span>
    <span class="n">RA</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-=</span> <span class="n">oldMA</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">RA</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-=</span> <span class="n">oldMA</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">RA</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-=</span> <span class="n">oldMA</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">RA</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-=</span> <span class="n">oldMA</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="c1">#print &#39;old calc area: %s&#39;% RA</span>
    
    <span class="n">newWAWidth</span> <span class="o">=</span> <span class="n">newWA</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">newWA</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">newWAHeight</span> <span class="o">=</span> <span class="n">newWA</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">newWA</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">oldWAWidth</span> <span class="o">=</span> <span class="n">oldWA</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">oldWA</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">oldWAHeight</span> <span class="o">=</span> <span class="n">oldWA</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">oldWA</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="k">if</span> <span class="n">resize</span><span class="p">:</span>
        <span class="n">RA</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">RA</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">_get_new_coordinates_resize_other_monitor</span><span class="p">(</span><span class="n">begin</span><span class="o">=</span><span class="n">RA</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">end</span><span class="o">=</span><span class="n">RA</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">oldSize</span><span class="o">=</span><span class="n">oldWAWidth</span><span class="p">,</span>
                                           <span class="n">newSize</span><span class="o">=</span><span class="n">newWAWidth</span><span class="p">)</span>
        <span class="n">RA</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">RA</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">_get_new_coordinates_resize_other_monitor</span><span class="p">(</span><span class="n">begin</span><span class="o">=</span><span class="n">RA</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">end</span><span class="o">=</span><span class="n">RA</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">oldSize</span><span class="o">=</span><span class="n">oldWAHeight</span><span class="p">,</span>
                                           <span class="n">newSize</span><span class="o">=</span><span class="n">newWAHeight</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># no resize, keep width, height:</span>
        <span class="n">RA</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">RA</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">_get_new_coordinates_fixed_other_monitor</span><span class="p">(</span><span class="n">begin</span><span class="o">=</span><span class="n">RA</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">end</span><span class="o">=</span><span class="n">RA</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">oldSize</span><span class="o">=</span><span class="n">oldWAWidth</span><span class="p">,</span>
                                           <span class="n">newSize</span><span class="o">=</span><span class="n">newWAWidth</span><span class="p">)</span>
        <span class="n">RA</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">RA</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">_get_new_coordinates_fixed_other_monitor</span><span class="p">(</span><span class="n">begin</span><span class="o">=</span><span class="n">RA</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">end</span><span class="o">=</span><span class="n">RA</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">oldSize</span><span class="o">=</span><span class="n">oldWAHeight</span><span class="p">,</span>
                                           <span class="n">newSize</span><span class="o">=</span><span class="n">newWAHeight</span><span class="p">)</span>

    <span class="n">fixed_width</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">resize</span>
    <span class="n">RA</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">RA</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">keepinside_restore_area</span><span class="p">(</span><span class="n">RA</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">RA</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">newWAWidth</span><span class="p">,</span> <span class="n">fixed_width</span><span class="o">=</span><span class="n">fixed_width</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">RA</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">RA</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">keepinside_restore_area</span><span class="p">(</span><span class="n">RA</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">RA</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">newWAHeight</span><span class="p">,</span> <span class="n">fixed_width</span><span class="o">=</span><span class="n">fixed_width</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># correct for new WA:</span>
    <span class="n">RA</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">newMA</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">RA</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">newMA</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">RA</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+=</span> <span class="n">newMA</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">RA</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+=</span> <span class="n">newMA</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1">#print &#39;new RA: %s&#39;% RA</span>
    <span class="k">return</span> <span class="n">RA</span></div>


<span class="k">def</span> <span class="nf">_get_new_coordinates_resize_other_monitor</span><span class="p">(</span><span class="n">begin</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">oldSize</span><span class="p">,</span> <span class="n">newSize</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;sqeeze or make larger the coordinates of the window in either direction</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">newBegin</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">begin</span> <span class="o">*</span> <span class="n">newSize</span> <span class="o">/</span> <span class="n">oldSize</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span>
    <span class="n">newEnd</span> <span class="o">=</span>  <span class="nb">int</span><span class="p">(</span><span class="n">end</span> <span class="o">*</span> <span class="n">newSize</span> <span class="o">/</span> <span class="n">oldSize</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">newBegin</span><span class="p">,</span> <span class="n">newEnd</span>

<span class="k">def</span> <span class="nf">_get_new_coordinates_fixed_other_monitor</span><span class="p">(</span><span class="n">begin</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">oldSize</span><span class="p">,</span> <span class="n">newSize</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;get the coordinates for the window in the new monitor, position at same relative place</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">width</span> <span class="o">=</span> <span class="n">end</span> <span class="o">-</span> <span class="n">begin</span>
    <span class="c1"># relative to old spacing</span>
    <span class="n">oldspacing</span> <span class="o">=</span> <span class="n">oldSize</span> <span class="o">-</span> <span class="n">width</span>
    <span class="n">newspacing</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">newSize</span> <span class="o">-</span> <span class="n">width</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">oldspacing</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">newBegin</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">begin</span> <span class="o">*</span> <span class="n">newspacing</span> <span class="o">/</span> <span class="n">oldspacing</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="n">newEnd</span> <span class="o">=</span>  <span class="n">newBegin</span> <span class="o">+</span> <span class="n">width</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># position center:</span>
        <span class="n">spacing</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">newSize</span> <span class="o">-</span> <span class="n">width</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">newBegin</span><span class="p">,</span> <span class="n">newEnd</span> <span class="o">=</span> <span class="n">spacing</span><span class="p">,</span> <span class="n">spacing</span> <span class="o">+</span> <span class="n">width</span>
    <span class="k">return</span> <span class="n">newBegin</span><span class="p">,</span> <span class="n">newEnd</span>


<div class="viewcode-block" id="is_inside_monitor"><a class="viewcode-back" href="../../monitorfunctions.html#natlink.monitorfunctions.is_inside_monitor">[docs]</a><span class="k">def</span> <span class="nf">is_inside_monitor</span><span class="p">(</span> <span class="n">point</span> <span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;give the number of the monitor in which the position lies (starting with 1)</span>

<span class="sd">    if outside, return None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">xpos</span><span class="p">,</span> <span class="n">ypos</span> <span class="o">=</span> <span class="n">point</span>
    <span class="n">monitor_info</span><span class="p">()</span>
    <span class="n">mon</span> <span class="o">=</span> <span class="n">get_nearest_monitor_point</span><span class="p">(</span> <span class="n">point</span> <span class="p">)</span>
    <span class="k">if</span> <span class="n">mon</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">MONITOR_INFO</span><span class="p">:</span>
        <span class="n">monitor_info</span><span class="p">()</span>
    <span class="n">monitor_area</span> <span class="o">=</span> <span class="n">MONITOR_INFO</span><span class="p">[</span><span class="n">mon</span><span class="p">][</span><span class="s1">&#39;Monitor&#39;</span><span class="p">]</span>
    <span class="n">left</span><span class="p">,</span> <span class="n">top</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">bottom</span> <span class="o">=</span> <span class="n">monitor_area</span>
    <span class="k">if</span> <span class="n">left</span> <span class="o">&lt;=</span> <span class="n">xpos</span> <span class="o">&lt;</span> <span class="n">right</span> <span class="ow">and</span> <span class="n">top</span> <span class="o">&lt;=</span> <span class="n">ypos</span> <span class="o">&lt;</span> <span class="n">bottom</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">mon</span>
    <span class="k">return</span> <span class="kc">False</span></div>
        
<div class="viewcode-block" id="get_closest_position"><a class="viewcode-back" href="../../monitorfunctions.html#natlink.monitorfunctions.get_closest_position">[docs]</a><span class="k">def</span> <span class="nf">get_closest_position</span><span class="p">(</span> <span class="n">point</span> <span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;return the closest valid mouse position on any monitor</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">monitor_info</span><span class="p">()</span>
    <span class="n">xpos</span><span class="p">,</span> <span class="n">ypos</span> <span class="o">=</span> <span class="n">point</span>
    <span class="k">if</span> <span class="n">is_inside_monitor</span><span class="p">(</span> <span class="n">point</span> <span class="p">):</span>
        <span class="k">return</span>  <span class="p">(</span><span class="n">xpos</span><span class="p">,</span> <span class="n">ypos</span><span class="p">)</span>
    <span class="n">mon</span> <span class="o">=</span> <span class="n">get_nearest_monitor_point</span><span class="p">(</span> <span class="n">point</span> <span class="p">)</span>
    <span class="n">monitor_area</span> <span class="o">=</span> <span class="n">MONITOR_INFO</span><span class="p">[</span><span class="n">mon</span><span class="p">][</span><span class="s1">&#39;Monitor&#39;</span><span class="p">]</span>
    <span class="n">newPoint</span> <span class="o">=</span> <span class="n">_get_nearest_inside_point</span><span class="p">(</span> <span class="n">point</span><span class="p">,</span> <span class="n">monitor_area</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">newPoint</span></div>

<span class="k">def</span> <span class="nf">_get_nearest_inside_point</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">monitor_area</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;assume xpos, ypos OUTSIDE monitor_area, get shortest connection</span>
<span class="sd">    </span>
<span class="sd">    return distance, and xnew, ynew</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">xpos</span><span class="p">,</span> <span class="n">ypos</span> <span class="o">=</span> <span class="n">point</span>
    <span class="n">left</span><span class="p">,</span> <span class="n">top</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">bottom</span> <span class="o">=</span> <span class="n">monitor_area</span>
    <span class="k">if</span> <span class="n">xpos</span> <span class="o">&lt;</span> <span class="n">left</span><span class="p">:</span>
        <span class="n">xnew</span> <span class="o">=</span> <span class="n">left</span>
    <span class="k">elif</span> <span class="n">xpos</span> <span class="o">&gt;=</span> <span class="n">right</span><span class="p">:</span>
        <span class="n">xnew</span> <span class="o">=</span> <span class="n">right</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">xnew</span> <span class="o">=</span> <span class="n">xpos</span>
    <span class="k">if</span> <span class="n">ypos</span> <span class="o">&lt;</span> <span class="n">top</span><span class="p">:</span>
        <span class="n">ynew</span> <span class="o">=</span> <span class="n">top</span>
    <span class="k">elif</span> <span class="n">ypos</span> <span class="o">&gt;=</span> <span class="n">bottom</span><span class="p">:</span>
        <span class="n">ynew</span> <span class="o">=</span> <span class="n">bottom</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ynew</span> <span class="o">=</span> <span class="n">ypos</span>
    <span class="c1">#dist = math.sqrt( (xpos-xnew)*(xpos-xnew) + (ypos-ynew)*(ypos-ynew) )</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">xnew</span><span class="p">,</span> <span class="n">ynew</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">_get_restore_area</span><span class="p">(</span><span class="n">windowHndle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;for debugging purposes, get the restore area of window</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">info</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">GetWindowPlacement</span><span class="p">(</span><span class="n">windowHndle</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">win32gui</span><span class="o">.</span><span class="n">SetWindowPlacement</span><span class="p">(</span><span class="n">windowHndle</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">info</span><span class="p">)</span> <span class="p">)</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
            
<span class="k">def</span> <span class="nf">_set_restore_area</span><span class="p">(</span><span class="n">hndle</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">top</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">bottom</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;just for testing difficult cases&quot;&quot;&quot;</span>
    
    <span class="n">info</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">GetWindowPlacement</span><span class="p">(</span><span class="n">hndle</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">info</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">top</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">bottom</span><span class="p">)</span>
    <span class="n">win32gui</span><span class="o">.</span><span class="n">SetWindowPlacement</span><span class="p">(</span><span class="n">hndle</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">info</span><span class="p">)</span> <span class="p">)</span>

<span class="c1">#######################            </span>
<span class="c1">#various test functions, demo things</span>
<span class="c1">#switch on or off at bottom of file:</span>
<span class="c1">#for detailed testing of inner functions, see unittestMonitorfunctions.py</span>
<span class="c1">#</span>
<div class="viewcode-block" id="test_individual_points"><a class="viewcode-back" href="../../monitorfunctions.html#natlink.monitorfunctions.test_individual_points">[docs]</a><span class="k">def</span> <span class="nf">test_individual_points</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;testing of points being inside or near some monitor</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;for two monitors (my case) some additional calls:&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;is inside (one of the ) monitors:&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;0, 0, always: &#39;</span><span class="p">,</span> <span class="n">is_inside_monitor</span><span class="p">(</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;800, 500, mostly inside first: &#39;</span><span class="p">,</span> <span class="n">is_inside_monitor</span><span class="p">(</span> <span class="p">(</span><span class="mi">800</span><span class="p">,</span><span class="mi">500</span><span class="p">)</span> <span class="p">))</span>   <span class="c1">#first</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;2000, 600 often inside second:&#39;</span><span class="p">,</span> <span class="n">is_inside_monitor</span><span class="p">(</span> <span class="p">(</span><span class="mi">2000</span><span class="p">,</span><span class="mi">600</span><span class="p">)</span> <span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-10, -1000 outside: &#39;</span><span class="p">,</span> <span class="n">is_inside_monitor</span><span class="p">(</span> <span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">1000</span><span class="p">)</span> <span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;10000, 5000 outside: &#39;</span><span class="p">,</span> <span class="n">is_inside_monitor</span><span class="p">(</span> <span class="p">(</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)</span> <span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;guessing nearest position if outside:&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;point inside: &#39;</span><span class="p">,</span> <span class="n">get_closest_position</span><span class="p">(</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;point inside: &#39;</span><span class="p">,</span> <span class="n">get_closest_position</span><span class="p">(</span> <span class="p">(</span><span class="mi">500</span><span class="p">,</span><span class="mi">500</span><span class="p">)</span> <span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;left of monitor 1 (-10, 200): &#39;</span><span class="p">,</span> <span class="n">get_closest_position</span><span class="p">(</span> <span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span> <span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;down of monitor 2 (1800, 1000): &#39;</span><span class="p">,</span> <span class="n">get_closest_position</span><span class="p">(</span> <span class="p">(</span><span class="mi">1800</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span> <span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;big guess of (10000, -5000)&#39;</span><span class="p">,</span> <span class="n">get_closest_position</span><span class="p">(</span> <span class="p">(</span><span class="mi">10000</span><span class="p">,</span> <span class="o">-</span><span class="mi">5000</span><span class="p">)</span> <span class="p">))</span></div>

<div class="viewcode-block" id="test_get_nearest_monitors"><a class="viewcode-back" href="../../monitorfunctions.html#natlink.monitorfunctions.test_get_nearest_monitors">[docs]</a><span class="k">def</span> <span class="nf">test_get_nearest_monitors</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;test getting the nearest monitor, wrappers around API functions</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">mon</span> <span class="o">=</span> <span class="n">get_nearest_monitor_point</span><span class="p">(</span> <span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span> <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;nearest monitor point: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span> <span class="n">mon</span><span class="p">)</span>
    <span class="n">winHndle</span> <span class="o">=</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">GetForegroundWindow</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;window hndle: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span> <span class="n">winHndle</span><span class="p">)</span>
    <span class="n">mon</span> <span class="o">=</span> <span class="n">get_nearest_monitor_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;nearest monitor: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span> <span class="n">mon</span><span class="p">)</span>
    <span class="n">canBeResized</span> <span class="o">=</span> <span class="n">window_can_be_resized</span><span class="p">(</span><span class="n">winHndle</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;window can be resized: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span> <span class="n">canBeResized</span><span class="p">)</span></div>
    

<div class="viewcode-block" id="test_basic_values"><a class="viewcode-back" href="../../monitorfunctions.html#natlink.monitorfunctions.test_basic_values">[docs]</a><span class="k">def</span> <span class="nf">test_basic_values</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;testing the system metrics and monitor info of multiple monitors</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">monitor_info</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---number of monitors: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span> <span class="n">NMON</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---total virtual screen: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span> <span class="n">VIRTUAL_SCREEN</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---border of windows: </span><span class="si">%s</span><span class="s1">, </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span>  <span class="p">(</span><span class="n">BORDERX</span><span class="p">,</span> <span class="n">BORDERY</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---MONITOR_HNDLES: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span> <span class="n">MONITOR_HNDLES</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">mon</span> <span class="ow">in</span> <span class="n">MONITOR_HNDLES</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;----monitor: </span><span class="si">%s</span><span class="s1">:&#39;</span><span class="o">%</span> <span class="n">mon</span><span class="p">)</span>
        <span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">MONITOR_INFO</span><span class="p">[</span><span class="n">mon</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;----&#39;</span><span class="p">)</span>   </div>

<span class="n">defaultSleepTime</span> <span class="o">=</span> <span class="mi">1</span>
<div class="viewcode-block" id="wait"><a class="viewcode-back" href="../../monitorfunctions.html#natlink.monitorfunctions.wait">[docs]</a><span class="k">def</span> <span class="nf">wait</span><span class="p">(</span><span class="n">mult</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;wait multiple of default wait time</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">defaultSleepTime</span><span class="o">*</span><span class="n">mult</span><span class="p">)</span></div>

<div class="viewcode-block" id="test_mouse_to_other_monitor"><a class="viewcode-back" href="../../monitorfunctions.html#natlink.monitorfunctions.test_mouse_to_other_monitor">[docs]</a><span class="k">def</span> <span class="nf">test_mouse_to_other_monitor</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;try to position the mouse in another monitor</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">monitor_info</span><span class="p">()</span>
    <span class="n">winHndle</span> <span class="o">=</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">GetForegroundWindow</span><span class="p">()</span>
    <span class="c1"># canBeResized = window_can_be_resized(winHndle)</span>
    <span class="n">mon</span> <span class="o">=</span> <span class="n">get_nearest_monitor_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">)</span>
    <span class="n">others</span> <span class="o">=</span> <span class="n">get_other_monitors</span><span class="p">(</span><span class="n">mon</span><span class="p">)</span>
    <span class="n">moninfo</span> <span class="o">=</span> <span class="n">MONITOR_INFO</span><span class="p">[</span><span class="n">others</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="n">mousefour</span> <span class="o">=</span> <span class="n">moninfo</span><span class="p">[</span><span class="s1">&#39;Monitor&#39;</span><span class="p">]</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">mousefour</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="nb">int</span><span class="p">((</span><span class="n">mousefour</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">mousefour</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mf">2.0</span><span class="p">),</span> <span class="n">mousefour</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="nb">int</span><span class="p">((</span><span class="n">mousefour</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">mousefour</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mf">2.0</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;middle of other monitor:&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span></div>
    
    
<div class="viewcode-block" id="test_move_to_other_monitor"><a class="viewcode-back" href="../../monitorfunctions.html#natlink.monitorfunctions.test_move_to_other_monitor">[docs]</a><span class="k">def</span> <span class="nf">test_move_to_other_monitor</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;try moving to other monitor, keeping position as close as possible</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">monitor_info</span><span class="p">()</span>
    <span class="n">winHndle</span> <span class="o">=</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">GetForegroundWindow</span><span class="p">()</span>
    <span class="n">canBeResized</span> <span class="o">=</span> <span class="n">window_can_be_resized</span><span class="p">(</span><span class="n">winHndle</span><span class="p">)</span>
    <span class="n">mon</span> <span class="o">=</span> <span class="n">get_nearest_monitor_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">)</span>
    <span class="n">others</span> <span class="o">=</span> <span class="n">get_other_monitors</span><span class="p">(</span><span class="n">mon</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;other monitors: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span> <span class="n">others</span><span class="p">)</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">otherMon</span> <span class="o">=</span> <span class="n">others</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">move_to_monitor</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">otherMon</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">resize</span><span class="o">=</span><span class="n">canBeResized</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">move_to_monitor</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">otherMon</span><span class="p">,</span> <span class="n">resize</span><span class="o">=</span><span class="n">canBeResized</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">move_to_monitor</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">otherMon</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">resize</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">move_to_monitor</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">otherMon</span><span class="p">,</span> <span class="n">resize</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">maximize_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">)</span>
    <span class="n">move_to_monitor</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">otherMon</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">resize</span><span class="o">=</span><span class="n">canBeResized</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">move_to_monitor</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">otherMon</span><span class="p">,</span> <span class="n">resize</span><span class="o">=</span><span class="n">canBeResized</span><span class="p">)</span></div>
 


<div class="viewcode-block" id="test_move_around_monitor_fixed_size"><a class="viewcode-back" href="../../monitorfunctions.html#natlink.monitorfunctions.test_move_around_monitor_fixed_size">[docs]</a><span class="k">def</span> <span class="nf">test_move_around_monitor_fixed_size</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;test different parameters of xwidth and ywidth for positioning a window</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">monitor_info</span><span class="p">()</span>
    <span class="n">winHndle</span> <span class="o">=</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">GetForegroundWindow</span><span class="p">()</span>
    <span class="n">mon</span> <span class="o">=</span> <span class="n">get_nearest_monitor_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">)</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span> <span class="c1"># near left, top</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span> <span class="c1"># near right top etc. </span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># identical left, top</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># identical right, bottom</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span> <span class="c1"># identical center, center</span>
    <span class="n">wait</span><span class="p">()</span></div>
    
<div class="viewcode-block" id="test_center_different_sizes"><a class="viewcode-back" href="../../monitorfunctions.html#natlink.monitorfunctions.test_center_different_sizes">[docs]</a><span class="k">def</span> <span class="nf">test_center_different_sizes</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;test different parameters of xwidth and ywidth for different sizes of window</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">monitor_info</span><span class="p">()</span>
    <span class="n">winHndle</span> <span class="o">=</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">GetForegroundWindow</span><span class="p">()</span>
    <span class="n">mon</span> <span class="o">=</span> <span class="n">get_nearest_monitor_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">)</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.995</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.995</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span></div>


<div class="viewcode-block" id="test_default_restore"><a class="viewcode-back" href="../../monitorfunctions.html#natlink.monitorfunctions.test_default_restore">[docs]</a><span class="k">def</span> <span class="nf">test_default_restore</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;test restore after having set the RA to ridiculous values</span>
<span class="sd">    </span>
<span class="sd">    mon can be left away.</span>
<span class="sd">    keepinside makes the window fit to the monitor always.</span>
<span class="sd">    note the window is kept on the same monitor, though the _set_restore_area could</span>
<span class="sd">    suspect different.</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">monitor_info</span><span class="p">()</span>
    <span class="n">winHndle</span> <span class="o">=</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">GetForegroundWindow</span><span class="p">()</span>
    <span class="n">_set_restore_area</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="o">-</span><span class="mi">1700</span><span class="p">,</span> <span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)</span>
    <span class="n">mon</span> <span class="o">=</span> <span class="n">get_nearest_monitor_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;monitor: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span> <span class="n">mon</span><span class="p">)</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">_set_restore_area</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="o">-</span><span class="mi">1700</span><span class="p">,</span> <span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>

    <span class="n">_set_restore_area</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">4700</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)</span>
    <span class="n">mon</span> <span class="o">=</span> <span class="n">get_nearest_monitor_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;monitor: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span> <span class="n">mon</span><span class="p">)</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">_set_restore_area</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">4700</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">maximize_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">)</span></div>

<div class="viewcode-block" id="test_move_far_away"><a class="viewcode-back" href="../../monitorfunctions.html#natlink.monitorfunctions.test_move_far_away">[docs]</a><span class="k">def</span> <span class="nf">test_move_far_away</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;test moving across borders of monitor, testing keepinside_all</span>
<span class="sd">    </span>
<span class="sd">    going to corners can give unexpected results, jumping to another monitor...</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">monitor_info</span><span class="p">()</span>
    <span class="n">winHndle</span> <span class="o">=</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">GetForegroundWindow</span><span class="p">()</span>
    <span class="n">mon</span> <span class="o">=</span> <span class="n">get_nearest_monitor_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">)</span>
    <span class="c1"># canBeResized = window_can_be_resized(winHndle)</span>
    <span class="c1"># you can also test from the other monitor by uncommenting next 3 lines:</span>
    <span class="c1">#others = get_other_monitors(mon)</span>
    <span class="c1">#move_to_monitor(winHndle, others[0], mon, resize=canBeResized)</span>
    <span class="c1">#mon = get_nearest_monitor_window(winHndle)</span>

    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">move_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">move_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">move_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">move_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;down&#39;</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">move_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;lefttop&#39;</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">move_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;rightbottom&#39;</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">move_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;leftbottom&#39;</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">move_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;righttop&#39;</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span></div>
    
<div class="viewcode-block" id="test_stretch_far_away"><a class="viewcode-back" href="../../monitorfunctions.html#natlink.monitorfunctions.test_stretch_far_away">[docs]</a><span class="k">def</span> <span class="nf">test_stretch_far_away</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;test stretching across borders of monitor, testing keepinside_all</span>
<span class="sd">    </span>
<span class="sd">    stretching to corners can give unexpected results, jumping to another monitor...</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">monitor_info</span><span class="p">()</span>
    <span class="n">winHndle</span> <span class="o">=</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">GetForegroundWindow</span><span class="p">()</span>
    <span class="n">mon</span> <span class="o">=</span> <span class="n">get_nearest_monitor_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">)</span>
    <span class="c1"># canBeResized = window_can_be_resized(winHndle)</span>
    <span class="c1"># you can also test from the other monitor by uncommenting next 3 lines:</span>
    <span class="c1">#others = get_other_monitors(mon)</span>
    <span class="c1">#move_to_monitor(winHndle, others[0], mon, resize=canBeResized)</span>
    <span class="c1">#mon = get_nearest_monitor_window(winHndle)</span>

    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">stretch_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">stretch_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">stretch_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">stretch_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;down&#39;</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">stretch_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;lefttop&#39;</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">stretch_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;rightbottom&#39;</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">stretch_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;leftbottom&#39;</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">stretch_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;righttop&#39;</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span></div>




<div class="viewcode-block" id="test_move_same_window_sides_corners"><a class="viewcode-back" href="../../monitorfunctions.html#natlink.monitorfunctions.test_move_same_window_sides_corners">[docs]</a><span class="k">def</span> <span class="nf">test_move_same_window_sides_corners</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;test moving around the monitor</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">monitor_info</span><span class="p">()</span>
    <span class="n">winHndle</span> <span class="o">=</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">GetForegroundWindow</span><span class="p">()</span>
    <span class="n">mon</span> <span class="o">=</span> <span class="n">get_nearest_monitor_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">)</span>

    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">move_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">move_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;up&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">move_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">move_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;down&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>

    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">move_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;relative&#39;</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">move_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;up&#39;</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;relative&#39;</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">move_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;relative&#39;</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">move_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;down&#39;</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;relative&#39;</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>

    <span class="c1"># to corners:</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">move_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;lefttop&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;relative&#39;</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">move_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;righttop&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;relative&#39;</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">move_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;rightbottom&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;relative&#39;</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">move_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;leftbottom&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;relative&#39;</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>

    <span class="c1"># towards corners:</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">move_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;lefttop&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;relative&#39;</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">move_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;righttop&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;relative&#39;</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">move_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;rightbottom&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;relative&#39;</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">move_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;leftbottom&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;relative&#39;</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">maximize_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">)</span></div>

<div class="viewcode-block" id="test_move_same_window_degrees"><a class="viewcode-back" href="../../monitorfunctions.html#natlink.monitorfunctions.test_move_same_window_degrees">[docs]</a><span class="k">def</span> <span class="nf">test_move_same_window_degrees</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;test moving around the monitor with an  angle</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">monitor_info</span><span class="p">()</span>
    <span class="n">winHndle</span> <span class="o">=</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">GetForegroundWindow</span><span class="p">()</span>
    <span class="n">mon</span> <span class="o">=</span> <span class="n">get_nearest_monitor_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">)</span>


    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">75</span><span class="p">):</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="mi">50</span> <span class="o">+</span> <span class="n">i</span>
        <span class="n">angle</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="mi">20</span> <span class="o">%</span> <span class="mi">360</span>
        <span class="n">move_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span><span class="n">angle</span><span class="p">,</span> <span class="n">dist</span><span class="p">)</span>
        <span class="n">wait</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">75</span><span class="p">):</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="mi">50</span> <span class="o">+</span> <span class="n">i</span><span class="o">*</span><span class="mi">3</span>
        <span class="n">angle</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="mi">20</span> <span class="o">%</span> <span class="mi">360</span>
        <span class="n">move_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span><span class="n">angle</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">wait</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span></div>

<div class="viewcode-block" id="test_move_relative_degrees"><a class="viewcode-back" href="../../monitorfunctions.html#natlink.monitorfunctions.test_move_relative_degrees">[docs]</a><span class="k">def</span> <span class="nf">test_move_relative_degrees</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;test moving around the monitor with an  angle relative to the current distance of the nearest corner</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">monitor_info</span><span class="p">()</span>
    <span class="n">winHndle</span> <span class="o">=</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">GetForegroundWindow</span><span class="p">()</span>
    <span class="n">mon</span> <span class="o">=</span> <span class="n">get_nearest_monitor_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">)</span>
    
    <span class="c1"># when outside:</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">move_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">amount</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;relative&#39;</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;up&#39;</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">move_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">amount</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;up&#39;</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">move_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;relative&#39;</span><span class="p">)</span></div>
    
    <span class="c1"># restore_window(winHndle, mon, xpos=&#39;center&#39;, ypos=&#39;center&#39;, xwidth=0.5, ywidth=0.5, keepinside=1)</span>
    <span class="c1"># wait()</span>
    <span class="c1"># for i in range(20):</span>
    <span class="c1">#     dist = 0.8</span>
    <span class="c1">#     angle = i*20 % 360</span>
    <span class="c1">#     move_window(winHndle,angle, dist, units=&#39;relative&#39;)</span>
    <span class="c1">#     wait()</span>
    <span class="c1">#     restore_window(winHndle, mon, xpos=&#39;center&#39;, ypos=&#39;center&#39;, xwidth=0.5, ywidth=0.5, keepinside=1)</span>
    <span class="c1">#     wait(0.5)</span>
    <span class="c1"># </span>
    <span class="c1"># # range with greatest jumps (probably)   </span>
    <span class="c1"># for i in range(20):</span>
    <span class="c1">#     dist = 1</span>
    <span class="c1">#     angle = i + 48</span>
    <span class="c1">#     move_window(winHndle,angle, dist, units=&#39;relative&#39;)</span>
    <span class="c1">#     wait(0.3)</span>
    <span class="c1">#     restore_window(winHndle, mon, xpos=&#39;center&#39;, ypos=&#39;center&#39;, xwidth=0.5, ywidth=0.5, keepinside=1)</span>
    <span class="c1">#     wait(0.1)</span>


    <span class="c1">#wait(2)</span>
    <span class="c1">#restore_window(winHndle, mon, xpos=&#39;center&#39;, ypos=&#39;center&#39;, xwidth=0.5, ywidth=0.5, keepinside=1)</span>
    <span class="c1">#for i in range(75):</span>
    <span class="c1">#    dist = 50 + i*3</span>
    <span class="c1">#    angle = i*20 % 360</span>
    <span class="c1">#    move_window(winHndle,angle, dist, keepinside=1)</span>
    <span class="c1">#    wait(0.1)</span>
    
<div class="viewcode-block" id="test_restore_window_half_width"><a class="viewcode-back" href="../../monitorfunctions.html#natlink.monitorfunctions.test_restore_window_half_width">[docs]</a><span class="k">def</span> <span class="nf">test_restore_window_half_width</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;test moving around edges, corners, half width, height</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">monitor_info</span><span class="p">()</span>
    <span class="n">winHndle</span> <span class="o">=</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">GetForegroundWindow</span><span class="p">()</span>
    <span class="c1"># mon = get_nearest_monitor_window(winHndle)</span>

    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;down&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    
    <span class="c1"># corners</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;down&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    
    
    <span class="n">maximize_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">)</span></div>

<div class="viewcode-block" id="test_restore_window_third_width"><a class="viewcode-back" href="../../monitorfunctions.html#natlink.monitorfunctions.test_restore_window_third_width">[docs]</a><span class="k">def</span> <span class="nf">test_restore_window_third_width</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;test moving around edges, corners, half width, height</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">monitor_info</span><span class="p">()</span>
    <span class="n">winHndle</span> <span class="o">=</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">GetForegroundWindow</span><span class="p">()</span>
    <span class="c1"># mon = get_nearest_monitor_window(winHndle)</span>

    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.33</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.33</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.33</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;down&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.33</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">maximize_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">)</span></div>
  

<div class="viewcode-block" id="test_stretch_same_window_sides_corners"><a class="viewcode-back" href="../../monitorfunctions.html#natlink.monitorfunctions.test_stretch_same_window_sides_corners">[docs]</a><span class="k">def</span> <span class="nf">test_stretch_same_window_sides_corners</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;test moving around the monitor</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># pylint: disable=R0915    </span>
    <span class="n">monitor_info</span><span class="p">()</span>
    <span class="n">winHndle</span> <span class="o">=</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">GetForegroundWindow</span><span class="p">()</span>
    <span class="n">mon</span> <span class="o">=</span> <span class="n">get_nearest_monitor_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">)</span>

    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">stretch_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">stretch_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;up&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">stretch_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">stretch_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;down&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="c1"># now stretch in all directions, adding to the size:</span>
    <span class="n">stretch_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;relative&#39;</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">stretch_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;up&#39;</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;relative&#39;</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">stretch_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;relative&#39;</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">stretch_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;down&#39;</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;relative&#39;</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>

    <span class="c1"># to corners:</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">stretch_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;lefttop&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;relative&#39;</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">stretch_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;righttop&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;relative&#39;</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">stretch_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;rightbottom&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;relative&#39;</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">stretch_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;leftbottom&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;relative&#39;</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>

    <span class="c1"># towards corners:</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">stretch_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;lefttop&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;relative&#39;</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">stretch_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;righttop&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;relative&#39;</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">stretch_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;rightbottom&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;relative&#39;</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">stretch_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;leftbottom&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;relative&#39;</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">maximize_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">)</span></div>

<div class="viewcode-block" id="test_shrink_same_window_sides_corners"><a class="viewcode-back" href="../../monitorfunctions.html#natlink.monitorfunctions.test_shrink_same_window_sides_corners">[docs]</a><span class="k">def</span> <span class="nf">test_shrink_same_window_sides_corners</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;test moving around the monitor</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># pylint: disable=R0915    </span>
    <span class="n">monitor_info</span><span class="p">()</span>
    <span class="n">winHndle</span> <span class="o">=</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">GetForegroundWindow</span><span class="p">()</span>
    <span class="n">mon</span> <span class="o">=</span> <span class="n">get_nearest_monitor_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">)</span>

    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">shrink_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">shrink_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;up&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">shrink_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">shrink_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;down&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="c1"># now shrink in all directions, adding to the size:</span>
    <span class="n">shrink_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;relative&#39;</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">shrink_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;up&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;relative&#39;</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">shrink_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;relative&#39;</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">shrink_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;down&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;relative&#39;</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="c1"># two times around:</span>
    <span class="n">shrink_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;relative&#39;</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">shrink_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;up&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;relative&#39;</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">shrink_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;relative&#39;</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">shrink_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;down&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;relative&#39;</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>

    <span class="c1"># away from corners, same distance as the corner distance:</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">shrink_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;lefttop&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;relative&#39;</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">shrink_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;righttop&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;relative&#39;</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">shrink_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;rightbottom&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;relative&#39;</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">restore_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">xpos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">xwidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">ywidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">keepinside</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">shrink_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">,</span> <span class="s1">&#39;leftbottom&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;relative&#39;</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>

    <span class="n">maximize_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">)</span></div>


<div class="viewcode-block" id="test_minimize_maximize_restore"><a class="viewcode-back" href="../../monitorfunctions.html#natlink.monitorfunctions.test_minimize_maximize_restore">[docs]</a><span class="k">def</span> <span class="nf">test_minimize_maximize_restore</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;testing minimize/maximize actions of window on one screen</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">monitor_info</span><span class="p">()</span>
    <span class="n">winHndle</span> <span class="o">=</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">GetForegroundWindow</span><span class="p">()</span>
    <span class="n">maximize_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">minimize_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">)</span>
    <span class="n">wait</span><span class="p">()</span>
    <span class="n">maximize_window</span><span class="p">(</span><span class="n">winHndle</span><span class="p">)</span></div>
 
<div class="viewcode-block" id="test_taskbar_position"><a class="viewcode-back" href="../../monitorfunctions.html#natlink.monitorfunctions.test_taskbar_position">[docs]</a><span class="k">def</span> <span class="nf">test_taskbar_position</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;prints if the taskbar is located</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">taskbar_pos</span> <span class="o">=</span> <span class="n">get_taskbar_position</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;taskbar located: </span><span class="si">{</span><span class="n">taskbar_pos</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span></div>
    
<span class="k">def</span> <span class="nf">do_doctest</span><span class="p">():</span>
    <span class="c1"># pylint: disable=C0116, C0415</span>
    <span class="kn">import</span> <span class="nn">doctest</span>
    <span class="n">doctest</span><span class="o">.</span><span class="n">testmod</span><span class="p">()</span>
   
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">win_hndle</span> <span class="o">=</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">GetForegroundWindow</span><span class="p">()</span>
    <span class="c1">#print &#39;ra: %s&#39;%  _get_restore_area(winHndle)   </span>
    <span class="n">test_basic_values</span><span class="p">()</span>
    <span class="n">test_taskbar_position</span><span class="p">()</span>
    <span class="n">test_mouse_to_other_monitor</span><span class="p">()</span>
    <span class="c1">#restore_window(winHndle)</span>
    <span class="c1">#test_get_nearest_monitors()</span>
    <span class="c1">#test_individual_points()</span>
    
    <span class="c1"># test_move_to_other_monitor()</span>
    <span class="c1">#test_move_around_monitor_fixed_size()</span>
    <span class="c1">#test_center_different_sizes()</span>
    <span class="c1">#test_default_restore()</span>
    <span class="c1"># test_minimize_maximize_restore()</span>
    <span class="c1"># test_move_same_window_sides_corners()</span>
    <span class="c1">#test_stretch_same_window_sides_corners()</span>
    <span class="c1">#test_shrink_same_window_sides_corners()</span>
    <span class="c1">#test_move_same_window_degrees()</span>
    <span class="c1">#test_move_relative_degrees()</span>
    <span class="c1">#test_move_far_away()</span>
    <span class="c1">#test_stretch_far_away()</span>
    <span class="c1">#test_restore_window_half_width()</span>
    <span class="c1">#test_restore_window_third_width()</span>
    <span class="n">do_doctest</span><span class="p">()</span>  <span class="c1"># most testing moved to unittestMonitorfunctions.py...</span>
    
</pre></div>

           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Quintijn Hoogenboom.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>